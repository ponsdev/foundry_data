{"version":3,"file":"hero-creation-tool.js","sources":["../../src/module/constants.ts","../../src/module/compendiumSourcesSubmenu.ts","../../src/module/settings.ts","../../src/module/preloadTemplates.ts","../../src/module/utils.ts","../../src/module/step.ts","../../src/module/options/heroOption.ts","../../src/module/options/inputOption.ts","../../src/module/tabs/basicsStep.ts","../../src/module/options/fixedOption.ts","../../src/module/indexes/indexUtils.ts","../../src/module/tabs/abilitiesStep.ts","../../src/module/options/selectableOption.ts","../../src/module/options/deletableOption.ts","../../src/module/options/multiOption.ts","../../src/module/proficiencyUtils.ts","../../src/module/options/hiddenOption.ts","../../src/module/options/searchableIndexEntryOption.ts","../../src/module/tabs/raceStep.ts","../../src/module/hitDie.ts","../../src/module/advancementUtils.ts","../../src/module/tabs/classStep.ts","../../src/module/tabs/backgroundStep.ts","../../src/module/options/optionContainer.ts","../../src/module/options/quantifiableOption.ts","../../src/module/tabs/equipmentStep.ts","../../src/module/tabs/spellsStep.ts","../../src/module/tabs/bioStep.ts","../../src/module/heroCreationToolApp.ts","../../src/module/migrations/migration_1.ts","../../src/module/migrations/migration_2.ts","../../src/module/migrations/migration_3.ts","../../src/module/migrations/migrationsHandler.ts","../../src/module/hero-creation-tool.ts"],"sourcesContent":["// Class for general global variables.\n\nexport const MODULE_ID = 'hero-creation-tool';\nexport const LOG_PREFIX = 'Hero Creation Tool';\nexport const MYSTERY_MAN = 'icons/svg/mystery-man.svg';\nexport const NONE_ICON = 'icons/svg/cancel.svg';\n\nexport const enum DEFAULT_PACKS {\n  RACES = 'dnd5e.races',\n  RACE_FEATURES = 'dnd5e.races',\n  CLASSES = 'dnd5e.classes',\n  CLASS_FEATURES = 'dnd5e.classfeatures',\n  SUBCLASSES = 'dnd5e.subclasses',\n  ITEMS = 'dnd5e.items',\n  SPELLS = 'dnd5e.spells',\n  RULES = 'dnd5e.rules',\n  BACKGROUNDS = 'dnd5e.backgrounds',\n}\n\nexport const INTEGRATION = {\n  TOKENIZER: {\n    VERSION: '3.3.0',\n  },\n};\n\nexport const MERGE_OPTIONS = {\n  insertKeys: true,\n  insertValues: true,\n  overwrite: true,\n  recursive: true,\n  inplace: false,\n};\n\nexport type CLASS_LEVEL = 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20;\n","import { DEFAULT_PACKS, LOG_PREFIX, MODULE_ID } from './constants';\nimport SettingKeys from './settings';\n\nexport default class CompendiumSourcesSubmenu extends FormApplication {\n  constructor() {\n    super({});\n    this.baseCompendiumList = game.packs.filter((p) => p.documentName === 'Item');\n  }\n\n  baseCompendiumList: any;\n\n  static get defaultOptions() {\n    return mergeObject(super.defaultOptions, {\n      classes: ['form'],\n      popOut: true,\n      width: 400,\n      height: 400,\n      template: `/modules/hero-creation-tool/templates/sources-submenu.html`,\n      id: 'hct-settings-submenu',\n      title: 'Hero Creation Tool - Sources',\n      resizable: false,\n    });\n  }\n\n  activateListeners(html: JQuery) {\n    super.activateListeners(html);\n  }\n\n  getData() {\n    let selected: any = game.settings.get(MODULE_ID, SettingKeys.SOURCES);\n    if (foundry.utils.isObjectEmpty(selected)) {\n      selected = {\n        races: [DEFAULT_PACKS.RACES],\n        racialFeatures: [DEFAULT_PACKS.RACE_FEATURES],\n        classes: [DEFAULT_PACKS.CLASSES],\n        subclasses: [DEFAULT_PACKS.SUBCLASSES],\n        // classFeatures: [DEFAULT_PACKS.CLASS_FEATURES],\n        backgrounds: [DEFAULT_PACKS.BACKGROUNDS],\n        spells: [DEFAULT_PACKS.SPELLS],\n        feats: [],\n        items: [DEFAULT_PACKS.ITEMS],\n      };\n    }\n    const data = buildTemplateData({\n      compendiaList: this.baseCompendiumList,\n      selectedCompendia: selected,\n    });\n    return data as any;\n  }\n\n  _updateObject(event: Event, formData?: any) {\n    console.info(`${LOG_PREFIX} | Saving compendia sources:`);\n    console.info(formData);\n    return game.settings.set(MODULE_ID, SettingKeys.SOURCES, formData);\n  }\n}\n\nfunction buildCompendiaList(compendiaList: any[], defaultCollection?: string[]) {\n  return compendiaList.map((p: any) => {\n    return {\n      collection: p.collection as string,\n      label: `${p.metadata.label} [${p.metadata.package}]`,\n      checked: defaultCollection?.includes(p.collection),\n    };\n  });\n}\n\ntype BuildData = {\n  compendiaList: any[];\n  selectedCompendia: {\n    races: string[];\n    racialFeatures: string[];\n    classes: string[];\n    subclasses: string[];\n    // classFeatures: string[];\n    backgrounds: string[];\n    spells: string[];\n    feats: string[];\n    items: string[];\n  };\n};\nfunction buildTemplateData({ compendiaList, selectedCompendia }: BuildData) {\n  return {\n    source: {\n      races: {\n        label: game.i18n.localize('HCT.Setting.Sources.RaceCompendia'),\n        compendia: buildCompendiaList(compendiaList, selectedCompendia.races),\n      },\n      racialFeatures: {\n        label: game.i18n.localize('HCT.Setting.Sources.RacialFeatureCompendia'),\n        compendia: buildCompendiaList(compendiaList, selectedCompendia.racialFeatures),\n      },\n      classes: {\n        label: game.i18n.localize('HCT.Setting.Sources.ClassCompendia'),\n        compendia: buildCompendiaList(compendiaList, selectedCompendia.classes),\n      },\n      subclasses: {\n        label: game.i18n.localize('HCT.Setting.Sources.SubclassCompendia'),\n        compendia: buildCompendiaList(compendiaList, selectedCompendia.subclasses),\n      },\n      // classFeatures: {\n      //   label: game.i18n.localize('HCT.Setting.Sources.ClassFeatureCompendia'),\n      //   compendia: buildCompendiaList(compendiaList, selectedCompendia.classFeatures),\n      // },\n      backgrounds: {\n        label: game.i18n.localize('HCT.Setting.Sources.BackgroundCompendia'),\n        compendia: buildCompendiaList(compendiaList, selectedCompendia.backgrounds),\n      },\n      spells: {\n        label: game.i18n.localize('HCT.Setting.Sources.SpellCompendia'),\n        compendia: buildCompendiaList(compendiaList, selectedCompendia.spells),\n      },\n      feats: {\n        label: game.i18n.localize('HCT.Setting.Sources.FeatCompendia'),\n        compendia: buildCompendiaList(compendiaList, selectedCompendia.feats),\n      },\n      items: {\n        label: game.i18n.localize('HCT.Setting.Sources.EquipmentCompendia'),\n        compendia: buildCompendiaList(compendiaList, selectedCompendia.items),\n      },\n    },\n  };\n}\n","import CompendiumSourcesSubmenu from './compendiumSourcesSubmenu';\nimport { MODULE_ID, LOG_PREFIX, DEFAULT_PACKS } from './constants';\n\n// settings not shown on the Module Settings - not modifiable by users\nexport const enum PrivateSettingKeys {\n  LAST_MIGRATION = 'lastMigration',\n}\n\nconst enum SettingKeys {\n  USE_TOKENIZER = 'useTokenizer',\n  TOKEN_BAR = 'displayBarsMode',\n  TOKEN_NAME = 'displayNameMode',\n  SHOW_ROLLS_AS_MESSAGES = 'showRolls',\n  ENABLE_ASI_ROLL = 'enableAbilityScoreRolls',\n  ENABLE_ASI_POINTBUY = 'enableAbilityScorePointBuy',\n  ENABLE_ASI_STANDARD = 'enableAbilityScoreStandardArray',\n  ENABLE_ASI_MANUAL = 'enableAbilityScoreManualInput',\n  INDIVIDUAL_PANEL_SCROLLS = 'individualScrolls',\n  DEFAULT_GOLD_DICE = 'defaultGoldDice',\n  FIGHTING_STYLE_STRING = 'fightingStyleLookupString',\n  EQUIPMENTS_BLACKLIST = 'equipmentsBlackList',\n  SUBRACES_BLACKLIST = 'subracesBlacklist',\n  BUTTON_ON_DIALOG = 'buttonOnDialog',\n  POINT_BUY_LIMIT = 'pointBuyLimit',\n  ABILITY_ROLL_FORMULA = 'abiiltyRollFormula',\n  SOURCES = 'compendiumSources',\n  TRIM_SUBCLASSES = 'trimSubclasses',\n}\nexport default SettingKeys;\n\nexport const enum SourceType {\n  RACES = 'races',\n  RACIAL_FEATURES = 'racialFeatures',\n  CLASSES = 'classes',\n  CLASS_FEATURES = 'classFeatures',\n  SUBCLASSES = 'subclasses',\n  BACKGROUNDS = 'backgrounds',\n  SPELLS = 'spells',\n  FEATS = 'feats',\n  ITEMS = 'items',\n}\n\nexport type Source = {\n  [key in SourceType]: any;\n};\n\nexport function registerSettings(): void {\n  console.info(`${LOG_PREFIX} | Building module settings`);\n\n  Handlebars.registerHelper('checkedIf', function (condition) {\n    return condition ? 'checked' : '';\n  });\n\n  defaultStartingGoldDice();\n  showRollsAsChatMessages();\n  individualPanelScrolls();\n  abilityScoreMethods();\n  pointBuyLimit();\n  abilityRollFormula();\n  tokenDisplayNameMode();\n  tokenDisplayBarsMode();\n  fightingStyleLookupString();\n  equipmentBlacklist();\n  subraceNameBlacklist();\n  buttonOnDialogInsteadOfActorsDirectory();\n  trimSubclasses();\n  // custom packs\n  sourcesConfiguration();\n  // integrations\n  useTokenizerIfAvailable();\n  // private settings\n  lastMigration();\n}\n\nfunction sourcesConfiguration() {\n  game.settings.register(MODULE_ID, SettingKeys.SOURCES, {\n    scope: 'world',\n    config: false,\n    type: Object,\n    default: {\n      races: [DEFAULT_PACKS.RACES],\n      racialFeatures: [DEFAULT_PACKS.RACE_FEATURES],\n      classes: [DEFAULT_PACKS.CLASSES],\n      subclasses: [DEFAULT_PACKS.SUBCLASSES],\n      backgrounds: [DEFAULT_PACKS.BACKGROUNDS],\n      spells: [DEFAULT_PACKS.SPELLS],\n      feats: [],\n      items: [DEFAULT_PACKS.ITEMS],\n    },\n  });\n  // Define a settings submenu which handles advanced configuration needs\n  game.settings.registerMenu(MODULE_ID, SettingKeys.SOURCES, {\n    name: game.i18n.localize('HCT.Setting.Sources.Name'),\n    hint: game.i18n.localize('HCT.Setting.Sources.Hint'),\n    label: game.i18n.localize('HCT.Setting.Sources.Label'),\n    icon: 'fas fa-atlas',\n    type: CompendiumSourcesSubmenu,\n    restricted: true,\n  });\n}\n\nfunction fightingStyleLookupString() {\n  game.settings.register(MODULE_ID, SettingKeys.FIGHTING_STYLE_STRING, {\n    name: game.i18n.localize('HCT.Setting.FightingStyleString.Name'),\n    hint: game.i18n.localize('HCT.Setting.FightingStyleString.Hint'),\n    scope: 'world',\n    config: true,\n    default: 'Fighting Style',\n    type: String,\n  });\n}\n\nfunction equipmentBlacklist() {\n  game.settings.register(MODULE_ID, SettingKeys.EQUIPMENTS_BLACKLIST, {\n    name: game.i18n.localize('HCT.Setting.EquipmentBlacklist.Name'),\n    hint: game.i18n.localize('HCT.Setting.EquipmentBlacklist.Hint'),\n    scope: 'world',\n    config: true,\n    default:\n      'Potion of Climbing; Potion of Healing; Spell Scroll 1st Level; Spell Scroll Cantrip Level; Unarmed Strike',\n    type: String,\n  });\n}\n\nfunction subraceNameBlacklist() {\n  game.settings.register(MODULE_ID, SettingKeys.SUBRACES_BLACKLIST, {\n    name: game.i18n.localize('HCT.Setting.SubraceNameBlacklist.Name'),\n    hint: game.i18n.localize('HCT.Setting.SubraceNameBlacklist.Hint'),\n    scope: 'world',\n    config: true,\n    default: 'Gnome Cunning; Halfling Nimbleness',\n    type: String,\n  });\n}\n\nfunction trimSubclasses() {\n  game.settings.register(MODULE_ID, SettingKeys.TRIM_SUBCLASSES, {\n    name: game.i18n.localize('HCT.Setting.TrimSubclasses.Name'),\n    hint: game.i18n.localize('HCT.Setting.TrimSubclasses.Hint'),\n    scope: 'world',\n    config: true,\n    default: true,\n    type: Boolean,\n  });\n}\n\nfunction defaultStartingGoldDice() {\n  game.settings.register(MODULE_ID, SettingKeys.DEFAULT_GOLD_DICE, {\n    name: game.i18n.localize('HCT.Setting.DefaultGoldDice.Name'),\n    hint: game.i18n.localize('HCT.Setting.DefaultGoldDice.Hint'),\n    scope: 'world',\n    config: true,\n    default: '5d4 * 10',\n    type: String,\n  });\n}\n\nfunction useTokenizerIfAvailable() {\n  game.settings.register(MODULE_ID, SettingKeys.USE_TOKENIZER, {\n    name: game.i18n.localize('HCT.Setting.UseTokenizer.Name'),\n    hint: game.i18n.localize('HCT.Setting.UseTokenizer.Hint'),\n    scope: 'world',\n    config: true,\n    type: Boolean,\n    default: false,\n  });\n}\n\nfunction buttonOnDialogInsteadOfActorsDirectory() {\n  game.settings.register(MODULE_ID, SettingKeys.BUTTON_ON_DIALOG, {\n    name: game.i18n.localize('HCT.Setting.ButtonOnDialogInsteadOfActorsDirectory.Name'),\n    hint: game.i18n.localize('HCT.Setting.ButtonOnDialogInsteadOfActorsDirectory.Hint'),\n    scope: 'world',\n    config: true,\n    type: Boolean,\n    default: false,\n  });\n}\n\nfunction tokenDisplayBarsMode() {\n  game.settings.register(MODULE_ID, SettingKeys.TOKEN_BAR, {\n    name: game.i18n.localize('HCT.Setting.TokenBarMode.Name'),\n    scope: 'world',\n    config: true,\n    type: Number,\n    choices: {\n      0: 'Never Displayed',\n      10: 'When Controlled',\n      20: 'Hover by Owner',\n      30: 'Hover by Anyone',\n      40: 'Always for Owner',\n      50: 'Always for Anyone',\n    },\n    default: 20,\n  });\n}\n\nfunction tokenDisplayNameMode() {\n  game.settings.register(MODULE_ID, SettingKeys.TOKEN_NAME, {\n    name: game.i18n.localize('HCT.Setting.TokenNameMode.Name'),\n    scope: 'world',\n    config: true,\n    type: Number,\n    choices: {\n      0: 'Never Displayed',\n      10: 'When Controlled',\n      20: 'Hover by Owner',\n      30: 'Hover by Anyone',\n      40: 'Always for Owner',\n      50: 'Always for Anyone',\n    },\n    default: 20,\n  });\n}\n\nfunction showRollsAsChatMessages() {\n  game.settings.register(MODULE_ID, SettingKeys.SHOW_ROLLS_AS_MESSAGES, {\n    name: game.i18n.localize('HCT.Setting.ShowRolls.Name'),\n    hint: game.i18n.localize('HCT.Setting.ShowRolls.Hint'),\n    scope: 'world',\n    config: true,\n    type: Boolean,\n    default: true,\n  });\n}\n\nfunction individualPanelScrolls() {\n  game.settings.register(MODULE_ID, SettingKeys.INDIVIDUAL_PANEL_SCROLLS, {\n    name: game.i18n.localize('HCT.Setting.IndividualPanelScroll.Name'),\n    hint: game.i18n.localize('HCT.Setting.IndividualPanelScroll.Hint'),\n    scope: 'client',\n    config: true,\n    type: Boolean,\n    default: false,\n  });\n}\n\nfunction abilityScoreMethods() {\n  game.settings.register(MODULE_ID, SettingKeys.ENABLE_ASI_ROLL, {\n    name: game.i18n.localize('HCT.Setting.AllowAbilityRolling.Name'),\n    scope: 'world',\n    config: true,\n    type: Boolean,\n    default: true,\n  });\n\n  game.settings.register(MODULE_ID, SettingKeys.ENABLE_ASI_STANDARD, {\n    name: game.i18n.localize('HCT.Setting.AllowAbilityStandardArray.Name'),\n    scope: 'world',\n    config: true,\n    type: Boolean,\n    default: true,\n  });\n\n  game.settings.register(MODULE_ID, SettingKeys.ENABLE_ASI_MANUAL, {\n    name: game.i18n.localize('HCT.Setting.AllowAbilityInput.Name'),\n    scope: 'world',\n    config: true,\n    type: Boolean,\n    default: true,\n  });\n\n  game.settings.register(MODULE_ID, SettingKeys.ENABLE_ASI_POINTBUY, {\n    name: game.i18n.localize('HCT.Setting.AllowAbilityPointBuy.Name'),\n    scope: 'world',\n    config: true,\n    type: Boolean,\n    default: true,\n  });\n}\n\nfunction pointBuyLimit() {\n  game.settings.register(MODULE_ID, SettingKeys.POINT_BUY_LIMIT, {\n    name: game.i18n.localize('HCT.Setting.PointBuyLimit.Name'),\n    scope: 'world',\n    config: true,\n    default: 27,\n    type: Number,\n  });\n}\n\nfunction abilityRollFormula() {\n  game.settings.register(MODULE_ID, SettingKeys.ABILITY_ROLL_FORMULA, {\n    name: game.i18n.localize('HCT.Setting.AbilityRollFormula.Name'),\n    scope: 'world',\n    config: true,\n    default: '4d6kh3',\n    type: String,\n  });\n}\n\n// PRIVATE SETTINGS\n\nfunction lastMigration() {\n  game.settings.register(MODULE_ID, PrivateSettingKeys.LAST_MIGRATION, {\n    scope: 'world',\n    config: false,\n    default: 0,\n    type: Number,\n  });\n}\n","import { LOG_PREFIX, MODULE_ID } from './constants';\n\nexport async function preloadTemplates(): Promise<Handlebars.TemplateDelegate[]> {\n  console.info(`${LOG_PREFIX} | Loading templates`);\n\n  const templatePaths: string[] = [\n    `modules/${MODULE_ID}/templates/nav-tabs.html`,\n    `modules/${MODULE_ID}/templates/footer.html`,\n    `modules/${MODULE_ID}/templates/tabs/abilities.html`,\n    `modules/${MODULE_ID}/templates/tabs/background.html`,\n    `modules/${MODULE_ID}/templates/tabs/basics.html`,\n    `modules/${MODULE_ID}/templates/tabs/bio.html`,\n    `modules/${MODULE_ID}/templates/tabs/class.html`,\n    `modules/${MODULE_ID}/templates/tabs/equipment.html`,\n    `modules/${MODULE_ID}/templates/tabs/race.html`,\n    `modules/${MODULE_ID}/templates/tabs/spells.html`,\n    `modules/${MODULE_ID}/templates/tabs/start.html`,\n  ];\n\n  return loadTemplates(templatePaths);\n}\n","import CompendiumSourcesSubmenu from './compendiumSourcesSubmenu';\nimport { MODULE_ID, LOG_PREFIX } from './constants';\nimport HeroCreationTool from './heroCreationToolApp';\nimport SettingKeys, { PrivateSettingKeys } from './settings';\n\ninterface DnD5eGame extends Game {\n  dnd5e: {\n    advancement: {\n      types: {\n        [key: string]: any;\n      };\n    };\n  };\n}\n\nexport function getGame(): DnD5eGame {\n  if (!(game instanceof Game)) {\n    throw new Error('game is not initialized yet!');\n  }\n  return game as DnD5eGame;\n}\n\nexport function setPanelScrolls($section: JQuery) {\n  const individualScrolls = getModuleSetting(SettingKeys.INDIVIDUAL_PANEL_SCROLLS);\n  const scroll = 'hct-overflow-y-scroll';\n  const height = 'hct-h-full';\n\n  const $leftPanel = $('.hct-panel-left', $section);\n  const $rightPanel = $('.hct-panel-right', $section);\n  const $panelContainer = $('.hct-panel-container', $section);\n\n  if (individualScrolls) {\n    $leftPanel.addClass(scroll);\n    $rightPanel.addClass(scroll);\n    $panelContainer.addClass(height);\n    $section.removeClass(scroll);\n  } else {\n    $leftPanel.removeClass(scroll);\n    $rightPanel.removeClass(scroll);\n    $panelContainer.removeClass(height);\n    $section.addClass(scroll);\n  }\n}\n\nexport async function setModuleSetting(key: SettingKeys | PrivateSettingKeys, value: any) {\n  await game.settings.set(MODULE_ID, key, value);\n}\n\nexport function getModuleSetting(key: SettingKeys | PrivateSettingKeys) {\n  return game.settings.get(MODULE_ID, key);\n}\n\nexport function getAbilityModifierValue(value: number) {\n  return Math.floor((value - 10) / 2);\n}\n\nexport function filterItemList<T>({\n  filterValues,\n  filterField,\n  itemList,\n}: {\n  filterValues: string[];\n  filterField: string;\n  itemList: T[];\n}): T[] {\n  if (!itemList) return [];\n  const filtered = itemList.filter((item: any) => {\n    const req: string = getProperty(item, filterField);\n    let reqs: string[];\n    if (req.indexOf(',') > -1) {\n      // feature applies for multiple classes / races / levels\n      reqs = req.split(',').map((r) => r.trim());\n    } else {\n      reqs = [req];\n    }\n    return reqs.some((r) => filterValues.includes(r) && !filterValues.includes(item.name));\n  });\n  return filtered;\n}\n\nexport function addActorDirectoryButton(app: HeroCreationTool) {\n  console.info(`${LOG_PREFIX} | Adding actors directory button`);\n\n  $('.directory-header .header-actions', $('[data-tab=\"actors\"]'))\n    .filter((i, e) => !$(e).has('#hct-directory-button').length)\n    .append(\n      `<button id='hct-directory-button' data-hct_start><i class='fas fa-dice-d20'></i>${game.i18n.localize(\n        'HCT.ActorsDirectoryButton',\n      )}</button>`,\n    );\n  $('[data-hct_start]').on('click', function () {\n    if (userHasRightPermissions()) app.openForNewActor();\n  });\n}\n\nexport function addCreateNewActorButton(app: HeroCreationTool, html: any, dialogApp: any) {\n  console.info(`${LOG_PREFIX} | Adding Create New Actor button`);\n\n  const $hctButton = $(\n    `<button class='dialog-button' data-hct_start>\n      <i class='fas fa-dice-d20'></i>${game.i18n.localize('HCT.ActorsDirectoryButton')}\n    </button>`,\n  );\n\n  $('button', html).after($hctButton); // added after the Create New Actor confirm button\n  $hctButton.on('click', function () {\n    if (userHasRightPermissions()) {\n      const heroName = $('input', html).val() as string;\n      app.openForNewActor(heroName);\n    }\n    dialogApp.close();\n  });\n}\n\ninterface ModuleDataWithApi extends Game.ModuleData<foundry.packages.ModuleData> {\n  api?: {\n    selectSources: () => void;\n    openForNewActor: () => void;\n  };\n}\nexport function setPublicApi(app: HeroCreationTool) {\n  const module: ModuleDataWithApi = game.modules.get(MODULE_ID)!;\n  module.api = {\n    selectSources: () => {\n      const sourcesApp = new CompendiumSourcesSubmenu();\n      sourcesApp.render(true);\n    },\n    openForNewActor: () => app.openForNewActor(),\n  };\n}\n\nfunction userHasRightPermissions(): boolean {\n  const userRole = (game as any).user.role;\n\n  // create actor (REQUIRED)\n  if (!((game as any).permissions.ACTOR_CREATE as Array<number>).includes(userRole)) {\n    ui.notifications?.error(game.i18n.localize('HCT.Permissions.NeedCreateActorError'));\n    return false;\n  }\n\n  // create item (optional)\n  if (!((game as any).permissions.ITEM_CREATE as Array<number>).includes(userRole)) {\n    ui.notifications?.warn(game.i18n.localize('HCT.Permissions.NeedCreateItemWarn'));\n  }\n\n  // upload files (optional)\n  if (!((game as any).permissions.FILES_UPLOAD as Array<number>).includes(userRole)) {\n    ui.notifications?.warn(game.i18n.localize('HCT.Permissions.NeedFileUploadWarn'));\n  }\n\n  // browse files (optional)\n  if (!((game as any).permissions.FILES_BROWSE as Array<number>).includes(userRole)) {\n    ui.notifications?.warn(game.i18n.localize('HCT.Permissions.NeedFileBrowseWarn'));\n  }\n  return true;\n}\n","import HeroOption from './options/heroOption';\n\nexport abstract class Step {\n  readonly step: StepEnum;\n  protected readonly stepOptions: HeroOption[];\n\n  constructor(step: StepEnum) {\n    this.step = step;\n    this.stepOptions = [];\n  }\n\n  /**\n   * Delegation method for this tab to set its own listeners when Application.activateListeners()\n   * is called. Here all HTML event listeners should be registered.\n   */\n  setListeners(): void {\n    return;\n  }\n\n  /**\n   * Method called by the Application for each tab to provide any specific\n   * data this tab might need. Called during the **first** 'renderApp' Hook.\n   *\n   * Might not be needed for every tab.\n   */\n  setSourceData(): void {\n    return;\n  }\n\n  /**\n   * Method called by the Application for each tab to render their internal HTML.\n   * Called at the end of every 'renderApp' Hook.\n   */\n  renderData(data?: any): void {\n    return;\n  }\n\n  /**\n   * Method called by the Application when on final submit,\n   * for every tab to return their options.\n   *\n   * Some options might be defined before, this method been the last chance to created\n   * HeroOptions derived from data, for example on the Abilities tab.\n   *\n   * By default returns stepOptions, but should be overloaded as needed.\n   */\n  getOptions(): HeroOption[] {\n    return this.stepOptions;\n  }\n\n  /**\n   * Method called when another tab needs data from this one, to abstract the internal complexities\n   */\n  getUpdateData(): any {\n    throw Error('getUpdateData() not implemented in step ' + this.constructor.name);\n  }\n\n  /**\n   * Method called when switching to this tab, useful when trying to update this tab's content based on external data\n   * e.g. Updating Spells' spellcasting ability based on Class\n   */\n  update(data?: any): void {\n    throw Error('update() not implemented in step ' + this.constructor.name);\n  }\n\n  clearOptions(): void {\n    this.stepOptions.splice(0, this.stepOptions.length);\n  }\n\n  /**\n   * Helper method that returns the JQuery element representing this tab's entire section.\n   */\n  abstract section(): JQuery;\n}\n\nexport enum StepEnum {\n  Basics = 'basics',\n  Race = 'race',\n  Class = 'class',\n  Abilities = 'abilities',\n  Background = 'background',\n  Equipment = 'equipment',\n  Spells = 'spells',\n  Biography = 'bio',\n}\n","import { StepEnum } from '../step';\nimport type { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\n\n/**\n * Represents an option that will be reflected on the final hero.\n * @interface\n */\nexport default interface HeroOption {\n  render(parent: JQuery): void;\n  value(): any;\n  isFulfilled(): boolean;\n  applyToHero(actor: ActorDataConstructorData): void;\n  key: string;\n  origin: StepEnum;\n  settings: {\n    addValues: boolean;\n  };\n}\n\nexport const apply = (\n  existingData: ActorDataConstructorData,\n  key: string,\n  value: any,\n  addValues: boolean,\n  enforceNumber?: boolean,\n) => {\n  try {\n    [key, value] = getActorDataForProficiency(key, value);\n    if (\n      !key ||\n      !value ||\n      key.indexOf('null') > -1 ||\n      (!Array.isArray(value) && isNaN(value) && typeof value == 'string' && value.indexOf('null') > -1)\n    )\n      return existingData;\n\n    const dataSnapshot: any = {};\n    if (addValues) {\n      // find any previous value on existing data\n      dataSnapshot[key] = getProperty(existingData, key); //getValueFromInnerProperty(existingData, key);\n      if (dataSnapshot[key]) {\n        if (Array.isArray(dataSnapshot[key])) {\n          value = dataSnapshot[key].concat(...value);\n        } else {\n          if (!isNaN(value)) {\n            value = Number.parseInt(dataSnapshot[key]) + Number.parseInt(value);\n          } else {\n            console.error('Expected to add value to previous, but value is not a number nor array');\n          }\n        }\n      }\n    }\n    dataSnapshot[key] = enforceNumber ? Number.parseInt(value) : value;\n    mergeObject(existingData, dataSnapshot);\n  } catch (error) {\n    console.warn('Error on HeroOption.apply(..) - printing error and logging variables');\n    console.error(error);\n    console.warn('existingData: ');\n    console.warn(existingData);\n    console.warn(`key: [${key}]`);\n    console.warn('value: ');\n    console.warn(value);\n    console.warn(`addValues: [${addValues}]`);\n  }\n};\n\nfunction getActorDataForProficiency(key: string, value: any): [key: string, value: any] {\n  if (!isProficiencyKey(key)) return [key, value];\n\n  if (Array.isArray(value) && value.length == 1) {\n    value = value[0];\n  }\n  const baseKey = 'data.traits';\n  let pair: [string, any];\n  if (key === 'skills') {\n    pair = [`data.skills.${value}.value`, 1];\n  } else {\n    if (isCustomKey(key, value)) pair = [`${baseKey}.${key}.custom`, value];\n    else pair = [`${baseKey}.${key}.value`, [value]];\n  }\n  return pair;\n}\n\nfunction isProficiencyKey(key: string): boolean {\n  if (key.indexOf('skill') > -1) return true;\n  if (key.indexOf('language') > -1) return true;\n  if (key.indexOf('weapon') > -1) return true;\n  if (key.indexOf('armor') > -1) return true;\n  if (key.indexOf('tool') > -1) return true;\n  return false;\n}\n\nfunction isCustomKey(key: string, value: string): boolean {\n  const dnd5e = (game as any).dnd5e;\n  let keyList!: string[];\n  switch (key) {\n    case 'weaponProf':\n      keyList = [...Object.keys(dnd5e.config.weaponProficiencies), ...Object.keys(dnd5e.config.weaponIds)];\n      break;\n    case 'armorProf':\n      keyList = [...Object.keys(dnd5e.config.armorProficiencies), ...Object.keys(dnd5e.config.armorIds)];\n      break;\n    case 'toolProf':\n      keyList = [...Object.keys(dnd5e.config.toolProficiencies), ...Object.keys(dnd5e.config.toolIds)];\n      break;\n    case 'languages':\n      keyList = Object.keys(dnd5e.config.languages);\n      break;\n  }\n  for (const key in keyList) {\n    if (keyList[key] === value) return false;\n  }\n  return true;\n}\n","import { StepEnum } from '../step';\nimport { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport HeroOption, { apply } from './heroOption';\n\n/**\n * Represents a manually inputed value by the player for the created actor.\n * Expected to be a String, but should be reasonably easy to use it for numbers or expand it for that use.\n * e.g. Hero name\n * @class\n */\nexport default class InputOption implements HeroOption {\n  constructor(\n    readonly origin: StepEnum,\n    readonly key: string,\n    private placeholder: string,\n    private val: string | number,\n    readonly settings: {\n      addValues: boolean;\n      type: 'text' | 'number';\n      min?: number;\n      max?: number;\n      preLabel?: string;\n      postLabel?: string;\n      class?: string;\n      data?: string;\n    } = { addValues: false, type: 'text' },\n  ) {}\n\n  $elem!: JQuery;\n\n  render($parent: JQuery<HTMLElement>, settings?: { beforeParent: boolean }): void {\n    const $container = $('<div class=\"hct-option\">');\n    const min = this.settings.min ? `min=\"${this.settings.min}\"` : '';\n    const max = this.settings.max ? `max=\"${this.settings.max}\"` : '';\n    const wrapped = !!this.settings.postLabel;\n\n    if (this.settings.preLabel) {\n      const $preLabel = $(`<span class=\"hct-pr-sm hct-w-6/12\">${this.settings.preLabel}</span>`);\n      $container.append($preLabel);\n    }\n\n    const data = this.settings.data;\n    if (wrapped) {\n      const $wrapper = $(`<div class=\"flexrow ${this.settings.class ?? ''}\">`);\n      this.$elem = $(`<input type=\"${this.settings.type}\" placeholder=\"${this.placeholder}\" ${data ?? ''} \n        value=${this.val} ${this.settings.type == 'number' ? `${min} ${max}` : ''}>`);\n      $wrapper.append(this.$elem);\n\n      if (this.settings.postLabel) {\n        const $postLabel = $(`<p class='hct-ml-sm'>${this.settings.postLabel}</p>`);\n        $wrapper.append($postLabel);\n      }\n      $container.append($wrapper);\n    } else {\n      this.$elem = $(`<input class=\"${this.settings.class ?? ''}\"\n        type=\"${this.settings.type}\" placeholder=\"${this.placeholder}\"  ${data ?? ''}  \n        value=${this.val} ${this.settings.type == 'number' ? `${min} ${max}` : ''}>`);\n      $container.append(this.$elem);\n    }\n\n    if (settings?.beforeParent) {\n      $parent.before($container);\n    } else {\n      $parent.append($container);\n    }\n  }\n\n  value(): string | number {\n    const val = this.$elem.val();\n    if (this.settings.type == 'number') return val as number;\n    return val as string;\n  }\n\n  isFulfilled(): boolean {\n    return !!this.$elem.val();\n  }\n\n  applyToHero(actor: ActorDataConstructorData) {\n    apply(actor, this.key, this.value(), this.settings.addValues, this.settings.type === 'number');\n  }\n}\n","/*\n  Functions used exclusively on the Basics tab\n*/\nimport { Step, StepEnum } from '../step';\nimport InputOption from '../options/inputOption';\nimport SettingKeys from '../settings';\nimport { INTEGRATION, MODULE_ID, MYSTERY_MAN } from '../constants';\n\nconst enum ImgType {\n  AVATAR = 'avatar',\n  TOKEN = 'token',\n}\n\ntype TokenizerResponse = {\n  avatarFilename: string;\n  tokenFilename: string;\n};\n\nclass _Basics extends Step {\n  constructor() {\n    super(StepEnum.Basics);\n  }\n\n  section = () => $('#basicsDiv');\n\n  avatarOption!: InputOption;\n  tokenOption!: InputOption;\n  nameOption!: InputOption;\n\n  useTokenizer!: boolean;\n\n  fileChangedCallback(type: ImgType, path: string): void {\n    const $input = type === ImgType.AVATAR ? this.avatarOption.$elem : this.tokenOption.$elem;\n    const $img = $(`[data-img=${type}]`);\n\n    $input.val(path);\n    $img.attr('src', path);\n  }\n\n  setListeners(): void {\n    $('[data-filepick]', this.section()).on('click', (event) => {\n      const pick = $(event.target).data('filepick');\n\n      if (this.useTokenizer && !event.shiftKey) {\n        const module = game.modules.get('vtta-tokenizer');\n\n        if (!module) {\n          ui.notifications?.warn(game.i18n.localize('HCT.Integration.Tokenizer.Error.ModuleNotFound'));\n          this.openFilePicker(pick);\n          return;\n        }\n        if (!module.active) {\n          ui.notifications?.warn(game.i18n.localize('HCT.Integration.Tokenizer.Error.ModuleInactive'));\n          this.openFilePicker(pick);\n          return;\n        }\n        const tokenizerVersion = module?.data.version;\n        if (!tokenizerVersion) {\n          ui.notifications?.error(game.i18n.localize('HCT.Integration.Tokenizer.Error.VersionUnobtainable'));\n          this.openFilePicker(pick);\n          return;\n        }\n        const lastUnsupportedVersion = INTEGRATION.TOKENIZER.VERSION;\n        // search for newer than last unsupported version\n        if (!isNewerVersion(tokenizerVersion, lastUnsupportedVersion)) {\n          ui.notifications?.error(\n            game.i18n.format('HCT.Integration.Tokenizer.Error.VersionIncompatible', {\n              version: lastUnsupportedVersion,\n            }),\n          );\n          this.openFilePicker(pick);\n          return;\n        }\n        if (!this.nameOption.value()) {\n          ui.notifications?.error(game.i18n.localize('HCT.Integration.Tokenizer.NeedActorName'));\n          return;\n        }\n        const tokenizerOptions = {\n          name: this.nameOption.value(),\n          type: 'pc',\n          avatarFilename: this.avatarOption.value(),\n          tokenFilename: this.tokenOption.value(),\n        };\n        (window as any).Tokenizer.launch(tokenizerOptions, (response: TokenizerResponse) => {\n          this.fileChangedCallback(ImgType.AVATAR, response.avatarFilename);\n          this.fileChangedCallback(ImgType.TOKEN, response.tokenFilename);\n        });\n        return;\n      }\n      this.openFilePicker(pick);\n    });\n  }\n\n  setSourceData(): void {\n    this.useTokenizer = game.settings.get(MODULE_ID, SettingKeys.USE_TOKENIZER) as boolean;\n  }\n\n  renderData(data: { actorName?: string }): void {\n    this.clearOptions();\n    this.nameOption = new InputOption(\n      this.step,\n      'name',\n      game.i18n.localize('HCT.Common.RequiredName'),\n      data?.actorName ?? '',\n    );\n    this.nameOption.render($('[data-hero_name] div', this.section()));\n\n    this.avatarOption = new InputOption(this.step, 'img', MYSTERY_MAN, MYSTERY_MAN);\n    this.avatarOption.render($('[data-hero_avatar] div', this.section()));\n\n    this.tokenOption = new InputOption(this.step, 'token.img', MYSTERY_MAN, MYSTERY_MAN);\n    this.tokenOption.render($('[data-hero_token] div', this.section()));\n\n    this.stepOptions.push(this.nameOption, this.avatarOption, this.tokenOption);\n\n    $('[data-tokenizer-warning]').toggle(this.useTokenizer);\n  }\n\n  openFilePicker(input: string) {\n    const path1 = '/';\n    const type: ImgType = input === 'avatar' ? ImgType.AVATAR : ImgType.TOKEN;\n    const fp2 = new FilePicker({\n      type: 'image',\n      current: path1,\n      callback: (path: string) => this.fileChangedCallback(type, path),\n    } as any);\n    fp2.browse('');\n  }\n}\nconst BasicsTab: Step = new _Basics();\nexport default BasicsTab;\n","import { StepEnum } from '../step';\nimport { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport HeroOption, { apply } from './heroOption';\nimport { IndexEntry } from '../indexes/indexUtils';\n\n/**\n * Represents a fixed value that will be imprinted into the created actor\n * (e.g. how all Elves get Perception proficiency)\n * @class\n */\nexport default class FixedOption implements HeroOption {\n  constructor(\n    readonly origin: StepEnum,\n    readonly key: string,\n    private option: string | number | IndexEntry | { cp: number; sp: number; gp: number },\n    private textToShow?: string,\n    readonly settings: {\n      addValues: boolean;\n      type: OptionType;\n    } = { addValues: false, type: OptionType.TEXT },\n  ) {}\n\n  isFulfilled() {\n    return !!this.option;\n  }\n\n  applyToHero(actor: ActorDataConstructorData) {\n    apply(\n      actor,\n      this.key,\n      this.settings.type === OptionType.TEXT || this.settings.type === OptionType.CURRENCY\n        ? this.value()\n        : this.settings.type === OptionType.NUMBER\n        ? (this.value() as number)\n        : [this.value()],\n      this.settings.addValues,\n      this.settings.type === OptionType.NUMBER,\n    );\n  }\n\n  private $textElem = $('<p class=\"hct-option\">').html(`${this.textToShow}`);\n  private $itemImg = $('<img class=\"hct-icon hct-border-0 hct-border-rad-tiny hct-hover-shadow-accent\">');\n  private $itemName = $('<p>');\n\n  /**\n   * Builds the HTML element for this option and appends it to the parent\n   * @param {JQuery} parent\n   */\n  render(parent: JQuery): void {\n    if (this.settings.type === OptionType.TEXT) {\n      parent.append(this.$textElem);\n    } else {\n      const $container = $('<div class=\"hct-icon-with-context\">');\n      const item = this.option as IndexEntry;\n      const $link = item.local\n        ? $(\n            `<a class=\"content-link hct-icon-link\" draggable=\"false\" data-type=\"Item\" data-entity=\"Item\" data-id=\"${item._id}\">`,\n          )\n        : $(`<a class=\"content-link hct-icon-link\" draggable=\"false\" data-pack=\"${item._pack}\" data-id=\"${item._id}\">`);\n      this.$itemImg.attr('src', item.img);\n      $link.append(this.$itemImg);\n      this.$itemName.html(this.textToShow ?? (item.name as string));\n      $container.append($link);\n      $container.append(this.$itemName);\n      parent.append($container);\n    }\n  }\n\n  /**\n   * @returns the current value of this option\n   */\n  value(): any {\n    return this.option;\n  }\n}\n\nexport enum OptionType {\n  TEXT,\n  ITEM,\n  NUMBER,\n  CURRENCY,\n}\n","import { DEFAULT_PACKS, LOG_PREFIX, MODULE_ID } from '../constants';\nimport SettingKeys, { Source, SourceType } from '../settings';\nimport { getGame, getModuleSetting } from '../utils';\n\n/***\n * Builds the indexes for all sources.\n * (note that items without a source compendium are not indexed,\n *  like Class Features or Backgrounds, as they are taken from advancements)\n */\nexport async function buildSourceIndexes() {\n  console.info(`${LOG_PREFIX} | Indexing source compendiums`);\n  const sourcePacks: Source = (await game.settings.get(MODULE_ID, SettingKeys.SOURCES)) as Source;\n  const itemsPromises: Promise<Item | null | undefined>[] = [];\n  game.packs\n    .filter((p) => p.documentName == 'Item')\n    .forEach((p) => {\n      const name = p.collection;\n      const fieldsToIndex = new Set<string>();\n\n      // name added by default on all when indexed\n      addRaceFields(fieldsToIndex, sourcePacks, name);\n      addRacialFeaturesFields(fieldsToIndex, sourcePacks, name);\n      addClassFields(fieldsToIndex, sourcePacks, name);\n      // addClassFeaturesFields(fieldsToIndex, sourcePacks, name);\n      addSubclassFields(fieldsToIndex, sourcePacks, name);\n      addSpellFields(fieldsToIndex, sourcePacks, name);\n      addFeatFields(fieldsToIndex, sourcePacks, name);\n      addBackgroundFields(fieldsToIndex, sourcePacks, name);\n      addEquipmentFields(fieldsToIndex, sourcePacks, name);\n\n      if (fieldsToIndex.size) {\n        fieldsToIndex.add('img');\n        itemsPromises.push((p as any).getIndex({ fields: [...fieldsToIndex] }));\n      }\n    });\n  await Promise.all(itemsPromises);\n}\n\nexport async function buildJournalIndexes() {\n  console.info(`${LOG_PREFIX} | Indexing journals (rules)`);\n  const rulesPack = game.packs.get(DEFAULT_PACKS.RULES);\n  if (!rulesPack) {\n    throw new Error(\n      `${LOG_PREFIX} | Cannot find default DnD5e rules compendium (for indexing sidepanel rules) under name ${DEFAULT_PACKS.RULES}`,\n    );\n  }\n  await (rulesPack as any).getIndex({ fields: ['name', 'content'] });\n}\n\nexport async function getRuleJournalEntryByName(journalName: string) {\n  const entries = await (game.packs.get(DEFAULT_PACKS.RULES)?.index as unknown as Promise<RuleEntry[]>);\n  return entries.find((e) => e.name === journalName);\n}\n\nexport async function getIndexEntriesForSource(source: keyof Source) {\n  const sources: Source = (await game.settings.get(MODULE_ID, SettingKeys.SOURCES)) as Source;\n\n  const indexEntries = [];\n  for (const packName of sources[source]) {\n    const pack = game.packs.get(packName);\n    if (!pack) ui.notifications?.warn(`No pack for name [${packName}]!`);\n    if (pack?.documentName !== 'Item') throw new Error(`${packName} is not an Item pack`);\n    const itemPack = pack as CompendiumCollection<CompendiumCollection.Metadata & { entity: 'Item' }>;\n    if ((itemPack as any).indexed) {\n      const packIndexEntries = [...(await itemPack.index)];\n      indexEntries.push(...packIndexEntries.map((e) => ({ ...e, _pack: packName })));\n    } else {\n      console.error(`Index not built for pack [${packName}] - skipping it`);\n    }\n  }\n  return indexEntries;\n}\n\nexport async function hydrateItems(indexEntries: Array<IndexEntry>): Promise<Item[]> {\n  console.info(`${LOG_PREFIX} | Hydrating items:`);\n  const worldItems = game.items;\n  if (!worldItems) throw new Error('game.items not initialized yet');\n\n  const itemPromises = indexEntries.map(async (indexEntry) => {\n    if ((indexEntry as any).custom) {\n      return indexEntry; // return custom items as-is\n    }\n    const quantity = (indexEntry as any).data?.quantity;\n    // if the entry has a local item, use that instead of fetching it from a compendium\n    const item = indexEntry.local ?? (await game.packs.get(indexEntry._pack)?.getDocument(indexEntry._id));\n    if (!item) throw new Error(`No item for id ${indexEntry._id}!`);\n    const itemForEmbedding = worldItems.fromCompendium(item as Item);\n    if (quantity) {\n      (itemForEmbedding!.data as any).quantity = quantity;\n    }\n    if ((indexEntry as any)._advancement) {\n      (itemForEmbedding as any)._advancement = (indexEntry as any)._advancement;\n    }\n    return itemForEmbedding;\n  });\n  return (await Promise.all(itemPromises)) as any;\n}\n\nexport async function getIndexEntryByUuid(uuid: string): Promise<IndexEntry> {\n  const { pack, id } = parseUuid(uuid);\n\n  if (pack === 'Item') {\n    // local item, not from Compendium\n    const item = getGame().items?.get(id);\n    if (!item) {\n      ui?.notifications?.error(getGame().i18n.format('HCT.Error.IndexEntryNotFound', { uuid }));\n      throw new Error(`No index entry for uuid ${uuid}`);\n    }\n    return toIndexEntry(item);\n  }\n\n  await onceAsync(() => (getGame().packs.get(pack) as any)?.getIndex({ fields: ['img'] }), pack);\n  const packIndex = getGame().packs.get(pack)?.index;\n  if (!packIndex) throw new Error(`Pack ${pack} not indexed or index not found`);\n  // await (packCollection as any)?.getIndex({ fields: ['img'] });\n\n  const indexedEntry = packIndex.find((i) => i._id === id) as IndexEntry;\n  if (!indexedEntry) {\n    ui?.notifications?.error(getGame().i18n.format('HCT.Error.IndexEntryNotFound', { uuid }));\n    throw new Error(`No index entry for uuid ${uuid}`);\n  }\n  return {\n    ...indexedEntry,\n    _pack: pack,\n  };\n}\n\nconst onceAsync = (() => {\n  const indexedPacks: Map<string, Promise<void>> = new Map<string, Promise<void>>();\n\n  return function (loader: () => Promise<void> | undefined, packName: string) {\n    const p = indexedPacks.get(packName);\n    if (p) return p;\n    const newPromise = Promise.resolve(loader());\n    newPromise.catch(() => indexedPacks.delete(packName));\n    indexedPacks.set(packName, newPromise);\n    return newPromise;\n  };\n})();\n\nfunction toIndexEntry(item: Item): IndexEntry {\n  return {\n    _pack: item.pack!,\n    _id: item.data._id!,\n    name: item.name!,\n    type: item.type,\n    img: item.img ?? '',\n    local: item,\n  };\n}\n\nfunction parseUuid(uuid: string): { pack: any; id: any } {\n  const firstDot = uuid.indexOf('.');\n  const lastDot = uuid.lastIndexOf('.');\n\n  const pack = uuid.startsWith('Item') ? 'Item' : uuid.substring(firstDot + 1, lastDot);\n  const id = uuid.substring(lastDot + 1);\n  return { pack, id };\n}\n\nexport type IndexEntry = {\n  _id: string;\n  _pack: string;\n  type: string;\n  name: string;\n  img: string;\n  local?: Item; // for cases where we take the item from the directory instead of from a compendium index\n};\n\nexport type EntryAdvancement = {\n  _id: string;\n  icon: string;\n  type: string;\n};\n\nexport type EntryHitPointsAdvancement = EntryAdvancement & {\n  type: 'HitPoints';\n};\n\nexport type EntryItemGrantAdvancement = EntryAdvancement & {\n  type: 'ItemGrant';\n  level: number;\n  configuration: {\n    items: string[];\n  };\n};\n\nexport type EntryScaleValueAdvancement = EntryAdvancement & {\n  type: 'ScaleValue';\n  title: string;\n  configuration: {\n    identifier: string;\n    type: string;\n    scale: { [key: number]: { value: number } };\n  };\n};\n\n// Race\nexport type RaceEntry = IndexEntry & {\n  data: {\n    requirements: string;\n    description: { value: string };\n  };\n};\nexport function addRaceFields(fieldsToIndex: Set<string>, source: Source, packName: string) {\n  if (source[SourceType.RACES].includes(packName)) {\n    fieldsToIndex.add('data.requirements'); // for figuring subraces\n    fieldsToIndex.add('data.description.value'); // for sidebar\n  }\n}\nexport async function getRaceEntries() {\n  const raceEntries = await (getIndexEntriesForSource(SourceType.RACES) as unknown as Promise<RaceEntry[]>);\n  // sanitize entries to remove anything nonconforming to a Feature (for now, until Race becomes a type)\n  return raceEntries.filter((r) => r.type == 'feat');\n}\n\n// Race Feature\nexport type RacialFeatureEntry = IndexEntry & {\n  data: { requirements: string };\n};\nexport function addRacialFeaturesFields(fieldsToIndex: Set<string>, source: Source, packName: string) {\n  if (source[SourceType.RACIAL_FEATURES].includes(packName)) {\n    fieldsToIndex.add('data.requirements'); // for mapping racial features to races/subraces\n  }\n}\nexport async function getRaceFeatureEntries() {\n  const raceFeatureEntries = await (getIndexEntriesForSource(SourceType.RACIAL_FEATURES) as unknown as Promise<\n    RacialFeatureEntry[]\n  >);\n  // sanitize entries to remove anything nonconforming to a Feature (for now at least, if Race Features become a type in the future)\n  return raceFeatureEntries.filter((f) => f.type == 'feat' && f?.data?.requirements !== '');\n}\n\n// Class\nexport type ClassEntry = IndexEntry & {\n  data: {\n    advancement: (EntryHitPointsAdvancement | EntryItemGrantAdvancement | EntryScaleValueAdvancement)[];\n    description: { value: string };\n    identifier: string;\n    hitDice: string;\n    saves: string[];\n    levels: number;\n    skills: {\n      number: number;\n      choices: string[];\n      value: string[];\n    };\n    spellcasting: {\n      ability: string;\n      progression: string;\n    };\n  };\n};\nexport function addClassFields(fieldsToIndex: Set<string>, source: Source, packName: string) {\n  if (source[SourceType.CLASSES].includes(packName)) {\n    fieldsToIndex.add('data.advancement');\n    fieldsToIndex.add('data.description.value'); // for sidebar\n    fieldsToIndex.add('data.identifier');\n    fieldsToIndex.add('data.hitDice');\n    fieldsToIndex.add('data.saves');\n    fieldsToIndex.add('data.skills');\n    fieldsToIndex.add('data.spellcasting');\n  }\n}\nexport async function getClassEntries() {\n  const classEntries = await (getIndexEntriesForSource(SourceType.CLASSES) as unknown as Promise<ClassEntry[]>);\n  // sanitize entries to remove anything nonconforming to a Class\n  return classEntries.filter((c) => c.type == 'class');\n}\n\n// Class Feature\nexport type ClassFeatureEntry = IndexEntry & {\n  data: {\n    description: { value: string };\n    requirements: string;\n  };\n  _advancement: {\n    id: string;\n    uuid: string;\n    lv?: number;\n  };\n};\n// export function addClassFeaturesFields(fieldsToIndex: Set<string>, source: Source, packName: string) {\n//   if (source[SourceType.CLASS_FEATURES].includes(packName)) {\n//     fieldsToIndex.add('data.requirements'); // for mapping class features to classes\n//     fieldsToIndex.add('data.description'); // used to show Spellcasting/Pact Magic features on the Spells tab\n//   }\n// }\nexport async function getClassFeatureEntries() {\n  const classFeatureEntries = await (getIndexEntriesForSource(SourceType.CLASS_FEATURES) as unknown as Promise<\n    ClassFeatureEntry[]\n  >);\n  // sanitize entries to remove anything nonconforming to a Feature (for now at least, if Class Features become a type in the future)\n  return classFeatureEntries.filter((f) => f.type == 'feat' && f?.data?.requirements !== '');\n}\n\n// Subclass\nexport type SubclassEntry = IndexEntry & {\n  data: {\n    advancement: (EntryItemGrantAdvancement | EntryScaleValueAdvancement)[];\n    description: { value: string };\n    identifier: string;\n    classIdentifier: string;\n    spellcasting: {\n      ability: string;\n      progression: string;\n    };\n  };\n};\nexport function addSubclassFields(fieldsToIndex: Set<string>, source: Source, packName: string) {\n  if (source[SourceType.SUBCLASSES].includes(packName)) {\n    fieldsToIndex.add('data.advancement');\n    fieldsToIndex.add('data.description.value'); // for sidebar\n    fieldsToIndex.add('data.identifier');\n    fieldsToIndex.add('data.classIdentifier');\n    fieldsToIndex.add('data.spellcasting.ability');\n    fieldsToIndex.add('data.spellcasting.progression');\n  }\n}\nexport async function getSubclassEntries() {\n  const sourceEntries = await (getIndexEntriesForSource(SourceType.SUBCLASSES) as unknown as Promise<SubclassEntry[]>);\n  // sanitize entries to remove anything nonconforming to a Subclass\n  const subclassEntries = sourceEntries.filter((c) => c.type == 'subclass');\n  if (getModuleSetting(SettingKeys.TRIM_SUBCLASSES)) {\n    // Mostly for DDBImporter stuff: e.g \"Assassin (Rogue)\" > \"Assassin\"\n    return subclassEntries.map((e) => ({ ...e, name: clearClassName(e.name) }));\n  }\n  return subclassEntries;\n}\n\nfunction clearClassName(name: string) {\n  return name.substring(0, name.lastIndexOf('(') - 1).trim();\n}\n\n// Background\nexport type BackgroundEntry = IndexEntry & unknown;\nexport function addBackgroundFields(fieldsToIndex: Set<string>, source: Source, packName: string) {\n  if (source[SourceType.BACKGROUNDS].includes(packName)) {\n    fieldsToIndex.add('name');\n  }\n}\nexport async function getBackgroundEntries() {\n  const backgroundEntries = await (getIndexEntriesForSource(SourceType.BACKGROUNDS) as unknown as Promise<\n    BackgroundEntry[]\n  >);\n  // sanitize entries to remove anything nonconforming to a Feature (for now at least, if Background Features become a type in the future)\n  return backgroundEntries.filter((f) => f.type == 'background');\n}\n\n// Equipment\nexport type EquipmentEntry = IndexEntry & {\n  data: {\n    price: number;\n    rarity: string;\n    quantity?: number;\n  };\n};\nexport function addEquipmentFields(fieldsToIndex: Set<string>, source: Source, packName: string) {\n  if (source[SourceType.ITEMS].includes(packName)) {\n    fieldsToIndex.add('data.price');\n    fieldsToIndex.add('data.rarity');\n    fieldsToIndex.add('data.quantity');\n    //fieldsToIndex.add('data.description'); maybe description to find Spellcasting Foci ?\n  }\n}\nexport async function getEquipmentEntries() {\n  const equipmentEntries = await (getIndexEntriesForSource(SourceType.ITEMS) as unknown as Promise<EquipmentEntry[]>);\n  // sanitize entries to remove anything nonconforming to an Item\n  return equipmentEntries.filter((e) => !['class', 'feat', 'spell'].includes(e.type));\n}\n\n// Spell\nexport type SpellEntry = IndexEntry & {\n  data: {\n    level: number;\n  };\n};\nexport function addSpellFields(fieldsToIndex: Set<string>, source: Source, packName: string) {\n  if (source[SourceType.SPELLS].includes(packName)) {\n    fieldsToIndex.add('data.level');\n  }\n}\nexport async function getSpellEntries() {\n  const spellEntries = await (getIndexEntriesForSource(SourceType.SPELLS) as unknown as Promise<SpellEntry[]>);\n  // sanitize entries to remove anything nonconforming to a Spell\n  return spellEntries.filter((s) => s.type == 'spell');\n}\n\n// Feat\nexport type FeatEntry = IndexEntry & {\n  data: { requirements: string };\n};\nexport function addFeatFields(fieldsToIndex: Set<string>, source: Source, packName: string) {\n  if (source[SourceType.FEATS].includes(packName)) {\n    fieldsToIndex.add('data.requirements'); // TODO if feat has a requirement show it.\n  }\n}\nexport async function getFeatEntries() {\n  const featEntries = await (getIndexEntriesForSource(SourceType.FEATS) as unknown as Promise<FeatEntry[]>);\n  // sanitize entries to remove anything nonconforming to a Feature (for now at least, if Feats become a type in the future)\n  return featEntries.filter((f) => f.type == 'feat');\n}\n\n// Rule\nexport type RuleEntry = {\n  _id: string;\n  name: string;\n  content: string;\n};\n","import { Step, StepEnum } from '../step';\nimport HeroOption from '../options/heroOption';\nimport FixedOption, { OptionType } from '../options/fixedOption';\nimport SettingKeys from '../settings';\nimport { getRuleJournalEntryByName } from '../indexes/indexUtils';\nimport { getAbilityModifierValue, getModuleSetting, setPanelScrolls } from '../utils';\n\nconst enum EntryMode {\n  ROLL = 'roll',\n  STANDARD_ARRAY = 'standard',\n  POINT_BUY = 'point-buy',\n  MANUAL_ENTRY = 'manual',\n}\n\nclass _Abilities extends Step {\n  constructor() {\n    super(StepEnum.Abilities);\n  }\n\n  section = () => $('#abDiv');\n\n  possibleValues: number[] = [];\n\n  pointBuy = false;\n\n  async setListeners() {\n    // entry mode\n    $('[data-mode]', this.section).on('click', async (event) => {\n      const mode = $(event.target).data('mode');\n\n      this.possibleValues = [];\n      switch (mode) {\n        case EntryMode.ROLL:\n          this.possibleValues = await prepareRolls();\n          break;\n        case EntryMode.STANDARD_ARRAY:\n          this.possibleValues = [15, 14, 13, 12, 10, 8];\n          break;\n        case EntryMode.POINT_BUY:\n          this.possibleValues = [15, 14, 13, 12, 11, 10, 9, 8];\n          $('[data-hct-point-buy-score]').val(0); // reset current score\n          break;\n        case EntryMode.MANUAL_ENTRY:\n          this.possibleValues = [20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1];\n          break;\n      }\n      // handle Point Buy specifics\n      $('[data-hct-point-buy]', this.section).toggle(mode == EntryMode.POINT_BUY);\n      this.pointBuy = mode == EntryMode.POINT_BUY;\n\n      fillAbilitySelects(this.possibleValues, this.section, this.pointBuy);\n      recalculateTotalsAndModifiers(this.pointBuy);\n    });\n\n    //update values when an ability select is changed\n    $('[data-hct-ability-score]', this.section).on('change', (e) => recalculateTotalsAndModifiers(this.pointBuy));\n  }\n\n  async renderData() {\n    setPanelScrolls(this.section());\n\n    // Enable only DM-allowed methods\n    const $methodsContext = $('[data-hct-ability-methods]', this.section);\n    $('[data-mode=\"roll\"]', $methodsContext).prop('disabled', !getModuleSetting(SettingKeys.ENABLE_ASI_ROLL));\n    $('[data-mode=\"standard\"]', $methodsContext).prop('disabled', !getModuleSetting(SettingKeys.ENABLE_ASI_STANDARD));\n    $('[data-mode=\"point-buy\"]', $methodsContext).prop('disabled', !getModuleSetting(SettingKeys.ENABLE_ASI_POINTBUY));\n    $('[data-mode=\"manual\"]', $methodsContext).prop('disabled', !getModuleSetting(SettingKeys.ENABLE_ASI_MANUAL));\n\n    // set proper dice to the Roll button\n    const dice = game.i18n.format('HCT.Abilities.Buttons.Roll', {\n      dice: getModuleSetting(SettingKeys.ABILITY_ROLL_FORMULA),\n    });\n    $('[data-mode=\"roll\"]', $methodsContext).html(dice);\n\n    // Show rules on the side panel\n    const rulesCompendiumName = game.i18n.localize('HCT.Abilities.RulesJournalName');\n    const abilitiesRules = await getRuleJournalEntryByName(rulesCompendiumName);\n    if (abilitiesRules) {\n      $('[data-hct_abilities_description]', this.section()).html(TextEditor.enrichHTML(abilitiesRules.content));\n    } else {\n      console.error(`Unable to find abilities' rule journal on compendium ${rulesCompendiumName}`);\n    }\n\n    // setting default values\n    const $selects = $('[data-hct-ability-score]', this.section);\n    $selects.append($(`<option value=10>10</option>`));\n\n    // set pointbuy max and score\n    const pointBuyMax = getModuleSetting(SettingKeys.POINT_BUY_LIMIT) as number;\n    $('[data-hct-point-buy-max]').val(pointBuyMax);\n  }\n\n  update() {\n    const $raceStats = $('[data-hct-race-ability]');\n    if ($raceStats.length == 0) {\n      $(`[data-hct-ability-score-race-bonus]`).val(0).html('+0');\n    } else {\n      $raceStats.each((i, e) => {\n        const ability = e.dataset.hctRaceAbility;\n        const value = (e as HTMLInputElement).value !== '' ? (e as HTMLInputElement).value : '0';\n        $(`[data-hct-ability-score-race-bonus=${ability}]`)\n          .val(value)\n          .html(value.startsWith('-') ? value : '+' + value);\n      });\n    }\n    recalculateTotalsAndModifiers(this.pointBuy);\n  }\n\n  getOptions(): HeroOption[] {\n    this.clearOptions();\n\n    $('[data-hct-ability-score]', this.section).each((i, e) => {\n      const ability = e.dataset.hctAbilityScore;\n      const value = (e as HTMLOptionElement).value;\n      if (ability && value) {\n        this.stepOptions.push(\n          new FixedOption(this.step, `data.abilities.${ability}.value`, value, 'UNUSED', {\n            addValues: true,\n            type: OptionType.NUMBER,\n          }),\n        );\n      }\n    });\n    return this.stepOptions;\n  }\n}\nconst AbilitiesTab: Step = new _Abilities();\nexport default AbilitiesTab;\n\nasync function prepareRolls() {\n  const abilityRoll = getModuleSetting(SettingKeys.ABILITY_ROLL_FORMULA) as string;\n  const roll = await new Roll(\n    `${abilityRoll} + ${abilityRoll} + ${abilityRoll} + ${abilityRoll} + ${abilityRoll} + ${abilityRoll}`,\n  ).evaluate({ async: true });\n  if (getModuleSetting(SettingKeys.SHOW_ROLLS_AS_MESSAGES)) {\n    roll.toMessage({ flavor: game.i18n.localize('HCT.Abilities.RollChatFlavor') });\n  }\n  return roll.result.split('+').map((r) => Number.parseInt(r.trim()));\n}\n\nfunction fillAbilitySelects(possibleValues: number[], $section: any, isPointBuy: boolean) {\n  const $selects = $('[data-hct-ability-score]', $section);\n  $selects.empty();\n  if (!isPointBuy) {\n    $selects.append(\n      $(\n        `<option selected=\"true\" disabled=\"disabled\">${game.i18n.localize('HCT.Abilities.SelectPlaceholder')}</option>`,\n      ),\n    );\n  }\n  possibleValues.forEach((v) => {\n    const opt = $(`<option value='${v}' ${isPointBuy && v == 8 ? 'selected' : ''}>${v}</option>`);\n    $selects.append(opt);\n  });\n}\n\nfunction recalculateTotalsAndModifiers(isPointBuy: boolean) {\n  const abilities = Object.keys((game as any).dnd5e.config.abilities);\n  let points = 0;\n  abilities.forEach((ab) => {\n    const score = parseInt(($(`[data-hct-ability-score='${ab}']`).val() as string) ?? 10);\n    const race = parseInt($(`[data-hct-ability-score-race-bonus='${ab}']`).val() as string);\n    const $total = $(`[data-hct-ability-score-total='${ab}']`);\n    const $mod = $(`[data-hct-ability-score-mod='${ab}']`);\n\n    const total = score + race;\n    $total.val(total).html(total + '');\n    const modifier = getAbilityModifierValue(total);\n    $mod.html((modifier < 0 ? '' : '+') + modifier);\n\n    if (isPointBuy) {\n      points += getPointBuyCost(score);\n    }\n  });\n  if (isPointBuy) {\n    $('[data-hct-point-buy-score]').val(points);\n  }\n}\n\nfunction getPointBuyCost(score: number) {\n  if (score < 14) return score - 8;\n  return (score - 13) * 2 + 5;\n}\n","import { StepEnum } from '../step';\nimport { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport HeroOption, { apply } from './heroOption';\n\n/**\n * Represents a value needs to be selected by the player with a single output onto the created actor.\n * (e.g. Dwarven's Tool Proficiency is a single option between three defined ones)\n * @class\n */\nexport default class SelectableOption implements HeroOption {\n  constructor(\n    readonly origin: StepEnum,\n    readonly key: string,\n    private options: { key: string; value: string }[],\n    private label: string,\n    readonly settings: {\n      addValues: boolean;\n      default?: string;\n      customizable: boolean;\n    } = { addValues: false, customizable: false },\n    readonly changeCallback?: (data?: any) => void,\n    readonly callbackMapping?: Map<string, string>,\n  ) {\n    this.$elem = $(`<select class=\"hct-grow\">`);\n    if (!settings.default) {\n      this.$elem.append(\n        $(`<option value=\"\" selected disabled hidden>\n      ${game.i18n.localize('HCT.Common.SelectPlaceholder')}</option>`),\n      );\n    }\n    if (this.settings.customizable) {\n      this.$elem.append(\n        $(`<option value=\"custom\">\n      ${game.i18n.localize('HCT.Common.SelectCreateOne')}</option>`),\n      );\n      this.$customValue = $(`<input type=\"text\" placeholder=\"${game.i18n.localize('HCT.Common.RequiredName')}\">`);\n      this.$elem.on('change', () => {\n        const val = this.$elem.val() as string;\n        this.isCustom = val === 'custom';\n        this.$customValue.toggle(this.isCustom);\n        if (this.isCustom) {\n          this.$customValue.val('');\n        }\n        if (changeCallback) changeCallback(val === 'custom' ? val : this.callbackMapping!.get(val));\n      });\n    }\n    this.$elem.append(\n      this.options.map((option) =>\n        $(\n          `<option value=\"${option.key}\" ${option.key === settings.default ? 'selected' : ''}>${game.i18n.localize(\n            option.value,\n          )}</option>`,\n        ),\n      ),\n    );\n  }\n\n  isCustom = false;\n\n  $customValue!: JQuery;\n\n  isFulfilled() {\n    return !!this.value();\n  }\n\n  applyToHero(actor: ActorDataConstructorData) {\n    apply(actor, this.key, this.value(), this.settings.addValues);\n  }\n\n  $elem: JQuery;\n\n  /**\n   * Builds the HTML element for this option and appends it to the parent\n   * @param {JQuery} $parent\n   */\n  render($parent: JQuery, options?: { beforeParent: boolean }): void {\n    const $block = $('<div class=\"hct-option hct-grow\">');\n    if (this.label) {\n      $block.append($('<span class=\"hct-pr-sm\">').text(this.label));\n    }\n    $block.append(this.$elem);\n    const $container = $('<div>');\n    if (this.settings.customizable) {\n      $container.append($block);\n      $container.append($('<div class=\"hct-option\">').append(this.$customValue));\n      this.$customValue.hide();\n    }\n    if (options?.beforeParent) {\n      $parent.before(this.settings.customizable ? $container : $block);\n    } else {\n      $parent.append(this.settings.customizable ? $container : $block);\n    }\n  }\n\n  /**\n   * @returns the current value of this option\n   */\n  value(): any {\n    if (this.settings.customizable && this.$customValue.val()) {\n      return this.$customValue.val();\n    }\n    return this.$elem.val();\n  }\n}\n","import { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport { StepEnum } from '../step';\nimport HeroOption from './heroOption';\n\nexport default class DeletableOption implements HeroOption {\n  constructor(\n    readonly origin: StepEnum,\n    private option: HeroOption,\n    readonly settings: { addValues: boolean; rightPadding?: boolean } = { addValues: true },\n    private deleteCallback: (params?: any) => any,\n    readonly callbackParams?: any,\n    readonly returnThis: boolean = false,\n  ) {}\n  key = '';\n\n  private deleted = false;\n\n  render($parent: JQuery<HTMLElement>): void {\n    const $container = $(\n      `<div class=\"flexrow hct-justify-between hct-w-full\" ${\n        this.callbackParams ? 'id=\"hct_deletable_' + this.callbackParams + '\"' : ''\n      }>`,\n    );\n    const $deleteButton = $(\n      `<button class=\"hct-border-0 hct-bg-inherit hct-grow-0 hover:hct-shadow-none hct-hover-accent ${\n        this.settings.rightPadding ? 'hct-pr-sm' : ''\n      }\"><i class=\"fas fa-trash\"></i></button>`,\n    );\n    $deleteButton.on('click', () => {\n      this.deleted = true;\n      this.deleteCallback((this.returnThis ? this : this.callbackParams) || this);\n    });\n    this.option.render($container);\n    $container.append($deleteButton);\n    $parent.append($container);\n  }\n  value() {\n    return this.deleted ? undefined : this.option.value();\n  }\n  isFulfilled(): boolean {\n    return this.deleted ? true : this.option.isFulfilled();\n  }\n  applyToHero(actor: ActorDataConstructorData): void {\n    if (!this.deleted) this.option.applyToHero(actor);\n  }\n}\n","import { StepEnum } from '../step';\nimport { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport SelectableOption from './selectableOption';\nimport HeroOption from './heroOption';\nimport InputOption from './inputOption';\nimport DeletableOption from './deletableOption';\n\n/**\n * Represents an array of values selected by the player for the created actor.\n * (e.g. A class allowing to pick 2 skills from a list)\n * @class\n */\nexport default class MultiOption implements HeroOption {\n  constructor(\n    readonly origin: StepEnum,\n    readonly key: string,\n    private options: { key: string; value: string }[],\n    private quantity: number,\n    private label: string,\n    readonly settings: {\n      addValues: boolean;\n      expandable?: boolean;\n      customizable?: boolean;\n    } = { addValues: false, expandable: false, customizable: false },\n  ) {}\n\n  isFulfilled() {\n    return this.value().length > 0;\n  }\n\n  applyToHero(actor: ActorDataConstructorData) {\n    this.optionMap.forEach((v) => v.applyToHero(actor));\n  }\n\n  optionMap: Map<string, HeroOption> = new Map<string, HeroOption>();\n  $container!: JQuery;\n\n  /**\n   * Builds the HTML element for this option and appends it to the parent\n   * @param {JQuery} $p\n   */\n  render($parent: JQuery): void {\n    this.$container = $(`<div class=\"hct-options-container\">`);\n    const $titleDiv = $('<div class=\"flexrow hct-justify-between hct-w-full\" data-hct_opt_container_title>');\n    const $title = $(`<p class=\"hct-grow\">${this.label}</p>`);\n    $titleDiv.append($title);\n\n    if (this.settings.expandable) {\n      const $addButton = $(\n        '<button class=\"hct-border-0 hct-grow-0 hct-bg-inherit hover:hct-shadow-none hct-hover-accent-alt\"><i class=\"fas fa-plus\"></i></button>',\n      );\n      $addButton.on('click', () => {\n        if (!this.settings.customizable) {\n          this.addOption();\n        } else {\n          const d = new Dialog({\n            title: game.i18n.localize('HCT.Common.ProfDialogTitle'),\n            content: `<p>${game.i18n.localize('HCT.Common.ProfDialogContent')}</p>`,\n            buttons: {\n              standard: {\n                label: game.i18n.localize('HCT.Common.AddStandard'),\n                callback: () => this.addOption(),\n              },\n              custom: {\n                label: game.i18n.localize('HCT.Common.AddCustom'),\n                callback: () => this.addCustomOption(),\n              },\n            },\n            default: 'standard',\n          });\n          d.render(true);\n        }\n      });\n      $titleDiv.append($addButton);\n    }\n    this.$container.append($titleDiv);\n\n    this.optionMap = new Map();\n    for (let i = 0; i < this.quantity; i++) {\n      const o = new SelectableOption(this.origin, this.key, this.options, ' ', {\n        ...this.settings,\n        customizable: false,\n      });\n      this.optionMap.set(foundry.utils.randomID(), o);\n      o.render(this.$container);\n    }\n\n    $parent.append(this.$container);\n  }\n\n  addOption(): void {\n    const o = new DeletableOption(\n      this.origin,\n      new SelectableOption(this.origin, this.key, this.options, ' ', {\n        ...this.settings,\n        customizable: false,\n      }),\n      { addValues: this.settings.addValues, rightPadding: true },\n      (arg: any) => this.onDelete(arg),\n      foundry.utils.randomID(),\n    );\n    this.optionMap.set(foundry.utils.randomID(), o);\n    o.render(this.$container);\n  }\n\n  addCustomOption(): void {\n    const o = new DeletableOption(\n      this.origin,\n      new InputOption(this.origin, this.key, '...', '', { ...this.settings, type: 'text', preLabel: '' }),\n      { addValues: this.settings.addValues, rightPadding: true },\n      (arg: any) => this.onDelete(arg),\n      foundry.utils.randomID(),\n    );\n    this.optionMap.set(foundry.utils.randomID(), o);\n    o.render(this.$container);\n  }\n\n  onDelete(deletableId: string) {\n    if (deletableId) {\n      $(`#hct_deletable_${deletableId}`, this.$container).remove();\n    }\n    this.optionMap.delete(deletableId);\n  }\n\n  /**\n   * @returns the current value of this option\n   */\n  value(): any[] {\n    const values: any[] = [];\n    this.optionMap.forEach((o) => values.push(o.value()));\n    return values;\n  }\n}\n","import { ProficiencyChoicesType } from './dnd5e';\nimport HeroOption from './options/heroOption';\nimport MultiOption from './options/multiOption';\nimport { StepEnum } from './step';\n\nexport type OptionSettings = {\n  step: StepEnum;\n  $parent: JQuery;\n  pushTo: HeroOption[];\n  quantity: number;\n  filteredOptions?: KeyValue[];\n  addValues: boolean;\n  expandable: boolean;\n  customizable: boolean;\n};\n\ntype KeyValue = {\n  key: string;\n  value: string;\n};\n\nexport function prepareSkillOptions(optionSettings: OptionSettings): MultiOption {\n  const foundrySkills = (game as any).dnd5e.config.skills;\n  const skillChoices: KeyValue[] = Object.keys(foundrySkills).map((k) => ({ key: k, value: foundrySkills[k] }));\n  return prepareOptions(\n    optionSettings,\n    'skills',\n    optionSettings.filteredOptions ?? skillChoices,\n    game.i18n.localize('HCT.Common.SkillProficiencies'),\n  );\n}\n\nexport function prepareLanguageOptions(optionSettings: OptionSettings): MultiOption {\n  const foundryLanguages = (game as any).dnd5e.config.languages;\n  const langChoices: KeyValue[] = Object.keys(foundryLanguages).map((k) => ({ key: k, value: foundryLanguages[k] }));\n  return prepareOptions(\n    optionSettings,\n    'languages',\n    optionSettings.filteredOptions ?? langChoices,\n    game.i18n.localize('HCT.Common.LanguageProficiencies'),\n  );\n}\n\nexport async function prepareToolOptions(optionSettings: OptionSettings) {\n  const toolChoices = await (game as any).dnd5e.applications.ProficiencySelector.getChoices('tool');\n\n  return prepareOptions(\n    optionSettings,\n    'toolProf',\n    optionSettings.filteredOptions ?? toKeyValues(toolChoices),\n    game.i18n.localize('HCT.Common.ToolProficiencies'),\n  );\n}\n\nexport async function prepareWeaponOptions(optionSettings: OptionSettings) {\n  const weaponChoices = await (game as any).dnd5e.applications.ProficiencySelector.getChoices('weapon');\n\n  return prepareOptions(\n    optionSettings,\n    'weaponProf',\n    optionSettings.filteredOptions ?? toKeyValues(weaponChoices),\n    game.i18n.localize('HCT.Common.WeaponProficiencies'),\n  );\n}\n\nexport async function prepareArmorOptions(optionSettings: OptionSettings) {\n  const armorChoices = await (game as any).dnd5e.applications.ProficiencySelector.getChoices('armor');\n\n  return prepareOptions(\n    optionSettings,\n    'armorProf',\n    optionSettings.filteredOptions ?? toKeyValues(armorChoices),\n    game.i18n.localize('HCT.Common.ArmorProficiencies'),\n  );\n}\n\nexport function prepareOptions(\n  optionSettings: OptionSettings,\n  key: string,\n  options: KeyValue[],\n  containerLabel: string,\n): MultiOption {\n  const container = new MultiOption(optionSettings.step, key, options, optionSettings.quantity, containerLabel, {\n    addValues: optionSettings.addValues,\n    expandable: optionSettings.expandable,\n    customizable: optionSettings.customizable,\n  });\n  return container;\n}\n\nconst toKeyValues = (prof?: ProficiencyChoicesType): KeyValue[] => {\n  if (!prof) return [];\n\n  const parentTypes = Object.keys(prof).map((p) => ({ key: p, value: prof[p].label }));\n  const childrenTypes = Object.values(prof).flatMap((p) => {\n    if (!p.children) return [];\n    return Object.keys(p.children).flatMap((ck) => {\n      return { key: ck, value: p.children![ck].label };\n    });\n  });\n  return [...parentTypes, ...childrenTypes];\n};\n","import { StepEnum } from '../step';\nimport { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport HeroOption, { apply } from './heroOption';\n\n/**\n * Represents a value that is given to the created actor but doesn't need user input\n * e.g. the foundry Items that will be added to the Actor, like Race/Class.\n * @class\n */\nexport default class HiddenOption implements HeroOption {\n  constructor(\n    readonly origin: StepEnum,\n    readonly key: string,\n    readonly opt: any,\n    readonly settings: {\n      addValues: boolean;\n    } = { addValues: false },\n  ) {}\n\n  render(parent: JQuery<HTMLElement>): void {\n    throw new Error('Hidden hero options should not be rendered');\n  }\n\n  value(): any {\n    return this.opt;\n  }\n\n  isFulfilled(): boolean {\n    return !!this.value();\n  }\n\n  applyToHero(actor: ActorDataConstructorData): void {\n    apply(actor, this.key, this.value(), this.settings.addValues);\n  }\n}\n","import { StepEnum } from '../step';\nimport { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport HeroOption, { apply } from './heroOption';\nimport { IndexEntry } from '../indexes/indexUtils';\nimport { MYSTERY_MAN, NONE_ICON } from '../constants';\n\n/**\n * Represents a value needs to be selected by the player with a single output onto the created actor.\n * (e.g. Dwarven's Tool Proficiency is a single option between three defined ones)\n * @class\n */\nexport default class SearchableIndexEntryOption implements HeroOption {\n  readonly settings: {\n    addValues: boolean;\n    customizable: boolean;\n  } = { addValues: true, customizable: false };\n\n  constructor(\n    readonly origin: StepEnum,\n    readonly key: 'items',\n    private options: IndexEntry[],\n    private selectCallback: (id: string | null) => any,\n    private placeholder?: string,\n    readonly hideImage?: boolean,\n  ) {\n    this.options = [this.noneOption, ...options];\n    this.searchArray = [];\n  }\n\n  private noneOption: IndexEntry = {\n    _id: 'none',\n    _pack: '',\n    name: 'None',\n    img: NONE_ICON,\n    type: 'none',\n  };\n\n  isFulfilled() {\n    return !!this.value() && this.value() !== this.noneOption;\n  }\n\n  applyToHero(actor: ActorDataConstructorData) {\n    if (this.isFulfilled()) {\n      apply(actor, this.key, [this.value()], this.settings.addValues);\n    }\n  }\n\n  private $input!: JQuery;\n  private $img!: HTMLImageElement;\n  private $link!: JQuery;\n  private $resultBox!: JQuery;\n  private searchArray: Array<IndexEntry>;\n  private selected?: IndexEntry;\n\n  render($parent: JQuery, options?: { prepend: boolean }): void {\n    const $container = $('<div class=\"hct-icon-with-context\">');\n    if (!this.hideImage) {\n      const item = this.value();\n      this.$link = item?.local\n        ? $(\n            `<a class=\"content-link hct-icon-link\" draggable=\"false\" data-type=\"Item\" data-entity=\"Item\" data-id=\"${item._id}\">`,\n          )\n        : $(\n            `<a class=\"content-link hct-icon-link\" draggable=\"false\" data-pack=\"${item?._pack}\" data-id=\"${item?._id}\">`,\n          );\n      this.$img = document.createElement('img');\n      this.$img.classList.add('hct-icon');\n      this.$img.classList.add('hct-border-0');\n      this.$img.classList.add('hct-border-rad-tiny');\n      this.$img.classList.add('hct-hover-shadow-accent');\n      this.$img.src = item?.img ?? MYSTERY_MAN;\n      this.$link.append(this.$img);\n      $container.append(this.$link);\n    }\n\n    const $form = $(`<form data-hct-searchbar autocomplete=\"off\">`);\n    const $searchWrapper = $(`<div class=\"hct-search-wrapper\">`);\n    this.$input = $(\n      `<input type=\"text\" placeholder=\"${this.placeholder ?? game.i18n.localize('HCT.Common.Searchbar.Placeholder')}\">`,\n    );\n    this.$input.on('click', (e: any) => {\n      if (this.$input.val() == '') {\n        this.searchArray = this.options;\n      }\n      this.$input.trigger('select');\n      $searchWrapper.addClass('active');\n      this.showSuggestions(this.searchArray);\n      this.setSuggestionsInteraction($searchWrapper);\n    });\n    this.$input.on('keyup', (e: any) => {\n      const userInput = (e.target as any).value;\n      if (userInput) {\n        this.searchArray = this.options.filter((value) => {\n          return (value.name as any)\n            .toLocaleLowerCase()\n            .replaceAll(/\\s/g, '')\n            .includes(userInput.toLocaleLowerCase().replaceAll(/\\s/g, ''));\n        });\n        $searchWrapper.addClass('active');\n        this.showSuggestions(this.searchArray);\n        this.setSuggestionsInteraction($searchWrapper);\n      } else {\n        $searchWrapper.removeClass('active');\n      }\n    });\n    $searchWrapper.append(this.$input);\n\n    this.$resultBox = $(`<div class=\"hct-search-autocom-box\" data-hct-searchbar-results>`);\n    $searchWrapper.append(this.$resultBox);\n\n    $form.append($searchWrapper);\n    $container.append($form);\n    $form.on('submit', (e) => false);\n    if (options?.prepend) {\n      $parent.prepend($container);\n    } else {\n      $parent.append($container);\n    }\n  }\n\n  private setSuggestionsInteraction($searchWrapper: JQuery<HTMLElement>) {\n    $('div', this.$resultBox).on('click', (event) => {\n      const id = $(event.currentTarget).data('key');\n      $searchWrapper.removeClass('active');\n      this.selected = this.options.find((o) => o._id === id || o.name === id); // Results use id, Items use name\n      this.$input.val(this.selected?.name ?? id);\n\n      this.selectCallback(id !== 'none' ? id : null);\n      if (!this.hideImage) {\n        this.$img.src = id !== 'none' ? this.selected?.img ?? MYSTERY_MAN : NONE_ICON;\n\n        this.$link.attr('data-id', this.selected!._id);\n        if (this.selected?.local) {\n          this.$link.attr('data-type', 'Item');\n          this.$link.attr('data-entity', 'Item');\n        } else {\n          this.$link.attr('data-pack', this.selected!._pack);\n        }\n      }\n    });\n  }\n\n  value(): IndexEntry | undefined {\n    return this.selected;\n  }\n\n  showSuggestions(searchArray: Array<IndexEntry>) {\n    let listData;\n    if (!searchArray.length) {\n      listData = `<li>${'No matches'}</li>`;\n    } else {\n      listData = searchArray\n        .map(\n          (result) =>\n            `<li>\n              <div class=\"hct-icon-with-context\" data-key=\\\"${result._id ?? result.name}\\\">\n                <img class=\"hct-icon-square-med hct-bg-black hct-border-0\" src=\"${result.img ?? MYSTERY_MAN}\">\n                <span>${result.name}</span>\n              </div>\n            </li>`,\n        )\n        .join('');\n    }\n    this.$resultBox.html(listData);\n  }\n}\n","/*\n  Functions used exclusively on the Race tab\n*/\nimport { Step, StepEnum } from '../step';\nimport * as Utils from '../utils';\nimport * as ProficiencyUtils from '../proficiencyUtils';\nimport HeroOption from '../options/heroOption';\nimport HiddenOption from '../options/hiddenOption';\nimport SelectableOption from '../options/selectableOption';\nimport FixedOption, { OptionType } from '../options/fixedOption';\nimport InputOption from '../options/inputOption';\nimport SearchableIndexEntryOption from '../options/searchableIndexEntryOption';\nimport {\n  IndexEntry,\n  FeatEntry,\n  getFeatEntries,\n  RaceEntry,\n  getRaceEntries,\n  RacialFeatureEntry,\n  getRaceFeatureEntries,\n} from '../indexes/indexUtils';\nimport SettingKeys from '../settings';\nimport { MYSTERY_MAN, NONE_ICON } from '../constants';\nimport { getGame } from '../utils';\n\ntype KeyValue = {\n  key: string;\n  value: string;\n};\n\nclass _Race extends Step {\n  private raceEntries?: RaceEntry[];\n  // private pickableRaces?: RaceEntry[];\n  private raceFeatures?: RacialFeatureEntry[];\n\n  private feats?: FeatEntry[];\n\n  private $context!: JQuery;\n  private $raceIcon!: JQuery;\n  private $raceDesc!: JQuery;\n  private $subraceDesc!: JQuery;\n\n  private subraceBlacklist?: string[];\n\n  constructor() {\n    super(StepEnum.Race);\n  }\n\n  section = () => $('#raceDiv');\n\n  setListeners(): void {\n    this.$context = $('[data-hct_race_data]', this.section());\n  }\n\n  async setSourceData() {\n    this.raceEntries = await getRaceEntries();\n    const raceNames = this.raceEntries.filter((entry) => entry.data?.requirements == '').map((race) => race.name);\n\n    const raceFeatureIndexEntries = await getRaceFeatureEntries();\n    this.raceFeatures = raceFeatureIndexEntries?.filter((entry) => !raceNames.includes(entry.name)); //filters out subraces from features\n\n    const featIndexEntries = await getFeatEntries();\n    this.feats = featIndexEntries.sort((a, b) => a.name.localeCompare(b.name));\n\n    this.subraceBlacklist = (Utils.getModuleSetting(SettingKeys.SUBRACES_BLACKLIST) as string)\n      .split(';')\n      .map((e) => e.trim());\n  }\n\n  renderData(): void {\n    Utils.setPanelScrolls(this.section());\n    const $dataSection = $('[data-hct_race_data]').hide();\n    this.$raceIcon = $('[data-hct_race_icon]', this.section());\n    this.$raceDesc = $('[data-hct_race_description]', this.section());\n    this.$subraceDesc = $('[data-hct_subrace_description]', this.section());\n    const $subraceSeparator = $('[data-hct_subrace_separator]', this.section());\n\n    if (!this.raceEntries) {\n      ui.notifications!.error(game.i18n.format('HCT.Error.UpdateValueLoad', { value: 'Races' }));\n      return;\n    }\n\n    const searchableOption = new SearchableIndexEntryOption(\n      this.step,\n      'items',\n      getPickableRaces(this.raceEntries, this.subraceBlacklist ?? []),\n      (raceId) => {\n        if (!raceId) {\n          $dataSection.hide();\n          this.$raceIcon.attr('src', NONE_ICON);\n          this.$raceDesc.html(getGame().i18n.localize('HCT.Race.DescriptionPlaceholder'));\n          this.$subraceDesc.empty();\n          $subraceSeparator.toggle(false);\n          return;\n        }\n        if (!this.raceEntries) {\n          ui.notifications!.error(game.i18n.format('HCT.Error.UpdateValueLoad', { value: 'Races' }));\n          return;\n        }\n        const selectedRace = this.raceEntries.find((e) => e._id === raceId);\n        if (!selectedRace) {\n          throw new Error(`No race found for id ${raceId}`);\n        }\n        const parentRace = getParentRace(selectedRace, this.raceEntries);\n        this.updateRace(selectedRace.name, parentRace ? [parentRace, selectedRace] : [selectedRace]);\n\n        // update icon and description\n        this.$raceIcon.attr('src', selectedRace.img || MYSTERY_MAN);\n        if (parentRace) {\n          this.$raceDesc.html(TextEditor.enrichHTML(parentRace.data.description.value));\n          this.$subraceDesc.html(TextEditor.enrichHTML(selectedRace.data.description.value));\n        } else {\n          this.$raceDesc.html(TextEditor.enrichHTML(selectedRace.data.description.value));\n          this.$subraceDesc.empty();\n        }\n        $subraceSeparator.toggle(!!parentRace);\n      },\n      game.i18n.localize('HCT.Race.Select.Default'),\n      true,\n    );\n    searchableOption.render($('[data-hct-race-search]'));\n  }\n\n  updateRace(raceName: string, raceItems: RaceEntry[]) {\n    this.clearOptions();\n\n    this.setAbilityScoresUi();\n    this.setSizeUi();\n    this.setSensesUi();\n    this.setMovementUi();\n    this.setProficienciesUi();\n    this.setRaceFeaturesUi(raceItems);\n    this.setFeatsUi();\n\n    this.$context.show();\n\n    this.stepOptions.push(new HiddenOption(StepEnum.Race, 'items', raceItems, { addValues: true }));\n    this.stepOptions.push(new HiddenOption(StepEnum.Race, 'data.details.race', raceName));\n  }\n\n  async setProficienciesUi() {\n    const $proficienciesSection = $('[data-hct_race_area=proficiencies]', this.$context).empty();\n    const options = [];\n    options.push(\n      ProficiencyUtils.prepareSkillOptions({\n        step: this.step,\n        $parent: $proficienciesSection,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: false,\n      }),\n    );\n\n    options.push(\n      await ProficiencyUtils.prepareWeaponOptions({\n        step: this.step,\n        $parent: $proficienciesSection,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n\n    options.push(\n      await ProficiencyUtils.prepareArmorOptions({\n        step: this.step,\n        $parent: $proficienciesSection,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n\n    options.push(\n      await ProficiencyUtils.prepareToolOptions({\n        step: this.step,\n        $parent: $proficienciesSection,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n\n    options.push(\n      ProficiencyUtils.prepareLanguageOptions({\n        step: this.step,\n        $parent: $proficienciesSection,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n\n    options.forEach((o) => o.render($proficienciesSection));\n    this.stepOptions.push(...options);\n  }\n\n  setMovementUi(): void {\n    const movementOption = new InputOption(StepEnum.Race, 'data.attributes.movement.walk', '', 30, {\n      addValues: false,\n      type: 'number',\n      preLabel: game.i18n.localize(`HCT.Common.Movement.walk`),\n      postLabel: 'ft',\n      class: 'hct-w-6/12',\n    });\n    const $movementSection = $('[data-hct_race_area=movement]', this.$context).empty();\n    movementOption.render($movementSection);\n    this.stepOptions.push(movementOption);\n  }\n\n  setSensesUi(): void {\n    const sensesOption = new InputOption(StepEnum.Race, 'data.attributes.senses.darkvision', '', 0, {\n      addValues: false,\n      type: 'number',\n      preLabel: game.i18n.localize(`HCT.Common.Senses.darkvision`),\n      postLabel: 'ft',\n      class: 'hct-w-6/12',\n    });\n    const $sensesSection = $('[data-hct_race_area=senses]', this.$context).empty();\n    sensesOption.render($sensesSection);\n    this.stepOptions.push(sensesOption);\n  }\n\n  setSizeUi(): void {\n    const sizeOption = new SelectableOption(StepEnum.Race, 'data.traits.size', getSizeOptions(), '', {\n      addValues: false,\n      default: 'med',\n      customizable: false,\n    });\n    const $sizeSection = $('[data-hct_race_area=size]', this.$context).empty();\n    sizeOption.render($sizeSection);\n    this.stepOptions.push(sizeOption);\n  }\n\n  setAbilityScoresUi(): void {\n    const foundryAbilities = (game as any).dnd5e.config.abilities;\n    const options = Object.keys(foundryAbilities).map((key) => {\n      return new InputOption(StepEnum.Race, `data.abilities.${(key as string).toLowerCase()}.value`, '', 0, {\n        addValues: true,\n        type: 'number',\n        preLabel: `${foundryAbilities[key]}`,\n        class: 'hct-w-6/12',\n        data: `data-hct-race-ability='${key}'`,\n      });\n    });\n    const $abilityScoreSection = $('[data-hct_race_area=abilityScores]', this.$context).empty();\n    options.forEach((o) => o.render($abilityScoreSection));\n    this.stepOptions.push(...options);\n  }\n\n  setRaceFeaturesUi(raceItems: IndexEntry[]): void {\n    const options: HeroOption[] = [];\n    const raceFeatures: RacialFeatureEntry[] = Utils.filterItemList({\n      filterValues: raceItems.map((r) => r.name!),\n      filterField: 'data.requirements',\n      itemList: this.raceFeatures!,\n    });\n    raceFeatures.forEach((feature) => {\n      const featureOption = new FixedOption(RaceTab.step, 'items', feature, undefined, {\n        addValues: true,\n        type: OptionType.ITEM,\n      });\n      options.push(featureOption);\n    });\n\n    const $raceFeaturesSection = $('[data-hct_race_area=features]', this.$context).empty();\n    options.forEach((o) => o.render($raceFeaturesSection));\n    this.stepOptions.push(...options);\n  }\n\n  setFeatsUi(): void {\n    const $featSection = $('[data-hct_race_area=feat]', this.$context).empty();\n\n    const handleFeatSelected = (featId: string | null) => {\n      if (!featId) return;\n      const featEntry = this.feats?.find((f) => f._id == featId);\n      if (!featEntry) {\n        ui.notifications!.error(game.i18n.format('HCT.Error.UpdateValueLoad', { value: 'Feats' })); // FIXME i18n\n        return;\n      }\n      const $imgLink = $('[data-hct_feat_icon]', this.$context);\n      $imgLink.attr('data-pack', featEntry._pack ?? '');\n      $imgLink.attr('data-id', featEntry._id ?? '');\n      $('img', $imgLink)\n        .attr('src', featEntry.img ?? MYSTERY_MAN)\n        .addClass('hct-hover-shadow-accent');\n    };\n\n    const featOption: HeroOption = new SearchableIndexEntryOption(\n      this.step,\n      'items',\n      this.feats ?? [],\n      handleFeatSelected,\n    );\n    featOption.render($featSection);\n    this.stepOptions.push(featOption);\n  }\n}\nconst RaceTab: Step = new _Race();\nexport default RaceTab;\n\nfunction getSizeOptions(): KeyValue[] {\n  const foundrySizes = (game as any).dnd5e.config.actorSizes;\n\n  return Object.keys(foundrySizes).map((k) => ({ key: k, value: foundrySizes[k] }));\n}\n\nfunction validSubraceName(name: string, misleadingFeatureNames: string[]): boolean {\n  return !misleadingFeatureNames.includes(name);\n}\n\nfunction subraceNameIsPartOfRaceName(subraceName: string, parentName: string): boolean {\n  if (parentName.includes(' ')) {\n    return subraceName.includes(parentName);\n  } else {\n    return subraceName.includes(' ') ? subraceName.split(' ').includes(parentName) : subraceName.includes(parentName);\n  }\n}\n\nfunction parentListedAsRequirement(subrace: RaceEntry, parentName: string): boolean {\n  return parentName.includes(subrace.data.requirements);\n}\n\nfunction getPickableRaces(raceEntries: RaceEntry[], misleadingFeatureNames: string[]): IndexEntry[] {\n  const pickableRaces = raceEntries.filter((e) => e.data.requirements == ''); // start with parent races / races without subclasses\n\n  const notParentEntries = raceEntries.filter((e) => e.data.requirements !== '');\n  const parentsToRemove: Set<RaceEntry> = new Set(); // all classes with children are deleted at the end\n  notParentEntries.forEach((e) => {\n    if (validSubraceName(e.name, misleadingFeatureNames)) {\n      const parent = pickableRaces.find(\n        (p) => parentListedAsRequirement(e, p.name) && subraceNameIsPartOfRaceName(e.name, p.name),\n      );\n      if (parent) {\n        // if parent found, add it to the set so main races with children are later removed from the list\n        parentsToRemove.add(parent);\n        pickableRaces.push(e);\n      }\n    }\n  });\n  parentsToRemove.forEach((p) => pickableRaces.splice(pickableRaces.indexOf(p), 1));\n\n  return pickableRaces.sort((a, b) => a.name.localeCompare(b.name));\n}\n\nfunction getParentRace(selectedRace: RaceEntry, raceEntries: RaceEntry[]) {\n  if (selectedRace.data.requirements == '') return null;\n\n  return raceEntries.find((e) => e.name === selectedRace.data.requirements);\n}\n","import * as Utils from './utils';\nimport SettingKeys from './settings';\nimport { CLASS_LEVEL } from './constants';\n\nexport type HpCalculation = 'roll' | 'avg';\n\nexport class HitDie {\n  constructor(private hd: string) {}\n\n  getVal() {\n    return `1${this.hd}`;\n  }\n\n  getMax(): number {\n    return parseInt(this.hd.substring(1));\n  }\n\n  getAvg(): number {\n    const half = Math.ceil(this.getMax() / 2);\n    return half + 1;\n  }\n\n  async calculateHpAtLevel(level: CLASS_LEVEL, method: HpCalculation, conMod: number) {\n    const firstLevelHp = this.getMax() + conMod;\n    if (level === 1) return firstLevelHp;\n\n    let higherLevelHp = 0;\n    if (method === 'avg') {\n      higherLevelHp = (this.getAvg() + conMod) * (level - 1);\n    } else {\n      // roll\n      for (let l = 2; l <= level; l++) {\n        const roll = await new Roll(`${this.getVal()} + ${conMod}`).evaluate({ async: true });\n        if (Utils.getModuleSetting(SettingKeys.SHOW_ROLLS_AS_MESSAGES)) {\n          roll.toMessage({ flavor: game.i18n.format('HCT.Class.HpRollChatFlavor', { lv: l }) });\n        }\n        higherLevelHp += parseInt(roll.result) + conMod;\n      }\n    }\n    return firstLevelHp + higherLevelHp;\n  }\n}\n","import { EntryAdvancement, EntryItemGrantAdvancement, getIndexEntryByUuid, IndexEntry } from './indexes/indexUtils';\n\ninterface AdvancementConfiguration {\n  byId: {\n    [id: string]: Advancement;\n  };\n  byLevel: {\n    [lv: number]: Advancement[];\n  };\n  byType: {\n    HitPoints: HitPointsAdvancement[];\n    ItemGrant: ItemGrantAdvancement[];\n    ScaleValue: ScaleValueAdvancement[];\n  };\n}\n\ninterface Advancement {\n  id: string;\n  title: string;\n  icon: string;\n  levels: number[];\n}\n\ninterface HitPointsAdvancement extends Advancement {\n  hitDie: string;\n  hitDieValue: number;\n}\n\ninterface ItemGrantAdvancement extends Advancement {\n  data: {\n    configuration: {\n      items: string[];\n    };\n  };\n}\n\ninterface ScaleValueAdvancement extends Advancement {\n  identifier: string;\n  data: {\n    configuration: {\n      identifier: string;\n      type: 'number';\n      scale: {\n        [lv: number]: { value: number };\n      };\n    };\n  };\n}\n\nexport function hasAdvancements(item: any): item is { advancement: AdvancementConfiguration } {\n  return item.advancement;\n}\n\nexport function getItemGrantAdvancementsUpToLevel(\n  entry: IndexEntry & { data: { advancement: EntryAdvancement[] } },\n  maxLevel: number,\n): EntryItemGrantAdvancement[] {\n  return entry.data.advancement.filter(\n    (a) => a.type === 'ItemGrant' && maxLevel >= (a as EntryItemGrantAdvancement).level,\n  ) as EntryItemGrantAdvancement[];\n}\n\nexport function getScaleValueAdvancements(\n  entry: IndexEntry & { data: { advancement: EntryAdvancement[] } },\n): EntryItemGrantAdvancement[] {\n  return entry.data.advancement.filter((a) => a.type === 'ScaleValue') as EntryItemGrantAdvancement[];\n}\n\nexport async function buildAdvancementMetadataForEntry(entry: {\n  _uuid: string;\n  _advancement: { id: string; uuid: string; lv?: number };\n}) {\n  return {\n    ...(await getIndexEntryByUuid(entry._uuid)),\n    _advancement: entry._advancement,\n  };\n}\n","/*\n  Functions used exclusively on the Class tab\n*/\nimport { Step, StepEnum } from '../step';\nimport * as Utils from '../utils';\nimport * as ProficiencyUtils from '../proficiencyUtils';\nimport HiddenOption from '../options/hiddenOption';\nimport FixedOption, { OptionType } from '../options/fixedOption';\nimport SearchableIndexEntryOption from '../options/searchableIndexEntryOption';\nimport { HitDie } from '../hitDie';\nimport {\n  getIndexEntryByUuid,\n  ClassEntry,\n  getClassEntries,\n  ClassFeatureEntry,\n  SubclassEntry,\n  getSubclassEntries,\n} from '../indexes/indexUtils';\nimport { MYSTERY_MAN, CLASS_LEVEL, NONE_ICON } from '../constants';\nimport * as Advancements from '../advancementUtils';\nimport { getGame } from '../utils';\nimport HeroOption from '../options/heroOption';\nimport { buildAdvancementMetadataForEntry } from '../advancementUtils';\n\nexport type ClassSpellcastingData = {\n  description?: string;\n  ability: string;\n  progression: string;\n};\n\nclass _Class extends Step {\n  constructor() {\n    super(StepEnum.Class);\n  }\n\n  private classes?: ClassEntry[] = [];\n  private subclasses?: SubclassEntry[] = [];\n\n  private _class?: ClassEntry;\n  private selectedSubclass: SubclassEntry | undefined;\n\n  private classFeatureOptions?: HeroOption[];\n  private subclassFeatureOptions?: HeroOption[];\n\n  private characterLevel: CLASS_LEVEL = 1;\n  private primaryClassHitDie: HitDie | null = null;\n\n  private spellcasting?: ClassSpellcastingData;\n\n  private $classIcon!: JQuery;\n  private $classDesc!: JQuery;\n\n  getUpdateData() {\n    return this._class\n      ? {\n          name: this._class.name,\n          spellcasting: this.spellcasting,\n          level: this.characterLevel,\n          hitDie: this.primaryClassHitDie,\n          hpMethod: (document.querySelector('input[name=\"higher-lv-hp\"]:checked') as HTMLInputElement)?.value ?? 'avg',\n        }\n      : undefined;\n  }\n\n  section = () => $('#classDiv');\n\n  setListeners(): void {\n    // do nothing\n  }\n\n  async setSourceData() {\n    this.classes = (await getClassEntries())?.sort((a, b) => a.name.localeCompare(b.name));\n    this.subclasses = (await getSubclassEntries())?.sort((a, b) => a.name.localeCompare(b.name));\n\n    if (!this.classes) ui.notifications!.error(game.i18n.format('HCT.Error.RenderLoad', { value: 'Classes' }));\n\n    // this.spellGrantingString = (Utils.getModuleSetting(SettingKeys.SPELL_GRANTING_STRING) as string).split(';');\n    // this.fightingStyleString = Utils.getModuleSetting(SettingKeys.FIGHTING_STYLE_STRING) as string;\n  }\n\n  private $primaryClassLevelSelect!: HTMLSelectElement;\n  renderData(): void {\n    Utils.setPanelScrolls(this.section());\n    const $dataSection = $('[data-hct_class_data]', this.section());\n    this.$classIcon = $('[data-hct_class_icon]', this.section());\n    this.$classDesc = $('[data-hct_class_description]', this.section());\n    $dataSection.hide();\n\n    const searchableOption = new SearchableIndexEntryOption(\n      this.step,\n      'items',\n      this.classes!,\n      (classId) => {\n        // callback on selected\n        this.clearOptions();\n        if (!classId) {\n          $dataSection.hide();\n          this.$classIcon.attr('src', NONE_ICON);\n          this.$classDesc.html(getGame().i18n.localize('HCT.Class.DescriptionPlaceholder'));\n          return;\n        }\n        this._class = this.classes!.find((c) => c._id === classId);\n        if (!this._class) {\n          throw new Error(`Error finding class with name ${classId}`);\n        }\n        if (this.classes) {\n          this.updateClass(this.section());\n          this.$primaryClassLevelSelect.disabled = false;\n        } else ui.notifications!.error(game.i18n.format('HCT.Error.UpdateValueLoad', { value: 'Classes' }));\n      },\n      game.i18n.localize('HCT.Class.Select.Default'),\n      true,\n    );\n    const $classSearch = $('[data-hct-class-search]');\n    searchableOption.render($classSearch, { prepend: true });\n    this.$primaryClassLevelSelect = addLevelSelect($classSearch, 'class');\n    this.$primaryClassLevelSelect.disabled = true;\n    this.$primaryClassLevelSelect.addEventListener('change', (event) => {\n      this.characterLevel = parseInt((event.target as any)?.value) as CLASS_LEVEL;\n      this.updateClass(this.section());\n    });\n  }\n\n  getOptions(): HeroOption[] {\n    return [...this.stepOptions, ...(this.subclassFeatureOptions ?? [])];\n  }\n\n  async updateClass($section: JQuery) {\n    const $context = $('[data-hct_class_data]', $section);\n    this.clearOptions();\n    this.subclassFeatureOptions?.splice(0, this.subclassFeatureOptions?.length);\n\n    // icon, description and class item\n    this.$classIcon.attr('src', this._class?.img || MYSTERY_MAN);\n    this.$classDesc.html(TextEditor.enrichHTML(this._class?.data?.description?.value ?? ''));\n    if (!this._class) {\n      throw new Error(`Error finding current class`);\n    }\n    this._class.data.levels = this.characterLevel;\n    this.stepOptions.push(new HiddenOption(ClassTab.step, 'items', [this._class], { addValues: true }));\n\n    const classFeatureEntries = [];\n    const classItemGrants = Advancements.getItemGrantAdvancementsUpToLevel(this._class, this.characterLevel);\n    if (classItemGrants?.length) {\n      const grantedItems = (await Promise.all(\n        classItemGrants\n          .flatMap((iga) =>\n            iga.configuration.items.map((uuid) => ({\n              _uuid: uuid,\n              _advancement: { id: iga._id, uuid, lv: iga.level },\n            })),\n          )\n          .map(buildAdvancementMetadataForEntry),\n      )) as ClassFeatureEntry[];\n      classFeatureEntries.push(...grantedItems);\n    }\n    this.classFeatureOptions = this.buildClassFeatureOptions(classFeatureEntries);\n    this.stepOptions.push(...this.classFeatureOptions);\n\n    // const scaleValues = Advancements.getScaleValueAdvancements(this._class);\n    // TODO investigate this a little more: I see a warning when creating the actor, but it seems to work nonetheless ? it's probably infered by the class somehow\n\n    const subclassesForClass = filterSubclassesForClass(this._class, this.subclasses);\n    this.setSubclassUi($context, subclassesForClass);\n    this.setHitPointsUi($context);\n    this.setSavingThrowsUi($context);\n    this.setProficienciesUi($context);\n    this.setClassFeaturesUi($context, this.classFeatureOptions ?? []);\n\n    this.handleSpellcasting(this._class);\n\n    this.setSpellcastingAbilityIfExisting();\n\n    $('[data-hct_class_data]').show();\n    return;\n\n    function filterSubclassesForClass(_class: ClassEntry, subclasses?: SubclassEntry[]) {\n      return subclasses?.filter((sc) => sc.data.classIdentifier === _class?.data.identifier) ?? [];\n    }\n  }\n\n  private handleSpellcasting(clazz: ClassEntry) {\n    const { ability, progression } = clazz.data.spellcasting;\n    if (progression === 'none') {\n      this.spellcasting = undefined;\n    } else {\n      this.spellcasting = { ability, progression };\n    }\n  }\n\n  private setSubclassUi($context: JQuery<HTMLElement>, subclasses: SubclassEntry[]) {\n    const $section = $('section', $('[data-hct_class_area=subclass]', $context)).empty();\n\n    const handleSubclassChange = async (subclassId: string | null) => {\n      this.subclassFeatureOptions?.splice(0, this.subclassFeatureOptions?.length);\n      if (!subclassId) {\n        this.selectedSubclass = undefined;\n        return;\n      }\n      this.selectedSubclass = this.subclasses!.find((c) => c._id === subclassId);\n\n      if (this.selectedSubclass) {\n        const subclassItemGrants = Advancements.getItemGrantAdvancementsUpToLevel(\n          this.selectedSubclass!,\n          this.characterLevel,\n        );\n        if (subclassItemGrants?.length) {\n          const grantedItems = (await Promise.all(\n            subclassItemGrants.flatMap((iga) => iga.configuration.items).map(getIndexEntryByUuid),\n          )) as ClassFeatureEntry[];\n          this.subclassFeatureOptions = this.buildClassFeatureOptions(grantedItems);\n          this.setClassFeaturesUi($context, [...this.classFeatureOptions!, ...this.subclassFeatureOptions]);\n        }\n      }\n    };\n\n    const searchableSubclassOption = new SearchableIndexEntryOption(\n      this.step,\n      'items',\n      subclasses,\n      (subclassId) => handleSubclassChange(subclassId),\n      game.i18n.localize('HCT.Class.Select.DefaultSubclass'),\n    );\n    searchableSubclassOption.render($section, { prepend: true });\n    this.stepOptions.push(searchableSubclassOption);\n  }\n\n  private setSpellcastingAbilityIfExisting() {\n    const spellCastingAbility = (this._class?.data as any)?.spellcasting?.ability;\n    if (spellCastingAbility) {\n      this.stepOptions.push(\n        new FixedOption(StepEnum.Spells, 'data.attributes.spellcasting', spellCastingAbility, '', {\n          addValues: false,\n          type: OptionType.TEXT,\n        }),\n      );\n    }\n  }\n\n  private async setProficienciesUi($context: JQuery<HTMLElement>) {\n    const $proficiencySection: JQuery = $('section', $('[data-hct_class_area=proficiencies]', $context)).empty();\n    const foundrySkills = (game as any).dnd5e.config.skills;\n    const options = [];\n\n    options.push(\n      ProficiencyUtils.prepareSkillOptions({\n        step: this.step,\n        $parent: $proficiencySection,\n        pushTo: this.stepOptions,\n        filteredOptions: this._class!.data.skills.choices.map((s: string) => ({\n          key: s,\n          value: foundrySkills[s],\n        })),\n        quantity: this._class!.data.skills.number,\n        addValues: true,\n        expandable: false,\n        customizable: false,\n      }),\n    );\n\n    options.push(\n      await ProficiencyUtils.prepareWeaponOptions({\n        step: this.step,\n        $parent: $proficiencySection,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n\n    options.push(\n      await ProficiencyUtils.prepareArmorOptions({\n        step: this.step,\n        $parent: $proficiencySection,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n\n    options.push(\n      await ProficiencyUtils.prepareToolOptions({\n        step: this.step,\n        $parent: $proficiencySection,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n\n    options.push(\n      ProficiencyUtils.prepareLanguageOptions({\n        step: this.step,\n        $parent: $proficiencySection,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n\n    options.forEach((o) => o.render($proficiencySection));\n    this.stepOptions.push(...options);\n  }\n\n  private buildClassFeatureOptions(classFeatureEntries: ClassFeatureEntry[]): HeroOption[] {\n    return classFeatureEntries.map(\n      (feature) =>\n        new FixedOption(ClassTab.step, 'items', feature, undefined, {\n          addValues: true,\n          type: OptionType.ITEM,\n        }),\n    );\n  }\n\n  private async setClassFeaturesUi($context: JQuery<HTMLElement>, featureOptions: HeroOption[]) {\n    const $featuresSection = $('section', $('[data-hct_class_area=features]', $context)).empty();\n    featureOptions.forEach((o) => o.render($featuresSection));\n\n    // FIXME fighting styles dont come in advancements - find a workaround\n    // const fightingStyles = allFeatures.filter((i) => i.name.startsWith(this.fightingStyleString));\n    // allFeatures = allFeatures.filter((i) => !i.name.startsWith(this.fightingStyleString));\n\n    // let fsOption;\n    // if (fightingStyles && fightingStyles.length > 0) {\n    //   fsOption = new SelectableIndexEntryOption(StepEnum.Class, 'items', fightingStyles, {\n    //     addValues: true,\n    //     placeholderName: this.fightingStyleString,\n    //   });\n    //   // fsOption.render($featuresSection);\n    //   // this.stepOptions.push(fsOption);\n    // }\n  }\n\n  private setSavingThrowsUi($context: JQuery<HTMLElement>) {\n    const savingThrows: string[] = (this._class as any).data.saves;\n    const foundryAbilities = (game as any).dnd5e.config.abilities;\n    const $savingThrowsSection = $('section', $('[data-hct_class_area=saving-throws]', $context)).empty();\n    savingThrows.forEach((save) => {\n      const savingThrowOption = new FixedOption(\n        ClassTab.step,\n        `data.abilities.${save}.proficient`,\n        1,\n        foundryAbilities[save],\n      );\n      savingThrowOption.render($savingThrowsSection);\n      this.stepOptions.push(savingThrowOption);\n    });\n  }\n\n  private setHitPointsUi($context: JQuery<HTMLElement>) {\n    this.primaryClassHitDie = new HitDie((this._class as any).data.hitDice);\n    $('[data-hct-class-hp-lv1]', $context).text(this.primaryClassHitDie.getMax());\n    $('[data-hct-class-hp-higher-lv]', $context).text(this.primaryClassHitDie.getVal());\n  }\n}\nconst ClassTab: Step = new _Class();\nexport default ClassTab;\n\nfunction addLevelSelect($parent: JQuery, className: string) {\n  const $select = document.createElement('select');\n  $select.setAttribute(`data-hct-${className}-level`, '');\n  for (let i = 1; i <= 20; i++) {\n    const $opt = document.createElement('option');\n    $opt.value = i + '';\n    $opt.text = game.i18n.format(`HCT.Class.Level`, { lv: i });\n    $select.appendChild($opt);\n  }\n  $parent.append($select);\n\n  return $select;\n}\n","import * as Utils from '../utils';\nimport * as ProficiencyUtils from '../proficiencyUtils';\nimport { Step, StepEnum } from '../step';\nimport SelectableOption from '../options/selectableOption';\nimport {\n  getIndexEntryByUuid,\n  getRuleJournalEntryByName,\n  getBackgroundEntries,\n  RuleEntry,\n  BackgroundEntry,\n} from '../indexes/indexUtils';\nimport { MYSTERY_MAN, NONE_ICON } from '../constants';\nimport SearchableIndexEntryOption from '../options/searchableIndexEntryOption';\nimport * as Advancements from '../advancementUtils';\nimport { getGame } from '../utils';\nimport FixedOption, { OptionType } from '../options/fixedOption';\n\nclass _BackgroundTab extends Step {\n  constructor() {\n    super(StepEnum.Background);\n  }\n\n  section = () => $('#backgroundDiv');\n\n  private backgrounds!: BackgroundEntry[];\n  private backgroundRules?: RuleEntry;\n\n  private $backgroundIcon!: JQuery<HTMLElement>;\n  private $backgroundDesc!: JQuery<HTMLElement>;\n  private $backgroundData!: JQuery;\n\n  private enrichedRules!: string;\n\n  async setSourceData() {\n    this.backgrounds = await getBackgroundEntries();\n  }\n\n  async renderData() {\n    Utils.setPanelScrolls(this.section());\n\n    this.$backgroundIcon = $('[data-hct_background_icon]');\n    this.$backgroundDesc = $('[data-hct_background_description]');\n    this.$backgroundData = $('[data-hct_background_data]').hide();\n\n    // Show rules on the side panel\n    const rulesCompendiumName = game.i18n.localize('HCT.Background.RulesJournalName');\n    this.backgroundRules = await getRuleJournalEntryByName(rulesCompendiumName);\n    if (this.backgroundRules) {\n      this.enrichedRules = TextEditor.enrichHTML(this.backgroundRules.content);\n      this.$backgroundDesc.html(this.enrichedRules);\n    } else {\n      console.error(`Unable to find backgrounds' rule journal on compendium ${rulesCompendiumName}`);\n    }\n\n    const searchableOption = new SearchableIndexEntryOption(\n      this.step,\n      'items',\n      this.backgrounds,\n      this.updateBackground.bind(this),\n      game.i18n.localize('HCT.Background.Select.Default'),\n      true,\n    );\n    searchableOption.render($('[data-hct-background-search]'));\n  }\n\n  setListeners(): void {\n    // do nothing\n  }\n\n  private async updateBackground(backgroundId: string | null) {\n    if (!backgroundId) {\n      this.$backgroundIcon.attr('src', NONE_ICON);\n      this.$backgroundDesc.html(this.enrichedRules);\n      this.$backgroundData.hide();\n      this.clearOptions();\n      return;\n    }\n    const selectedBackground = this.backgrounds.find((e) => e._id === backgroundId);\n    if (!selectedBackground) {\n      throw new Error(`Unexpected error - background with id [${backgroundId} ]not found`);\n    }\n\n    // FIXME remove this when advancements are indexed\n    const backgroundItem = await getGame().packs.get(selectedBackground._pack)?.getDocument(selectedBackground._id);\n    if (!backgroundItem) {\n      throw new Error('Background not found');\n    }\n\n    this.$backgroundData.show();\n    this.clearOptions();\n\n    this.stepOptions.push(\n      new FixedOption(BackgroundTab.step, 'items', selectedBackground, undefined, {\n        addValues: true,\n        type: OptionType.ITEM,\n      }),\n    );\n\n    // update icon and description\n    this.$backgroundIcon.attr('src', selectedBackground.img || MYSTERY_MAN);\n    this.$backgroundDesc.html(TextEditor.enrichHTML((backgroundItem as any).data.data.description?.value ?? ''));\n\n    if (Advancements.hasAdvancements(backgroundItem)) {\n      const itemGrantAdvancements = backgroundItem.advancement.byType.ItemGrant;\n      if (itemGrantAdvancements?.length) {\n        const grantedItems = (await Promise.all(\n          itemGrantAdvancements.flatMap((iga) => iga.data.configuration.items).map(getIndexEntryByUuid),\n        )) as BackgroundEntry[];\n        this.setBackgroundFeatureUi(grantedItems);\n      } else {\n        this.setBackgroundFeatureUi([]);\n      }\n    }\n\n    this.setAlignmentUi();\n    this.setProficienciesUi();\n  }\n\n  private async setProficienciesUi() {\n    const $proficienciesArea = $('[data-hct_area=proficiences]', this.section()).empty();\n    const options = [];\n    options.push(\n      ProficiencyUtils.prepareSkillOptions({\n        step: this.step,\n        $parent: $proficienciesArea,\n        pushTo: this.stepOptions,\n        quantity: 2,\n        addValues: true,\n        expandable: true,\n        customizable: false,\n      }),\n    );\n    options.push(\n      await ProficiencyUtils.prepareToolOptions({\n        step: this.step,\n        $parent: $proficienciesArea,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n    options.push(\n      ProficiencyUtils.prepareLanguageOptions({\n        step: this.step,\n        $parent: $proficienciesArea,\n        pushTo: this.stepOptions,\n        quantity: 0,\n        addValues: true,\n        expandable: true,\n        customizable: true,\n      }),\n    );\n\n    options.forEach((o) => o.render($proficienciesArea));\n    this.stepOptions.push(...options);\n  }\n\n  private setBackgroundFeatureUi(features: BackgroundEntry[]) {\n    const $featureArea = $('[data-hct_area=feature]', this.section()).empty();\n    features.forEach((feature) => {\n      const featureOption = new FixedOption(this.step, 'items', feature, undefined, {\n        addValues: true,\n        type: OptionType.ITEM,\n      });\n      featureOption.render($featureArea);\n      this.stepOptions.push(featureOption);\n    });\n  }\n\n  private setAlignmentUi() {\n    const foundryAligments = (game as any).dnd5e.config.alignments;\n    const alignmentChoices = Object.keys(foundryAligments).map((k) => ({\n      key: foundryAligments[k],\n      value: foundryAligments[k],\n    }));\n    const alignmentOption = new SelectableOption(this.step, 'data.details.alignment', alignmentChoices, '', {\n      addValues: false,\n      customizable: false,\n    });\n    alignmentOption.render($('[data-hct_area=alignment]', this.section()).empty());\n    this.stepOptions.push(alignmentOption);\n  }\n}\nconst BackgroundTab: Step = new _BackgroundTab();\nexport default BackgroundTab;\n","import { StepEnum } from '../step';\nimport { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport HeroOption from './heroOption';\n\n/**\n * Represents a fixed value that will be imprinted into the created actor\n * (e.g. how all Elves get Perception proficiency)\n * @class\n */\nexport default class OptionContainer implements HeroOption {\n  constructor(\n    readonly origin: StepEnum,\n    readonly key: string,\n    private options: HeroOption[],\n    private label?: string,\n    private detail?: string,\n    readonly settings: {\n      addValues: boolean;\n      deletable?: boolean;\n    } = { addValues: false },\n    readonly deleteCallback?: (args?: any) => any,\n    readonly callbackParams?: string,\n  ) {}\n\n  isFulfilled() {\n    return this.options.every((o) => o.isFulfilled());\n  }\n\n  applyToHero(actor: ActorDataConstructorData) {\n    this.options.forEach((o) => o.applyToHero(actor));\n  }\n\n  render($parent: JQuery): void {\n    const $container = $(\n      `<fieldset class=\"hct-option-container\" ${\n        this.settings.deletable ? 'id=\"hct_deletable_' + this.callbackParams + '\"' : ''\n      }>`,\n    );\n    const $legend = $(\n      `<legend class=\"hct-option-container-legend\">${this.label || ''}${\n        this.detail ? ' (' + this.detail + ')' : ''\n      }</legend>`,\n    );\n    $container.append($legend);\n    if (this.settings.deletable && this.deleteCallback) {\n      const $deleteButton = $(\n        `<button class=\"hct-border-0 hct-bg-inherit hct-w-fit hover:hct-shadow-none hct-hover-accent\"><i class=\"fas fa-trash\"></i></button>`,\n      );\n      $deleteButton.on('click', () => {\n        this.deleteCallback!(this);\n      });\n      $legend.append($deleteButton);\n    }\n    this.options.forEach((o) => o.render($container));\n    $parent.append($container);\n  }\n\n  /**\n   * @returns the current value of this option\n   */\n  value(): any[] {\n    return this.options.map((o) => o.value());\n  }\n}\n","import { StepEnum } from '../step';\nimport { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport HeroOption, { apply } from './heroOption';\nimport { EquipmentEntry } from '../indexes/indexUtils';\n\n/**\n * Represents a value with a selectable quantity that will be imprinted into the created actor\n * @class\n */\nexport default class QuantifiableOption implements HeroOption {\n  constructor(\n    readonly origin: StepEnum,\n    private itemOption: EquipmentEntry,\n    readonly settings: {\n      addValues: boolean;\n      quantity: number;\n      canChangeQuantity: boolean;\n      showTotalCost: boolean;\n      price?: number;\n      id?: string;\n      changeCallback?: (id: string, newQuantity: number) => any;\n    } = { addValues: true, quantity: 1, canChangeQuantity: false, showTotalCost: false },\n  ) {}\n  key = 'items';\n\n  isFulfilled() {\n    return !!this.itemOption;\n  }\n\n  applyToHero(actor: ActorDataConstructorData) {\n    this.itemOption.data.quantity = this.settings.quantity;\n    apply(actor, this.key, [this.itemOption], this.settings.addValues, false);\n  }\n\n  private $up = $(\n    `<button id='hct_quantity_button_up' class=\"hct-button--floating\"><i class=\"hct-m-0 fas fa-angle-up\" class=\"hct-p-sm\"></i></button>`,\n  );\n  private $down = $(\n    `<button id='hct_quantity_button_down' class=\"hct-button--floating\"><i class=\"hct-m-0 fas fa-angle-down\" class=\"hct-p-sm\"></i></button>`,\n  );\n  private $text = $(buildText(this.itemOption, this.settings.quantity, this.settings.showTotalCost));\n\n  render(parent: JQuery): void {\n    const $container = $('<div class=\"hct-icon-with-context hct-pb-sm hct-grow\">');\n    const $link = this.itemOption.local\n      ? $(\n          `<a class=\"content-link hct-icon-link\" draggable=\"false\" data-type=\"Item\" data-entity=\"Item\" data-id=\"${this.itemOption._id}\">`,\n        )\n      : $(\n          `<a class=\"content-link hct-icon-link flexrow\" draggable=\"false\" data-pack=\"${this.itemOption._pack}\" data-id=\"${this.itemOption._id}\">`,\n        );\n    const $itemImg = $('<img class=\"hct-icon hct-border-0 hct-border-rad-tiny hct-hover-shadow-accent\">').attr(\n      'src',\n      this.itemOption.img,\n    );\n    $link.append($itemImg);\n    $container.append($link);\n    $container.append(this.$text);\n\n    if (this.settings.canChangeQuantity) {\n      const $buttons = $(`<div class='hct-quantity-buttons'>`);\n      $buttons.append(this.$up);\n      $buttons.append(this.$down);\n      $container.append($buttons);\n\n      this.$up.on('click', (ev) => {\n        if (ev.ctrlKey) {\n          this.settings.quantity += 5;\n        } else {\n          this.settings.quantity++;\n        }\n        this.settings.changeCallback!(this.settings.id!, this.settings.quantity * this.settings.price!);\n        this.$text.html(buildText(this.itemOption, this.settings.quantity, this.settings.showTotalCost));\n      });\n      this.$down.on('click', (ev) => {\n        if (this.settings.quantity > 1) {\n          if (ev.ctrlKey) {\n            this.settings.quantity > 6 ? (this.settings.quantity -= 5) : (this.settings.quantity = 1);\n          } else {\n            this.settings.quantity--;\n          }\n          this.settings.changeCallback!(this.settings.id!, this.settings.quantity * this.settings.price!);\n          this.$text.html(buildText(this.itemOption, this.settings.quantity, this.settings.showTotalCost));\n        }\n      });\n    }\n\n    parent.append($container);\n  }\n\n  /**\n   * @returns the current value of this option\n   */\n  value(): any {\n    return this.itemOption;\n  }\n}\n\nfunction buildText(itemOption: any, quantity: number, showTotal: boolean) {\n  if (showTotal) {\n    const totalPrice = Math.round((itemOption.data.price * quantity + Number.EPSILON) * 100) / 100;\n    return `<p class=\"hct-grow\">${itemOption.name} x${quantity} (${totalPrice}gp)</p>`;\n  } else {\n    return `<p class=\"hct-grow\">${itemOption.name} x${quantity}</p>`;\n  }\n}\n","import * as Utils from '../utils';\nimport { Step, StepEnum } from '../step';\nimport FixedOption from '../options/fixedOption';\nimport SettingKeys from '../settings';\nimport HeroOption from '../options/heroOption';\nimport OptionContainer from '../options/optionContainer';\nimport DeletableOption from '../options/deletableOption';\nimport { EquipmentEntry, getEquipmentEntries, getRuleJournalEntryByName } from '../indexes/indexUtils';\nimport QuantifiableOption from '../options/quantifiableOption';\nimport { MODULE_ID } from '../constants';\n\ntype itemOrPack = {\n  itemName?: string;\n  item?: EquipmentEntry;\n};\n\nclass _Equipment extends Step {\n  constructor() {\n    super(StepEnum.Equipment);\n    this.spentMap.clear();\n  }\n\n  defaultGoldDice!: string;\n  $rollInput!: JQuery;\n  $manualGold!: JQuery;\n  $totalGold!: JQuery;\n  $remainingGold!: JQuery;\n  $extraGold!: JQuery;\n\n  section = () => $('#eqDiv');\n\n  $searchWrapper!: JQuery;\n  $inputBox!: JQuery;\n  $suggBox!: JQuery;\n  $itemList!: JQuery;\n  searchArray: EquipmentEntry[] = [];\n\n  items!: EquipmentEntry[];\n  searchableList!: EquipmentEntry[];\n\n  available = 0;\n  total = 0;\n  extra = 0;\n  spent = 0;\n\n  spentMap: Map<string, number> = new Map();\n\n  async setListeners() {\n    this.$searchWrapper = $('.hct-search-wrapper', this.section());\n    this.$inputBox = $('input', this.$searchWrapper);\n    this.$suggBox = $('[data-hct-searchbar-results]', this.$searchWrapper);\n    this.$itemList = $('[data-hct-itemlist]', this.section());\n    this.$manualGold = $('[data-hct_equipment_manual_gold]', this.section());\n    this.$extraGold = $('[data-hct_equipment_extra]', this.section());\n\n    $('[data-hct-searchbar]', this.section()).on('submit', (event) => {\n      if (this.searchArray.length == 1) {\n        try {\n          this.addItemOrPack({ item: this.searchArray[0] });\n          this.$inputBox.val('');\n        } catch (error) {\n          console.error(error);\n          return false;\n        }\n        this.$searchWrapper.removeClass('active');\n      }\n      return false;\n    });\n\n    $('[data-hct_equipment_roll]', this.section()).on('click', async (e) => {\n      const rollExpression = this.$rollInput.val() as string;\n      const roll = await new Roll(rollExpression).evaluate({ async: true });\n      if (Utils.getModuleSetting(SettingKeys.SHOW_ROLLS_AS_MESSAGES)) {\n        roll.toMessage({ flavor: game.i18n.localize('HCT.Equipment.RollChatFlavor') });\n      }\n      this.available = roll.total ?? 0;\n\n      this.$manualGold.prop('disabled', true).val('');\n      this.updateGold();\n    });\n\n    $('[data-hct_equipment_input]', this.section()).on('click', (e) => {\n      this.$manualGold.prop('disabled', false).val(0);\n      this.available = 0;\n      this.updateGold();\n    });\n\n    this.$manualGold.on('keyup', (e) => {\n      this.available = parseInt(this.$manualGold.val() as string) || 0;\n      this.updateGold();\n    });\n\n    this.$extraGold.on('keyup', (e) => {\n      this.extra = parseInt(this.$extraGold.val() as string) || 0;\n      this.updateGold();\n    });\n\n    $('[data-hct_equipment_clear]', this.section()).on('click', () => {\n      this.clearOptions();\n      this.$itemList.empty();\n      this.spent = 0;\n      this.spentMap.clear();\n      this.updateGold();\n    });\n\n    this.$inputBox.on('keyup', (e) => {\n      const userData = (e.target as any).value;\n      if (userData) {\n        this.searchArray = this.searchableList.filter((data) => {\n          return data.name.toLocaleLowerCase().includes(userData.toLocaleLowerCase());\n        });\n        this.$searchWrapper.addClass('active');\n        this.showSuggestions(this.searchArray);\n        $('div', this.$suggBox).on('click', (event) => {\n          this.select($(event.currentTarget).data('item_name'));\n        });\n      } else {\n        this.$searchWrapper.removeClass('active');\n      }\n    });\n  }\n\n  select(itemName: string) {\n    this.addItemOrPack({ itemName: itemName });\n    this.$inputBox.val('');\n    this.$searchWrapper.removeClass('active');\n  }\n\n  private addItemOrPack(itemOrPack: itemOrPack) {\n    const item = itemOrPack.item ?? this.searchableList.find((i) => i.name == itemOrPack.itemName);\n    if (!item) {\n      console.error(itemOrPack);\n      throw new Error(`Item for item/pack not found`);\n    }\n    if (isPack(item)) {\n      this.addPackToSelection(item.name as PackNames);\n    } else {\n      const id = foundry.utils.randomID();\n      this.addItemOptionToSelection(id, this.makeItemOption(id, item, 1, true, true, true), item.data.price, 1);\n    }\n  }\n\n  showSuggestions(list: EquipmentEntry[]) {\n    let listData;\n    if (!list.length) {\n      listData = `<li>${'No matches'}</li>`;\n    } else {\n      listData = list\n        .map(\n          (item) =>\n            `<li><div class=\"hct-icon-with-context\" data-item_name=\\\"${item.name}\\\"><img class=\"hct-icon-square-med hct-bg-black hct-border-0\" src=\"${item.img}\"><span>${item.name} (${item.data.price}gp)</span></div></li>`,\n        )\n        .join('');\n    }\n    this.$suggBox.html(listData);\n  }\n\n  addPackToSelection(packName: PackNames) {\n    const options = [];\n    const id = foundry.utils.randomID();\n    switch (packName) {\n      case PackNames.BURGLAR:\n        this.items\n          .filter((item) => {\n            const itemsInPack = [\n              'Backpack',\n              'Ball Bearings',\n              'Bell',\n              'Crowbar',\n              'Hammer',\n              'Hooded Lantern',\n              'Tinderbox',\n              'Waterskin',\n              'Hempen Rope (50 ft.)',\n            ];\n            return itemsInPack.includes(item.name!);\n          })\n          .forEach((item) => options.push(this.makeItemOption('', item, 1, false)));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Candle')!, 5, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Piton')!, 10, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Oil Flask')!, 2, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Rations')!, 5, false));\n\n        this.addItemOptionToSelection(\n          id,\n          new OptionContainer(\n            StepEnum.Equipment,\n            'items',\n            options,\n            PackNames.BURGLAR,\n            PackPrices.BURGLAR + 'gp',\n            { addValues: true, deletable: true },\n            (opt: DeletableOption) => this.onDelete(opt),\n            id,\n          ),\n          PackPrices.BURGLAR,\n          1,\n        );\n        break;\n\n      case PackNames.DIPLOMAT:\n        this.items\n          .filter((item) => {\n            const itemsInPack = [\n              'Chest',\n              'Fine Clothes',\n              'Ink Bottle',\n              'Ink Pen',\n              'Lamp',\n              'Perfume',\n              'Sealing Wax',\n              'Soap',\n            ];\n            return itemsInPack.includes(item.name!);\n          })\n          .forEach((item) => options.push(this.makeItemOption('', item, 1, false)));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Map or Scroll Case')!, 2, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Oil Flask')!, 2, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Paper')!, 5, false));\n\n        this.addItemOptionToSelection(\n          id,\n          new OptionContainer(\n            StepEnum.Equipment,\n            'items',\n            options,\n            PackNames.DIPLOMAT,\n            PackPrices.DIPLOMAT + 'gp',\n            { addValues: true, deletable: true },\n            (opt: DeletableOption) => this.onDelete(opt),\n            id,\n          ),\n          PackPrices.DIPLOMAT,\n          1,\n        );\n        break;\n\n      case PackNames.DUNGEONEER:\n        this.items\n          .filter((item) => {\n            const itemsInPack = ['Backpack', 'Crowbar', 'Hammer', 'Tinderbox', 'Waterskin', 'Hempen Rope (50 ft.)'];\n            return itemsInPack.includes(item.name!);\n          })\n          .forEach((item) => options.push(this.makeItemOption('', item, 1, false)));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Piton')!, 10, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Torch')!, 10, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Rations')!, 10, false));\n        this.addItemOptionToSelection(\n          id,\n          new OptionContainer(\n            StepEnum.Equipment,\n            'items',\n            options,\n            PackNames.DUNGEONEER,\n            PackPrices.DUNGEONEER + 'gp',\n            { addValues: true, deletable: true },\n            (opt: DeletableOption) => this.onDelete(opt),\n            id,\n          ),\n          PackPrices.DUNGEONEER,\n          1,\n        );\n        break;\n\n      case PackNames.ENTERTAINER:\n        this.items\n          .filter((item) => {\n            const itemsInPack = ['Backpack', 'Bedroll', 'Waterskin', 'Disguise Kit'];\n            return itemsInPack.includes(item.name!);\n          })\n          .forEach((item) => options.push(this.makeItemOption('', item, 1, false)));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Costume Clothes')!, 2, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Candle')!, 5, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Rations')!, 5, false));\n        this.addItemOptionToSelection(\n          id,\n          new OptionContainer(\n            StepEnum.Equipment,\n            'items',\n            options,\n            PackNames.ENTERTAINER,\n            PackPrices.ENTERTAINER + 'gp',\n            { addValues: true, deletable: true },\n            (opt: DeletableOption) => this.onDelete(opt),\n            id,\n          ),\n          PackPrices.ENTERTAINER,\n          1,\n        );\n        break;\n\n      case PackNames.EXPLORER:\n        this.items\n          .filter((item) => {\n            const itemsInPack = ['Backpack', 'Bedroll', 'Mess Kit', 'Tinderbox', 'Waterskin', 'Hempen Rope (50 ft.)'];\n            return itemsInPack.includes(item.name!);\n          })\n          .forEach((item) => options.push(this.makeItemOption('', item, 1, false)));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Torch')!, 10, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Rations')!, 10, false));\n        this.addItemOptionToSelection(\n          id,\n          new OptionContainer(\n            StepEnum.Equipment,\n            'items',\n            options,\n            PackNames.EXPLORER,\n            PackPrices.EXPLORER + 'gp',\n            { addValues: true, deletable: true },\n            (opt: DeletableOption) => this.onDelete(opt),\n            id,\n          ),\n          PackPrices.EXPLORER,\n          1,\n        );\n        break;\n\n      case PackNames.PRIEST:\n        this.items\n          .filter((item) => {\n            const itemsInPack = ['Backpack', 'Blanket', 'Tinderbox', 'Alms Box', 'Censer', 'Vestments', 'Waterskin'];\n            return itemsInPack.includes(item.name!);\n          })\n          .forEach((item) => options.push(this.makeItemOption('', item, 1, false)));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Candle')!, 10, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Block of Incense')!, 2, false));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Rations')!, 2, false));\n        this.addItemOptionToSelection(\n          id,\n          new OptionContainer(\n            StepEnum.Equipment,\n            'items',\n            options,\n            PackNames.PRIEST,\n            PackPrices.PRIEST + 'gp',\n            { addValues: true, deletable: true },\n            (opt: DeletableOption) => this.onDelete(opt),\n            id,\n          ),\n          PackPrices.PRIEST,\n          1,\n        );\n        break;\n\n      case PackNames.SCHOLAR:\n        this.items\n          .filter((item) => {\n            const itemsInPack = ['Backpack', 'Book of Lore', 'Ink Bottle', 'Ink Pen', 'Bag of Sand', 'Small Knife'];\n            return itemsInPack.includes(item.name!);\n          })\n          .forEach((item) => options.push(this.makeItemOption('', item, 1, false)));\n        options.push(this.makeItemOption('', this.items.find((i) => i.name == 'Parchment')!, 10, false));\n        this.addItemOptionToSelection(\n          id,\n          new OptionContainer(\n            StepEnum.Equipment,\n            'items',\n            options,\n            PackNames.SCHOLAR,\n            PackPrices.SCHOLAR + 'gp',\n            { addValues: true, deletable: true },\n            (opt: DeletableOption) => this.onDelete(opt),\n            id,\n          ),\n          PackPrices.SCHOLAR,\n          1,\n        );\n        break;\n    }\n  }\n\n  onDelete(option: DeletableOption) {\n    this.stepOptions.splice(this.stepOptions.indexOf(option), 1);\n    const deletableId = option.callbackParams;\n    $(`#hct_deletable_${deletableId}`, this.$itemList).remove();\n    this.spentMap.delete(deletableId);\n    this.updateGold();\n  }\n\n  makeItemOption(\n    id: string,\n    item: EquipmentEntry,\n    quantity = 1,\n    deletable = true,\n    canChangeQuantity = false,\n    showTotalCost = false,\n  ): HeroOption {\n    const option = new QuantifiableOption(StepEnum.Equipment, item, {\n      addValues: true,\n      quantity: quantity ?? 1,\n      price: item.data.price,\n      id: id,\n      canChangeQuantity: canChangeQuantity,\n      showTotalCost: showTotalCost,\n      changeCallback: (id, num) => {\n        this.spentMap.set(id, num);\n        this.updateGold();\n      },\n    });\n    if (deletable) {\n      return new DeletableOption(\n        StepEnum.Equipment,\n        option,\n        { addValues: true },\n        (args?: any) => this.onDelete(args),\n        id,\n        true,\n      );\n    } else {\n      return option;\n    }\n  }\n\n  addItemOptionToSelection(id: string, itemOption: HeroOption, cost: number, quantity = 1) {\n    this.spentMap.set(id, cost * quantity);\n    itemOption.render(this.$itemList);\n    this.stepOptions.push(itemOption);\n    this.updateGold();\n  }\n\n  updateGold() {\n    this.spent = Array.from(this.spentMap.values()).reduce((previousValue, currentValue) => {\n      return currentValue + previousValue;\n    }, 0);\n    this.total = this.roundToTwo(this.available) + this.roundToTwo(this.extra);\n    this.$totalGold.html(this.total.toString());\n    this.$remainingGold.html(this.roundToTwo(this.total - this.spent).toString());\n  }\n\n  roundToTwo(num: number) {\n    return Math.round(num * 100 + Number.EPSILON) / 100;\n  }\n\n  async setSourceData() {\n    const filteredItems = await getEquipmentEntries();\n    const itemBlackList = (Utils.getModuleSetting(SettingKeys.EQUIPMENTS_BLACKLIST) as string)\n      .split(';')\n      .map((e) => e.trim());\n    this.items = filteredItems\n      .filter((item) => item?.data?.rarity.toLowerCase() == 'common') // get only common items\n      .filter((item) => !itemBlackList.includes(item.name)); // remove some punctual \"common\" but magical/special items\n\n    this.defaultGoldDice = game.settings.get(MODULE_ID, SettingKeys.DEFAULT_GOLD_DICE) as string;\n  }\n\n  async renderData() {\n    Utils.setPanelScrolls(this.section());\n    // Show rules on the side panel\n    const rulesCompendiumName = game.i18n.localize('HCT.Equipment.RulesJournalName');\n    const equipmentRules = await getRuleJournalEntryByName(rulesCompendiumName);\n    if (equipmentRules) {\n      $('[data-hct_equipment_description]', this.section()).html(TextEditor.enrichHTML(equipmentRules.content));\n    } else {\n      console.error(`Unable to find equipment's rule journal on compendium ${rulesCompendiumName}`);\n    }\n\n    this.searchableList = [...packs, ...this.items.filter((data) => data.name)];\n    this.$rollInput = $('[data-hct_equipment_roll_expression]', this.section()).val(this.defaultGoldDice);\n    this.$totalGold = $('[data-hct_total_gold]', this.section());\n    this.$remainingGold = $('[data-hct_remaining_gold]', this.section());\n    this.available = 0;\n    this.total = 0;\n    this.extra = 0;\n    this.spent = 0;\n  }\n\n  getOptions() {\n    // add remaining gold\n    const remaining = parseFloat(this.$remainingGold.html()) || 0;\n    const $addRemainingCheckbox = $('#hct-remaining-gold', this.section());\n    if ($addRemainingCheckbox.is(':checked') && remaining && remaining > 0) {\n      this.stepOptions.push(\n        new FixedOption(StepEnum.Equipment, 'data.currency', {\n          cp: Math.floor((remaining * 100) % 10),\n          sp: Math.floor((remaining * 10) % 10),\n          gp: Math.floor(remaining),\n        }),\n      );\n    }\n    return this.stepOptions;\n  }\n}\nconst EquipmentTab: Step = new _Equipment();\nexport default EquipmentTab;\n\nfunction isPack(item: EquipmentEntry): boolean {\n  return packs.includes(item);\n}\n\nconst enum PackNames {\n  BURGLAR = \"Burglar's Pack\",\n  DIPLOMAT = \"Diplomat's Pack\",\n  DUNGEONEER = \"Dungeoneer's Pack\",\n  ENTERTAINER = \"Entertainer's Pack\",\n  EXPLORER = \"Explorer's Pack\",\n  PRIEST = \"Priest's Pack\",\n  SCHOLAR = \"Scholar's Pack\",\n}\n\nconst PackPrices = {\n  BURGLAR: 16,\n  DIPLOMAT: 39,\n  DUNGEONEER: 12,\n  ENTERTAINER: 40,\n  EXPLORER: 10,\n  PRIEST: 19,\n  SCHOLAR: 40,\n};\nconst packs: EquipmentEntry[] = [\n  {\n    name: PackNames.BURGLAR,\n    data: { price: PackPrices.BURGLAR, rarity: '' },\n    img: 'icons/tools/hand/lockpicks-steel-grey.webp',\n    _id: '',\n    _pack: '',\n    type: '',\n  },\n  {\n    name: PackNames.DIPLOMAT,\n    data: { price: PackPrices.DIPLOMAT, rarity: '' },\n    img: 'icons/commodities/treasure/medal-ribbon-gold-red.webp',\n    _id: '',\n    _pack: '',\n    type: '',\n  },\n  {\n    name: PackNames.DUNGEONEER,\n    data: { price: PackPrices.DUNGEONEER, rarity: '' },\n    img: 'icons/sundries/lights/torch-brown-lit.webp',\n    _id: '',\n    _pack: '',\n    type: '',\n  },\n  {\n    name: PackNames.ENTERTAINER,\n    data: { price: PackPrices.ENTERTAINER, rarity: '' },\n    img: 'icons/tools/instruments/lute-gold-brown.webp',\n    _id: '',\n    _pack: '',\n    type: '',\n  },\n  {\n    name: PackNames.EXPLORER,\n    data: { price: PackPrices.EXPLORER, rarity: '' },\n    img: 'icons/tools/navigation/map-marked-green.webp',\n    _id: '',\n    _pack: '',\n    type: '',\n  },\n  {\n    name: PackNames.PRIEST,\n    data: { price: PackPrices.PRIEST, rarity: '' },\n    img: 'icons/commodities/treasure/token-gold-cross.webp',\n    _id: '',\n    _pack: '',\n    type: '',\n  },\n  {\n    name: PackNames.SCHOLAR,\n    data: { price: PackPrices.SCHOLAR, rarity: '' },\n    img: 'icons/skills/trades/academics-merchant-scribe.webp',\n    _id: '',\n    _pack: '',\n    type: '',\n  },\n];\n","import * as Utils from '../utils';\nimport { Step, StepEnum } from '../step';\nimport FixedOption, { OptionType } from '../options/fixedOption';\nimport DeletableOption from '../options/deletableOption';\nimport { SpellEntry, getSpellEntries, getRuleJournalEntryByName } from '../indexes/indexUtils';\nimport { ClassSpellcastingData as ClassSpellcastingData } from './classStep';\n\nclass _Spells extends Step {\n  constructor() {\n    super(StepEnum.Spells);\n  }\n\n  section = () => $('#spellsDiv');\n\n  $searchWrapper!: JQuery;\n  $inputBox!: JQuery;\n  $suggBox!: JQuery;\n  $itemList!: JQuery;\n  searchArray: SpellEntry[] = [];\n\n  spells: SpellEntry[] = [];\n  archived: SpellEntry[] = [];\n  rules?: string;\n\n  setListeners(): void {\n    this.$searchWrapper = $('.hct-search-wrapper', this.section());\n    this.$inputBox = $('input', this.$searchWrapper);\n    this.$suggBox = $('[data-hct-searchbar-results]', this.$searchWrapper);\n    this.$itemList = $('[data-hct-itemlist]', this.section());\n\n    $('[data-hct-searchbar]', this.section()).on('submit', (event) => {\n      if (this.searchArray.length == 1) {\n        try {\n          this.addItemToSelection(this.searchArray[0]);\n          this.$inputBox.val('');\n        } catch (error) {\n          console.error(error);\n          return false;\n        }\n      }\n      return false;\n    });\n\n    $('[data-hct_spells_clear]', this.section()).on('click', () => {\n      this.clearOptions();\n      this.$itemList.empty();\n      const deletedItems = this.archived.splice(0);\n      this.spells.push(...deletedItems);\n      $(`[data-hct_lv0_count]`, this.section()).html('0');\n      $(`[data-hct_lv1_count]`, this.section()).html('0');\n    });\n\n    this.$inputBox.on('keyup', (e) => {\n      const userData = (e.target as any).value;\n      if (userData) {\n        this.searchArray = this.spells.filter((data) => {\n          return (data as any).name\n            .toLocaleLowerCase()\n            .replaceAll(/\\s/g, '')\n            .includes(userData.toLocaleLowerCase().replaceAll(/\\s/g, ''));\n        });\n        this.$searchWrapper.addClass('active');\n        this.showSuggestions(this.searchArray);\n        $('div', this.$suggBox).on('click', (event) => {\n          this.select($(event.currentTarget).data('item_name'));\n        });\n      } else {\n        this.$searchWrapper.removeClass('active');\n      }\n    });\n  }\n\n  select(itemName: string) {\n    const item = this.spells.find((s) => s.name === itemName);\n    if (!item) ui.notifications?.error(game.i18n.localize('HCT.Spells.SelectItemError'));\n    this.addItemToSelection(item!);\n    this.$inputBox.val('');\n    this.$searchWrapper.removeClass('active');\n  }\n\n  addItemToSelection(item: SpellEntry) {\n    const itemOption = new DeletableOption(\n      StepEnum.Spells,\n      new FixedOption(StepEnum.Spells, 'items', item, undefined, {\n        addValues: true,\n        type: OptionType.ITEM,\n      }),\n      { addValues: true },\n      (id) => this.onDelete(item),\n      item,\n    );\n    itemOption.render(this.$itemList);\n    this.stepOptions.push(itemOption);\n\n    //remove spell from the available list\n    const removedItem = this.spells.splice(this.spells.indexOf(item), 1);\n    this.archived.push(...removedItem);\n\n    this.changeSpellCount((item.data as any).level, CountChange.UP);\n  }\n\n  onDelete(item: SpellEntry) {\n    const deletedItem = this.archived.splice(this.archived.indexOf(item), 1);\n    this.spells.push(...deletedItem);\n    $(`:contains(${item.name})`, this.$itemList).remove();\n    const optionToDelete = this.stepOptions.find((o) => {\n      const deletable = o as DeletableOption;\n      return deletable?.callbackParams === item;\n    });\n    if (optionToDelete) {\n      this.stepOptions.splice(this.stepOptions.indexOf(optionToDelete), 1);\n    }\n    this.changeSpellCount((item.data as any).level, CountChange.DOWN);\n  }\n\n  showSuggestions(list: SpellEntry[]) {\n    let listData;\n    if (!list.length) {\n      listData = `<li>${'No matches'}</li>`;\n    } else {\n      listData = list\n        .map(\n          (item: any) =>\n            `<li><div class=\"hct-icon-with-context\" data-item_name=\\\"${item.name}\\\"><img class=\"hct-icon-square-med hct-bg-black hct-border-0\" src=\"${item.img}\"><span>${item.name}</span></div></li>`,\n        )\n        .join('');\n    }\n    this.$suggBox.html(listData);\n  }\n\n  async setSourceData() {\n    const spellIndexEntries = await getSpellEntries();\n    const maxLevel = 9;\n    this.spells = spellIndexEntries.filter((item) => item.data.level <= maxLevel);\n  }\n\n  changeSpellCount(spellLevel: number, change: CountChange) {\n    const current = Number.parseInt($(`[data-hct_lv${spellLevel}_count]`, this.section()).html());\n    const newVal = change === CountChange.UP ? current + 1 : current - 1;\n    $(`[data-hct_lv${spellLevel}_count]`, this.section()).html(newVal.toString());\n  }\n\n  async renderData() {\n    Utils.setPanelScrolls(this.section());\n    // Show rules on the side panel\n    const rulesCompendiumName = game.i18n.localize('HCT.Spells.RulesJournalName');\n    const spellsRules = await getRuleJournalEntryByName(rulesCompendiumName);\n    if (spellsRules) {\n      this.rules = TextEditor.enrichHTML(spellsRules.content);\n      $('[data-hct_spells_description]', this.section()).html(this.rules);\n    } else {\n      console.error(`Unable to find spells' rule journal on compendium ${rulesCompendiumName}`);\n    }\n  }\n\n  update(data: any) {\n    const $spellCastingAbilityElem = $('[data-hct_spellcasting_ability]', this.section());\n    const $sidePanel = $('[data-hct_spells_description]', this.section());\n\n    if (!data.class?.spellcasting) {\n      $spellCastingAbilityElem.html(game.i18n.localize('HCT.Spells.NoSpellcastingClass'));\n      $sidePanel.html(this.rules ?? '');\n      return;\n    }\n    const classSpellcasting = data.class.spellcasting as ClassSpellcastingData;\n    const spa = (game as any).dnd5e.config.abilities[classSpellcasting.ability];\n\n    $spellCastingAbilityElem.html(\n      game.i18n.format('HCT.Spells.SpellcastingAbilityBlob', { class: data.class.name, spa: spa }),\n    );\n  }\n}\nconst SpellsTab: Step = new _Spells();\nexport default SpellsTab;\n\nconst enum CountChange {\n  UP,\n  DOWN,\n}\n","import FixedOption from '../options/fixedOption';\nimport HeroOption from '../options/heroOption';\nimport { Step, StepEnum } from '../step';\n\nclass _Bio extends Step {\n  constructor() {\n    super(StepEnum.Biography);\n  }\n\n  section = () => $('#bioDiv');\n\n  getOptions(): HeroOption[] {\n    const options: HeroOption[] = [];\n\n    $('[data-hct_bio_data]', this.section()).map((index, elem) => {\n      const $elem = $(elem);\n      options.push(\n        new FixedOption(StepEnum.Biography, `data.details.${$elem.data('hct_bio_data')}`, $elem.val() as string),\n      );\n    });\n    return options;\n  }\n}\nconst BioTab: Step = new _Bio();\nexport default BioTab;\n","/* Coco Liang\n version 0.1\n This object is a pop-up window to edit the actor's inital levels and stuffs\n */\nimport * as Utils from './utils';\nimport SettingKeys from './settings';\n\nimport BasicsTab from './tabs/basicsStep';\nimport AbilitiesTab from './tabs/abilitiesStep';\nimport RaceTab from './tabs/raceStep';\nimport ClassTab from './tabs/classStep';\nimport BackgroundTab from './tabs/backgroundStep';\nimport EquipmentTab from './tabs/equipmentStep';\nimport SpellsTab from './tabs/spellsStep';\nimport BioTab from './tabs/bioStep';\nimport { Step } from './step';\nimport HeroOption from './options/heroOption';\nimport type { ActorDataConstructorData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs/actorData';\nimport { HitDie, HpCalculation } from './hitDie';\nimport { IndexEntry, hydrateItems } from './indexes/indexUtils';\nimport { LOG_PREFIX, MODULE_ID, MYSTERY_MAN, CLASS_LEVEL } from './constants';\n\nenum StepIndex {\n  Basics,\n  Race,\n  Class,\n  Abilities,\n  Background,\n  Equipment,\n  Spells,\n  Bio,\n}\n\nexport default class HeroCreationTool extends Application {\n  actor?: Actor;\n  actorName?: string;\n  readonly steps: Array<Step>;\n  currentTab: StepIndex = StepIndex.Basics;\n\n  constructor() {\n    super();\n    this.actor = undefined;\n    this.steps = [BasicsTab, RaceTab, ClassTab, AbilitiesTab, BackgroundTab, EquipmentTab, SpellsTab, BioTab];\n  }\n\n  static get defaultOptions() {\n    const options = super.defaultOptions;\n    options.template = `modules/${MODULE_ID}/templates/app.html`;\n    options.width = 720;\n    options.height = 680;\n    options.resizable = true;\n    return options;\n  }\n\n  async openForNewActor(actorName?: string) {\n    this.actor = undefined;\n    this.actorName = actorName;\n    this.options.title = game.i18n.localize('HCT.CreationWindowTitle');\n    console.info(`${LOG_PREFIX} | Opening for new actor${actorName ? ' with name: ' + actorName : ''}`);\n    this.steps.forEach((step) => step.clearOptions());\n    this.currentTab = -1;\n    this.render(true);\n  }\n\n  // for level up\n  // async openForActor(actor: Actor) {\n  //   this.actor = actor;\n  //   this.options.title = game.i18n.localize('HCT.CreationWindowTitle');\n  //   console.info(`${LOG_PREFIX} | Opening for ${actor.name} (id ${actor.id})`);\n  //   this.steps.forEach(step => step.clearOptions());\n  //   this.currentTab = -1;\n  //   this.render(true);\n  // }\n\n  activateListeners() {\n    console.info(`${LOG_PREFIX} | Binding listeners`);\n\n    // listeners specific for each tab\n    for (const step of this.steps) {\n      step.setListeners();\n    }\n\n    // set listeners for tab navigation\n    $('[data-hct_tab_index]').on('click', (event) => {\n      this.currentTab = $(event.target).data('hct_tab_index');\n      this.openTab(this.currentTab);\n    });\n    $('[data-hct_back]').on('click', () => {\n      this.currentTab--;\n      this.openTab(this.currentTab);\n    });\n    $('[data-hct_next]').on('click', () => {\n      this.currentTab++;\n      this.openTab(this.currentTab);\n    });\n    $('[data-hct_submit]').on('click', () => this.confirmSubmittion());\n\n    this.openTab(-1);\n  }\n\n  async setupData() {\n    console.info(`${LOG_PREFIX} | Setting up data-derived elements`);\n    for (const step of this.steps) {\n      await step.setSourceData();\n    }\n  }\n\n  renderChildrenData() {\n    for (const step of this.steps) {\n      step.renderData({ actorName: this.actorName });\n    }\n  }\n\n  private async confirmSubmittion() {\n    new Dialog({\n      title: game.i18n.localize('HCT.Submit.Title'),\n      content: game.i18n.localize('HCT.Submit.Content'),\n      buttons: {\n        yes: {\n          icon: \"<i class='fas fa-check'></i>\",\n          label: game.i18n.localize('HCT.Submit.YesLabel'),\n          callback: () => {\n            this.buildActor();\n          },\n        },\n        no: {\n          icon: \"<i class='fas fa-times'></i>\",\n          label: game.i18n.localize('HCT.Submit.NoLabel'),\n        },\n      },\n      default: 'yes',\n    }).render(true);\n  }\n\n  private async buildActor() {\n    console.info(`${LOG_PREFIX} | Building actor - data used:`);\n    const newActorData = this.initializeActorData();\n    let errors = false;\n    // yeah, a loop label, sue me.\n    mainloop: for (const step of this.steps) {\n      for (const opt of step.getOptions()) {\n        if (this.requiredOptionNotFulfilled(opt)) {\n          errors = true;\n          break mainloop;\n        }\n        await opt.applyToHero(newActorData);\n      }\n    }\n    if (!errors) {\n      // calculate whatever needs inter-tab values like HP\n      cleanUpErroneousItems(newActorData);\n      await calculateStartingHp(newActorData, this.steps[StepIndex.Class].getUpdateData());\n      setTokenSettings(newActorData);\n      const itemsFromActor = newActorData.items; // moving item index entries to a different variable\n      newActorData.items = [];\n      const cls = getDocumentClass('Actor');\n      const actor = new cls(newActorData);\n\n      const newActor = await Actor.create(actor.toObject());\n      if (!newActor) {\n        ui.notifications?.error(game.i18n.format('HCT.Error.ActorCreationError', { name: newActorData?.name }));\n        return;\n      }\n      const itemsFromCompendia = await hydrateItems(itemsFromActor); // hydrating index entries for the actual items\n      const itemsWithoutAdvancements = keepItemsWithoutAdvancements(itemsFromCompendia);\n      const createdItems = await newActor.createEmbeddedDocuments('Item', itemsWithoutAdvancements as any); // adding items after actor creation to process active effects\n\n      const itemsWithAdvancements: Item[] = [];\n\n      const classItem = getItemOfType(itemsFromCompendia, 'class');\n      if (classItem) {\n        setClassLevel(classItem, getLevelFromClass(this.steps[StepIndex.Class].getUpdateData()));\n        itemsWithAdvancements.push(this.buildAdvancements(classItem, createdItems));\n      }\n      const subclassItem = getItemOfType(itemsFromCompendia, 'subclass');\n      if (subclassItem) itemsWithAdvancements.push(this.buildAdvancements(subclassItem, createdItems));\n\n      const backgroundItem = getItemOfType(itemsFromCompendia, 'background');\n      if (backgroundItem) itemsWithAdvancements.push(this.buildAdvancements(backgroundItem, createdItems));\n      await newActor.createEmbeddedDocuments('Item', itemsWithAdvancements as any); // adding the class after Advancements have been filled in\n\n      await (newActor as any).longRest({ dialog: false, chat: false, newDay: true });\n      this.close();\n    }\n\n    function getLevelFromClass(updateData: any): number {\n      return updateData?.level ?? 0;\n    }\n  }\n\n  private buildAdvancements(itemWithAdvancements: Item, createdItems?: any) {\n    (itemWithAdvancements.data as any).advancement = (itemWithAdvancements.data as any).advancement.map((a: any) => {\n      if (a.type === 'ItemGrant') {\n        a.configuration.items.forEach((itemUuid: string) => {\n          const linkedItem = createdItems.find((i: any) => i?.data?.flags?.core?.sourceId === itemUuid);\n          if (linkedItem) {\n            if (!a.value.added) a.value.added = {};\n            a.value.added[linkedItem.id] = itemUuid;\n          }\n        });\n      }\n      return a;\n    });\n    return itemWithAdvancements;\n  }\n\n  private initializeActorData() {\n    const newActor: ActorDataConstructorData & { items: IndexEntry[] } = {\n      name: '',\n      type: 'character',\n      sort: 12000,\n      img: MYSTERY_MAN,\n      token: {\n        actorLink: true,\n        disposition: 1,\n        img: MYSTERY_MAN,\n        vision: true,\n        dimSight: 0,\n        bar1: { attribute: 'attributes.hp' },\n        displayBars: 0,\n        displayName: 0,\n      },\n      items: [],\n    };\n    return newActor;\n  }\n\n  private requiredOptionNotFulfilled(opt: HeroOption): boolean {\n    const key = opt.key;\n    if (key === 'name' && !opt.isFulfilled()) {\n      const errorMessage = game.i18n.format('HCT.Error.RequiredOptionNotFulfilled', { opt: opt.key });\n      ui.notifications?.error(errorMessage);\n      return true;\n    }\n    return false;\n  }\n\n  openTab(index: StepIndex): void {\n    handleNavs(index);\n    $('[data-hct_tab_section]').hide();\n    $('[data-hct_tab_index]').removeClass('active');\n\n    $(`[data-hct_tab_section=${index}]`).show();\n    $(`[data-hct_tab_index=${index}]`).addClass('active');\n    switch (index) {\n      case StepIndex.Spells:\n        this.steps[StepIndex.Spells].update({ class: this.steps[StepIndex.Class].getUpdateData() });\n        break;\n      case StepIndex.Abilities:\n        this.steps[StepIndex.Abilities].update();\n        break;\n    }\n  }\n}\n\nasync function calculateStartingHp(newActor: ActorDataConstructorData, classUpdateData: any) {\n  const totalCon = getProperty(newActor, 'data.abilities.con.value');\n  const conModifier: number = totalCon ? Utils.getAbilityModifierValue(totalCon) : 0;\n  if (!classUpdateData) return 10 + conModifier; // release valve in case there's no class selected\n\n  const hitDie: HitDie = classUpdateData?.hitDie;\n  const startingLevel: CLASS_LEVEL = classUpdateData?.level;\n  const method: HpCalculation = classUpdateData?.hpMethod;\n\n  const startingHp = await hitDie.calculateHpAtLevel(startingLevel, method, conModifier);\n  setProperty(newActor, 'data.attributes.hp.max', startingHp);\n  setProperty(newActor, 'data.attributes.hp.value', startingHp);\n}\n\nfunction setTokenSettings(newActor: ActorDataConstructorData) {\n  const displayBarsSetting = game.settings.get(MODULE_ID, SettingKeys.TOKEN_BAR);\n  setProperty(newActor, 'token.displayBars', displayBarsSetting);\n\n  const displayNameSetting = game.settings.get(MODULE_ID, SettingKeys.TOKEN_NAME);\n  setProperty(newActor, 'token.displayName', displayNameSetting);\n\n  const dimSight = (newActor?.data as any)?.attributes?.senses?.darkvision ?? 0;\n  setProperty(newActor, 'token.dimSight', dimSight);\n}\n\nfunction cleanUpErroneousItems(newActor: ActorDataConstructorData) {\n  let items = getProperty(newActor, 'items');\n  items = items?.filter(Boolean); // filter undefined items\n  if (items) setProperty(newActor, 'items', items);\n  else delete newActor.items;\n}\n\nfunction handleNavs(index: number) {\n  // hides the nav if switching to startDiv, else show them.\n  $('#hct_nav').toggle(index !== -1);\n\n  // disables back/next buttons where appropriate\n  const $footer = $('#hct_footer');\n  $('[data-hct_back]', $footer).prop('disabled', index < StepIndex.Basics);\n  $('[data-hct_next]', $footer).prop('disabled', index >= StepIndex.Bio);\n}\n\nfunction keepItemsWithoutAdvancements(itemsFromCompendia: Item[]) {\n  const typesWithAdvancements = ['class', 'subclass', 'background'];\n  return itemsFromCompendia.filter((i) => !typesWithAdvancements.includes(i.type));\n}\n\nfunction getItemOfType(itemsFromCompendia: Item[], itemType: 'class' | 'subclass' | 'background') {\n  return itemsFromCompendia.find((i) => i.type === itemType)!;\n}\n\nfunction setClassLevel(item: Item, classLevel: number) {\n  (item as any).data.levels = classLevel;\n  return item;\n}\n","import { DEFAULT_PACKS } from '../constants';\nimport SettingKeys from '../settings';\nimport { setModuleSetting } from '../utils';\n\nexport default async () => {\n  ui.notifications?.info(game.i18n.format('HCT.Migrations.Info1'));\n\n  await setModuleSetting(SettingKeys.SOURCES, {\n    races: [DEFAULT_PACKS.RACES],\n    racialFeatures: [DEFAULT_PACKS.RACE_FEATURES],\n    classes: [DEFAULT_PACKS.CLASSES],\n    classFeatures: [DEFAULT_PACKS.CLASS_FEATURES],\n    backgroundFeatures: [],\n    spells: [DEFAULT_PACKS.SPELLS],\n    feats: [],\n  });\n};\n","import { DEFAULT_PACKS } from '../constants';\nimport SettingKeys, { Source } from '../settings';\nimport { getModuleSetting, setModuleSetting } from '../utils';\n\nexport default async () => {\n  ui.notifications?.info(game.i18n.format('HCT.Migrations.Info2'));\n\n  const sourceSettings = getModuleSetting(SettingKeys.SOURCES) as Source;\n  await setModuleSetting(SettingKeys.SOURCES, {\n    ...sourceSettings,\n    items: [DEFAULT_PACKS.ITEMS],\n  });\n};\n","import { DEFAULT_PACKS } from '../constants';\nimport SettingKeys, { Source } from '../settings';\nimport { getModuleSetting, setModuleSetting } from '../utils';\n\nexport default async () => {\n  ui.notifications?.info(game.i18n.format('HCT.Migrations.Info3'));\n\n  const sourceSettings = getModuleSetting(SettingKeys.SOURCES) as Source;\n  const newSourceSettings = {\n    ...sourceSettings,\n    backgrounds: [DEFAULT_PACKS.BACKGROUNDS],\n    subclasses: [DEFAULT_PACKS.SUBCLASSES],\n  };\n  delete (newSourceSettings as any).backgroundFeatures; // remove old Background Features key on sources\n  delete (newSourceSettings as any).classFeatures; // remove old Class Features key on sources\n\n  await setModuleSetting(SettingKeys.SOURCES, newSourceSettings);\n};\n","import { PrivateSettingKeys } from '../settings';\nimport { getModuleSetting, setModuleSetting } from '../utils';\nimport migration_1 from './migration_1';\nimport migration_2 from './migration_2';\nimport migration_3 from './migration_3';\n\nexport default async function performMigrations() {\n  const lastMigration = getModuleSetting(PrivateSettingKeys.LAST_MIGRATION) as number;\n\n  const allMigrations = [migration_1, migration_2, migration_3];\n\n  const migrationsToRun = allMigrations.slice(lastMigration);\n\n  for (const migration of migrationsToRun) {\n    await migration();\n    await setModuleSetting(PrivateSettingKeys.LAST_MIGRATION, allMigrations.indexOf(migration) + 1);\n  }\n}\n","import SettingKeys, { registerSettings } from './settings';\nimport { preloadTemplates } from './preloadTemplates';\nimport HeroCreationTool from './heroCreationToolApp';\nimport { buildJournalIndexes, buildSourceIndexes } from './indexes/indexUtils';\nimport { addActorDirectoryButton, addCreateNewActorButton, getModuleSetting, setPublicApi } from './utils';\nimport performMigrations from './migrations/migrationsHandler';\n\nconst heroCreationTool = new HeroCreationTool();\n\n// Initialize module\nHooks.once('init', async () => {\n  registerSettings();\n  await preloadTemplates();\n});\n\n// Build indexes on ready\nHooks.once('ready', async () => {\n  await buildJournalIndexes();\n  await performMigrations();\n  setPublicApi(heroCreationTool);\n});\n\nHooks.on('renderHeroCreationTool', async function (app: any, html: any, data: any) {\n  await buildSourceIndexes();\n  await heroCreationTool.setupData();\n  heroCreationTool.renderChildrenData();\n});\n\n// Rendering the button on Actor's directory\nHooks.on('renderActorDirectory', () => {\n  if (!getModuleSetting(SettingKeys.BUTTON_ON_DIALOG)) {\n    addActorDirectoryButton(heroCreationTool);\n  }\n});\n\n// Rendering the button on the Create New Actor dialog\nHooks.on('renderApplication', (app: any, html: any, data: any) => {\n  const createNewActorLocalized = game.i18n.format('DOCUMENT.Create', { type: game.i18n.localize('DOCUMENT.Actor') });\n  if (app.title === createNewActorLocalized && getModuleSetting(SettingKeys.BUTTON_ON_DIALOG)) {\n    addCreateNewActorButton(heroCreationTool, html, app);\n  }\n});\n\n// This hooks onto the rendering actor sheet to show the button\n// Hooks.on('renderActorSheet5eCharacter', (app: any, html: HTMLElement, data: any) => {\n//   const $experienceDiv = document.getElementsByClassName('experience')[0];\n//   const $currentExpInput = $experienceDiv.querySelector('[name=\"data.details.xp.value\"]')!;\n//   const maxExp = parseInt(($experienceDiv.querySelector('.max') as HTMLSpanElement).innerText ?? '0');\n//   const currentExp = parseInt(($currentExpInput as HTMLInputElement).value) ?? 0;\n\n//   if (currentExp >= maxExp) {\n//     const $levelUpButton = document.createElement('button');\n//     $levelUpButton.id = 'hct-level-up';\n//     $levelUpButton.setAttribute('type', 'button');\n//     $levelUpButton.style.display = 'block';\n//     $levelUpButton.appendChild(document.createTextNode(game.i18n.localize('HCT.ActorLevelUpButton')));\n//     $levelUpButton.addEventListener('click', async () => {\n//       const actor = game.actors?.get(data.actor._id);\n//       if (!actor) throw new Error(`Unable to find actor for id ${data.actor._id}`);\n//       heroCreationTool.openForActor(actor);\n//       app.close();\n//     });\n\n//     $currentExpInput.before($levelUpButton);\n//   }\n// });\n"],"names":["Utils.getModuleSetting","Utils.setPanelScrolls","ProficiencyUtils.prepareSkillOptions","ProficiencyUtils.prepareWeaponOptions","ProficiencyUtils.prepareArmorOptions","ProficiencyUtils.prepareToolOptions","ProficiencyUtils.prepareLanguageOptions","Utils.filterItemList","Advancements.getItemGrantAdvancementsUpToLevel","Advancements.hasAdvancements","Utils.getAbilityModifierValue"],"mappings":"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"}