const _0xbb40=['isAddPermission','_pGetOptionalFeatureItem_fromSrd','415851LcMmGa','328561rAKzEZ','name','MODULE_NAME','\x0a\x09\x09\x09','effects','copy','_getOptionalFeatureFlags','getExpandedEffects','119901XhjwSv','_pGetAdditionalData','_getSrdAliases','<p><i>','_pIsInSrd','isActorItem','getNameWithSourcePart','requirements','getPrerequisiteText','_foundryData','data','srd','prerequisite','get','\x0a\x09\x09</div>','pGetAdditionalData_','208494ZdQcyG','getSrdCompendiumEntity','URL_TO_HASH_BUILDER','featureType','Invocation:\x20','1bMObAi','pGetOptionalFeatureSideData','MODULE_NAME_FAKE','importOptionalFeature','4pKtoHh','isAddDataFlags','permissions','880623sXliay','length','<div>\x0a\x09\x09\x09','source','440096RRwxIE','_pGetSideData','permission','292545xVOIIR','foundryOptionalfeature','_pGetOptionalFeatureItem_other','entries','modules/','/media/icon/skills.svg','PG_OPT_FEATURES','_getDescriptionValue','pHasOptionalFeatureSideLoadedEffects','find','filterValues','setFirstSection','render','1NrqRoj','pGetAdditionalEffectsRaw_','pMutActorUpdateOptionalFeature','_pGetImagePath','optionalfeature'];const _0x4aa1=function(_0x20854c,_0x531cfb){_0x20854c=_0x20854c-0x1c2;let _0xbb407a=_0xbb40[_0x20854c];return _0xbb407a;};const _0x5205c6=_0x4aa1;(function(_0x10432b,_0x42dc0b){const _0xc3e394=_0x4aa1;while(!![]){try{const _0xa3046d=-parseInt(_0xc3e394(0x1f6))+-parseInt(_0xc3e394(0x1e3))+parseInt(_0xc3e394(0x1d3))*-parseInt(_0xc3e394(0x1ec))+parseInt(_0xc3e394(0x1f3))+parseInt(_0xc3e394(0x1ca))*-parseInt(_0xc3e394(0x1e8))+-parseInt(_0xc3e394(0x1c3))*-parseInt(_0xc3e394(0x1cb))+parseInt(_0xc3e394(0x1ef));if(_0xa3046d===_0x42dc0b)break;else _0x10432b['push'](_0x10432b['shift']());}catch(_0x33827e){_0x10432b['push'](_0x10432b['shift']());}}}(_0xbb40,0x3db72));import{UtilApplications}from'./UtilApplications.js';import{SharedConsts}from'../shared/SharedConsts.js';import{Config}from'./Config.js';import{DataConverter}from'./DataConverter.js';import{Vetools}from'./Vetools.js';import{UtilCompendium}from'./UtilCompendium.js';import{UtilActiveEffects}from'./UtilActiveEffects.js';class DataConverterOptionalfeature{static async['pGetOptionalFeatureItem'](_0x3c2423,_0x187869){const _0x15cf17=_0x4aa1;_0x187869=_0x187869||{};let _0x131cc1;return await this[_0x15cf17(0x1d7)](_0x3c2423,_0x187869)?_0x131cc1=this[_0x15cf17(0x1c9)](_0x3c2423,_0x187869):_0x131cc1=this[_0x15cf17(0x1f8)](_0x3c2423,_0x187869),_0x131cc1;}static async[_0x5205c6(0x1d7)](_0x3d41f4){const _0x500cc0=_0x5205c6,_0xf508f0=await UtilCompendium[_0x500cc0(0x1e4)](_0x500cc0(0x1c7),_0x3d41f4,{'fnGetAliases':this[_0x500cc0(0x1d5)]});return!!_0xf508f0;}static async['_pGetOptionalFeatureItem_fromSrd'](_0x107d6b,_0x2e457c){const _0x565967=_0x5205c6,_0x95540f=await UtilCompendium[_0x565967(0x1e4)]('optionalfeature',_0x107d6b,{'fnGetAliases':this[_0x565967(0x1d5)]}),_0x227025=this[_0x565967(0x1fd)](_0x107d6b),_0x3b1c4c=await this[_0x565967(0x1d4)](_0x107d6b),_0x391fd4={'name':UtilApplications['getCleanEntityName'](DataConverter[_0x565967(0x1d9)](_0x107d6b,{'isActorItem':_0x2e457c[_0x565967(0x1d8)]})),'type':_0x95540f['type'],'data':{..._0x95540f[_0x565967(0x1dd)],'source':DataConverter['getSourceWithPagePart'](_0x107d6b),'description':{'value':_0x227025,'chat':'','unidentified':''},..._0x3b1c4c},'permission':{'default':0x0},'img':await this[_0x565967(0x1c6)](_0x107d6b),'flags':this[_0x565967(0x1d1)](_0x107d6b,_0x2e457c),'effects':MiscUtil[_0x565967(0x1d0)](_0x95540f[_0x565967(0x1cf)]||[])};if(_0x2e457c[_0x565967(0x1c8)])_0x391fd4[_0x565967(0x1f5)]={'default':Config['get'](_0x565967(0x1eb),_0x565967(0x1ee))};return _0x391fd4;}static async[_0x5205c6(0x1f8)](_0x359c31,_0x5a9c3f){const _0x4472af=_0x5205c6,_0x62ef34=this['_getDescriptionValue'](_0x359c31),_0x3b0d38=_0x359c31[_0x4472af(0x1dc)]||{},_0x4bfe94=await this[_0x4472af(0x1d4)](_0x359c31),_0x1422f3={'name':UtilApplications['getCleanEntityName'](DataConverter[_0x4472af(0x1d9)](_0x359c31,{'isActorItem':_0x5a9c3f[_0x4472af(0x1d8)]})),'data':{'source':DataConverter['getSourceWithPagePart'](_0x359c31),'description':{'value':_0x62ef34,'chat':'','unidentified':''},'activation':{'type':'','cost':0x0,'condition':''},'duration':{'value':0x0,'units':''},'target':{'value':0x0,'units':'','type':''},'range':{'value':0x0,'long':0x0,'units':null},'uses':{'value':0x0,'max':0x0,'per':''},'ability':'','actionType':'','attackBonus':0x0,'chatFlavor':'','critical':null,'damage':{'parts':[],'versatile':''},'formula':'','save':{'ability':'','dc':null},'requirements':_0x3b0d38[_0x4472af(0x1da)]||'','recharge':{'value':0x0,'charged':!![]},..._0x4bfe94},'permission':{'default':0x0},'type':'feat','img':await this[_0x4472af(0x1c6)](_0x359c31),'flags':this[_0x4472af(0x1d1)](_0x359c31,_0x5a9c3f),'effects':[]};if(_0x5a9c3f['isAddPermission'])_0x1422f3['permission']={'default':Config['get'](_0x4472af(0x1eb),_0x4472af(0x1ee))};return _0x1422f3;}static[_0x5205c6(0x1fd)](_0x2840a7){const _0x48bdb6=_0x5205c6;if(!Config[_0x48bdb6(0x1e0)](_0x48bdb6(0x1eb),'isImportDescription'))return'';const _0x3eea62=Renderer['utils'][_0x48bdb6(0x1db)](_0x2840a7[_0x48bdb6(0x1df)]);return _0x48bdb6(0x1f1)+(_0x3eea62?_0x48bdb6(0x1d6)+_0x3eea62+'</i></p>':'')+_0x48bdb6(0x1ce)+Renderer[_0x48bdb6(0x1e0)]()[_0x48bdb6(0x201)](!![])[_0x48bdb6(0x1c2)]({'entries':_0x2840a7[_0x48bdb6(0x1f9)]},0x2)+_0x48bdb6(0x1e1);}static['_getOptionalFeatureFlags'](_0x453d96,_0x204434){const _0x5e192c=_0x5205c6;_0x204434=_0x204434||{};const _0x3dc649={[SharedConsts['MODULE_NAME_FAKE']]:{'page':UrlUtil[_0x5e192c(0x1fc)],'source':_0x453d96['source'],'hash':UrlUtil[_0x5e192c(0x1e5)][UrlUtil[_0x5e192c(0x1fc)]](_0x453d96)}};return _0x204434[_0x5e192c(0x1ed)]&&(_0x3dc649[SharedConsts[_0x5e192c(0x1ea)]][_0x5e192c(0x1dd)]={'feat':MiscUtil['copy'](_0x453d96)},_0x3dc649[SharedConsts[_0x5e192c(0x1ea)]][_0x5e192c(0x200)]=_0x204434[_0x5e192c(0x200)]),_0x3dc649;}static async[_0x5205c6(0x1c5)](_0x34ded2,_0x27786c,_0x4e4a13,_0x3f4b61){const _0x265752=_0x5205c6,_0x6f8a25=await this[_0x265752(0x1f4)](_0x4e4a13);DataConverter['mutActorUpdate'](_0x34ded2,_0x27786c,_0x4e4a13,{'sideData':_0x6f8a25});}static async[_0x5205c6(0x1c6)](_0x40988b){const _0x23d438=_0x5205c6,_0x2460da=await UtilCompendium['pGetCompendiumImage']('optionalfeature',_0x40988b,{'fnGetAliases':this['_getSrdAliases']});if(_0x2460da)return _0x2460da;return _0x23d438(0x1fa)+SharedConsts[_0x23d438(0x1cd)]+_0x23d438(0x1fb);}static async[_0x5205c6(0x1f4)](_0xb34d90){const _0x3ee24c=_0x5205c6;let _0x30369c=(MiscUtil['get'](BrewUtil,'homebrew','foundryOptionalfeature')||[])[_0x3ee24c(0x1ff)](_0x98f69c=>_0x98f69c[_0x3ee24c(0x1cc)]===_0xb34d90[_0x3ee24c(0x1cc)]&&_0x98f69c[_0x3ee24c(0x1f2)]===_0xb34d90[_0x3ee24c(0x1f2)]);if(!_0x30369c){const _0x41b1a1=await Vetools['pGetOptionalFeatureSideData']();_0x30369c=_0x41b1a1[_0x3ee24c(0x1c7)][_0x3ee24c(0x1ff)](_0x5c479e=>_0x5c479e['name']===_0xb34d90[_0x3ee24c(0x1cc)]&&_0x5c479e[_0x3ee24c(0x1f2)]===_0xb34d90[_0x3ee24c(0x1f2)]);}return _0x30369c;}static async[_0x5205c6(0x1d4)](_0x584bbb){const _0x3b5e8b=_0x5205c6;return DataConverter[_0x3b5e8b(0x1e2)](_0x584bbb,{'propBrew':_0x3b5e8b(0x1f7),'fnLoadJson':Vetools[_0x3b5e8b(0x1e9)],'propJson':_0x3b5e8b(0x1c7)});}static async[_0x5205c6(0x1fe)](_0x175282,_0x2a2f2f){const _0x1bb96a=_0x5205c6;return(await DataConverter[_0x1bb96a(0x1c4)](_0x2a2f2f,{'propBrew':_0x1bb96a(0x1f7),'fnLoadJson':Vetools[_0x1bb96a(0x1e9)],'propJson':_0x1bb96a(0x1c7)}))?.[_0x1bb96a(0x1f0)]>0x0;}static async['pGetOptionalFeatureItemEffects'](_0x2924c2,_0x5a1790,_0x52b5a7,_0x55f09d){const _0x367c84=_0x5205c6,_0x2f9145=await DataConverter[_0x367c84(0x1c4)](_0x5a1790,{'propBrew':_0x367c84(0x1f7),'fnLoadJson':Vetools['pGetOptionalFeatureSideData'],'propJson':_0x367c84(0x1c7)});return UtilActiveEffects[_0x367c84(0x1d2)](_0x2924c2,_0x52b5a7,_0x2f9145||[],{'parentName':_0x5a1790[_0x367c84(0x1cc)],'additionalData':_0x55f09d});}static['_getSrdAliases'](_0xd8d4b3){const _0x498878=_0x5205c6;if(!_0xd8d4b3[_0x498878(0x1cc)]||!_0xd8d4b3[_0x498878(0x1de)])return[];const _0x23f777=[];if(_0xd8d4b3[_0x498878(0x1e6)]==='EI')_0x23f777['push'](_0x498878(0x1e7)+_0xd8d4b3[_0x498878(0x1cc)]);return _0x23f777;}}export{DataConverterOptionalfeature};