const _0x447e=['util','\x20+\x20@mod','isActorItem','level','number','doHookSpellLinkRender','self','137885Qzfpan','getActorSpell','findIndex','day','@mod','getEntryDescription','spec','join','parentSubclassSource','unit','msak','effects','LINK_DATA_SHEET_ITEM','text','isIgnoreExisting','keys','_getSpellFlags','usesCurrent','save','preparation','hover','39401whizzq','items','distance','inst','335405ocUHjm','find','modules/','year','get','instant','prompt','pGetSpellItem','prepared','meta','href','data','OwnedItem','split','2hXPkpL','name','47327msjTNn','error','getCleanEntityName','URL_TO_HASH_BUILDER','damageInflict','getActorSpellItemOpts','preparationMode','isStrictMatching','includes','round','_pGetAdditionalData','min','pGetAdditionalData_','parentClassSource','getNameWithSourcePart','entries','push','permanent','stringify','hash','_pGetSpellItem_parseAndAddDamage','isExpanded','PG_SPELLS','substring','isPrepared','replace','isAddPermission','label','target.value','length','hour','savingThrow','abilityAbv','pCacheAndGet','amount','components','special','getSourceWithPagePart','Failed\x20to\x20import\x20spell\x20with\x20hash\x20\x22','getSrdCompendiumEntity','durationAmount','parseScaleDice','spell','duration','mode','some','_pFillSpellPromises_pUpdateSpellItem','innate','map','optsGetSpellItem','isImportDescription','VALID_DAMAGE_TYPES','parts','5sdjtlP','update','touch','13FKzhAs','createEmbeddedEntity','page','cantrip','usesMax','source','scaling','always','encodeForHash','minute','has','1LAKPND','pSetSpellItemIsPrepared','getMetricNumber','900950robuPq','slice','MODULE_NAME_FAKE','VET_SPELL_SCHOOL_TO_ABV','uses','foundrySpell','exec','permissions','target','escapeQuotes','time','range','set','hashPreEncoded','miles','none','_id','splitFirstSpace','value','timed','filter','43394TfecLB','importSpell','pGetSpellSideData','_getDescription','consume','toLowerCase','_getReDiceYourSpellcastingMod','pGetIconImage','miscTags','add','entriesHigherLevel','type','scalingLevelDice','import','_pFillSpellPromises_pAddSpellItem','hashToIdMap','rsak','turn','uid','usesPer','parentClassName','cost','stripTags','36192mpYPTP','copy','create','castAtLevel'];const _0x4a59=function(_0x445cb6,_0x40c8b9){_0x445cb6=_0x445cb6-0x7d;let _0x447ef0=_0x447e[_0x445cb6];return _0x447ef0;};const _0x57cf25=_0x4a59;(function(_0x132dc4,_0x566a24){const _0x529467=_0x4a59;while(!![]){try{const _0x3068fb=parseInt(_0x529467(0xc6))+parseInt(_0x529467(0xa4))*parseInt(_0x529467(0xed))+parseInt(_0x529467(0xdf))+parseInt(_0x529467(0x81))*parseInt(_0x529467(0xbb))+-parseInt(_0x529467(0xef))*parseInt(_0x529467(0x8c))+parseInt(_0x529467(0xdb))*parseInt(_0x529467(0x7e))+-parseInt(_0x529467(0x8f));if(_0x3068fb===_0x566a24)break;else _0x132dc4['push'](_0x132dc4['shift']());}catch(_0x3fed57){_0x132dc4['push'](_0x132dc4['shift']());}}}(_0x447e,0x44306));import{Vetools}from'./Vetools.js';import{UtilActors}from'./UtilActors.js';import{Config}from'./Config.js';import{SharedConsts}from'../shared/SharedConsts.js';import{UtilApplications}from'./UtilApplications.js';import{LGT}from'./Util.js';import{UtilEvents}from'./UtilEvents.js';import{DataConverter}from'./DataConverter.js';import{UtilCompendium}from'./UtilCompendium.js';class DataConverterSpell{static async['pGetSpellItem'](_0x14773d,_0x3d978b){const _0x61c9ef=_0x4a59;_0x3d978b=_0x3d978b||{};const _0x5a4c35=this[_0x61c9ef(0xa7)](_0x14773d),_0x1b3f78=JSON['stringify'](_0x14773d[_0x61c9ef(0xfe)]),_0xc2cd5=_0x14773d[_0x61c9ef(0xc2)]===0x0?_0x61c9ef(0x88):_0x3d978b[_0x61c9ef(0xf5)]||_0x61c9ef(0xe7);let _0x5d5acd='';if(_0x14773d[_0x61c9ef(0xac)]&&_0x14773d[_0x61c9ef(0xac)][_0x61c9ef(0xf7)]('HL'))_0x5d5acd='heal';if(_0x14773d[_0x61c9ef(0x10e)]&&_0x14773d[_0x61c9ef(0x10e)]['length'])_0x5d5acd=_0x61c9ef(0xd8);if(_0x1b3f78[_0x61c9ef(0xa9)]()[_0x61c9ef(0xf7)]('melee\x20spell\x20attack'))_0x5d5acd=_0x61c9ef(0xd0);if(_0x1b3f78[_0x61c9ef(0xa9)]()['includes']('ranged\x20spell\x20attack'))_0x5d5acd=_0x61c9ef(0xb4);_0x5d5acd=_0x5d5acd||_0x61c9ef(0xbf);const _0x4b2bf9=UtilActors[_0x61c9ef(0x92)][_0x14773d['school']]||'',_0x1dbcaa=_0x14773d['components']&&_0x14773d[_0x61c9ef(0x112)]['m']?_0x14773d[_0x61c9ef(0x112)]['m']!==!![]?''+(_0x14773d[_0x61c9ef(0x112)]['m'][_0x61c9ef(0xd3)]||_0x14773d[_0x61c9ef(0x112)]['m']):'':'';let _0x25f010=0x0,_0x503cb2='';const _0x86cdbb=_0x14773d[_0x61c9ef(0x11a)][0x0];switch(_0x86cdbb[_0x61c9ef(0xaf)]){case _0x61c9ef(0xe4):_0x503cb2=_0x61c9ef(0xde);break;case _0x61c9ef(0xa2):{switch(_0x86cdbb[_0x61c9ef(0x11a)][_0x61c9ef(0xaf)]){case'turn':_0x503cb2=_0x61c9ef(0xb5),_0x25f010=_0x86cdbb['duration'][_0x61c9ef(0x111)];break;case _0x61c9ef(0xf8):_0x503cb2=_0x61c9ef(0xf8),_0x25f010=_0x86cdbb['duration'][_0x61c9ef(0x111)];break;case _0x61c9ef(0x8a):_0x503cb2=_0x61c9ef(0x8a),_0x25f010=_0x86cdbb['duration'][_0x61c9ef(0x111)];break;case _0x61c9ef(0x10d):_0x503cb2=_0x61c9ef(0x10d),_0x25f010=_0x86cdbb[_0x61c9ef(0x11a)][_0x61c9ef(0x111)];break;case'day':_0x503cb2=_0x61c9ef(0xc9),_0x25f010=_0x86cdbb[_0x61c9ef(0x11a)][_0x61c9ef(0x111)];break;case'week':_0x503cb2=_0x61c9ef(0xc9),_0x25f010=_0x86cdbb[_0x61c9ef(0x11a)]['amount']*0x7;break;case _0x61c9ef(0xe2):_0x503cb2=_0x61c9ef(0xe2),_0x25f010=_0x86cdbb[_0x61c9ef(0x11a)][_0x61c9ef(0x111)];break;}break;}case _0x61c9ef(0x100):_0x503cb2='perm';break;case _0x61c9ef(0x113):_0x503cb2=_0x61c9ef(0xcc);break;}let _0x2a51f8=0x0,_0x4477f4='',_0x4fc5d3=0x0,_0x4df19f='',_0x6f507='';switch(_0x14773d[_0x61c9ef(0x9a)]['type']){case RNG_SPECIAL:_0x4477f4='spec';break;case RNG_POINT:{const _0x58992e=_0x14773d['range'][_0x61c9ef(0xdd)];switch(_0x58992e['type']){case RNG_SELF:{_0x4df19f=_0x61c9ef(0xc5),_0x6f507=_0x61c9ef(0xc5),_0x4477f4=_0x61c9ef(0xc5);break;}case RNG_UNLIMITED:case RNG_UNLIMITED_SAME_PLANE:case RNG_SIGHT:case RNG_SPECIAL:{_0x4df19f=_0x61c9ef(0xcc),_0x4477f4='spec';break;}case RNG_TOUCH:{_0x4df19f=_0x61c9ef(0x80),_0x4477f4='touch';break;}case UNT_MILES:{_0x2a51f8=Config[_0x61c9ef(0x8e)](_0x61c9ef(0xa5),_0x58992e[_0x61c9ef(0x111)],UNT_MILES),_0x4477f4='mi';break;}case UNT_FEET:default:{_0x2a51f8=Config['getMetricNumber'](_0x61c9ef(0xa5),_0x58992e[_0x61c9ef(0x111)],UNT_FEET),_0x4477f4='ft';break;}}break;}case RNG_LINE:case RNG_CUBE:case RNG_CONE:case RNG_RADIUS:case RNG_SPHERE:case RNG_HEMISPHERE:case RNG_CYLINDER:{_0x4fc5d3=Config[_0x61c9ef(0x8e)](_0x61c9ef(0xa5),_0x14773d['range'][_0x61c9ef(0xdd)][_0x61c9ef(0x111)],_0x14773d['range'][_0x61c9ef(0xdd)]['type']);if(_0x14773d[_0x61c9ef(0x9a)]['distance']['type']===_0x61c9ef(0x9d))_0x4df19f='mi';else _0x4df19f='ft';if(_0x14773d[_0x61c9ef(0x9a)]['type']===RNG_HEMISPHERE)_0x6f507='sphere';else _0x6f507=_0x14773d[_0x61c9ef(0x9a)][_0x61c9ef(0xaf)];}}let _0x30dfad=[],_0x3d0a88=null,_0x49e183=null,_0x49d29d=![];if(_0x14773d[_0x61c9ef(0xb0)]){const _0x2a2da6=[_0x14773d[_0x61c9ef(0xb0)]]['flat'](),_0x439f10=_0x7c2886=>Math[_0x61c9ef(0xfa)](...Object[_0x61c9ef(0xd5)](_0x7c2886)['map'](_0x3ffaa3=>Number(_0x3ffaa3))),_0x10d534=new RegExp('('+UtilActors[_0x61c9ef(0x122)]['join']('|')+')','i');_0x30dfad[_0x61c9ef(0xff)](..._0x2a2da6[_0x61c9ef(0x11f)](_0x1da0e0=>{const _0x344a3a=_0x61c9ef,_0x3f3e8b=_0x439f10(_0x1da0e0['scaling']),_0x1e7a44=_0x1da0e0['scaling'][_0x3f3e8b],_0x334576=_0x10d534[_0x344a3a(0x95)](_0x1da0e0[_0x344a3a(0x10a)]||'');return[(_0x1e7a44||'')['replace'](/{{spellcasting_mod}}/g,_0x344a3a(0xca)),_0x334576?_0x334576[0x1][_0x344a3a(0xa9)]():null];}));const _0x45a6bc=_0x2a2da6[0x0],_0x33d6f5=_0x439f10(_0x45a6bc[_0x61c9ef(0x87)]);_0x3d0a88=_0x45a6bc[_0x61c9ef(0x87)][_0x33d6f5];}else{const _0x1a5e63=[];if(_0x14773d[_0x61c9ef(0xf3)]&&_0x14773d[_0x61c9ef(0xf3)][_0x61c9ef(0x10c)]){if(_0x1b3f78[_0x61c9ef(0xa9)]()['includes']('when\x20you\x20reach\x205th\x20level')){const _0x530170=[];_0x1b3f78[_0x61c9ef(0x108)](/\({@damage ([^}]+)}\)/g,(..._0x4eec9f)=>_0x530170[_0x61c9ef(0xff)](_0x4eec9f[0x1]));if(_0x530170[_0x61c9ef(0x10c)]===0x3){const _0x25db49=/(?:^|[^(]){@damage ([^}]+)}(?:[^)]|$)/[_0x61c9ef(0x95)](_0x1b3f78);if(_0x25db49)_0x3d0a88=_0x25db49[0x1];else _0x3d0a88=_0x530170[0x0];}}this[_0x61c9ef(0x103)](_0x1b3f78,_0x1a5e63);}if(_0x14773d[_0x61c9ef(0xac)]&&_0x14773d[_0x61c9ef(0xac)][_0x61c9ef(0x11c)](_0x581fbe=>_0x581fbe==='HL')){const _0x4fcd85=['','healing'];_0x1b3f78[_0x61c9ef(0x108)](this[_0x61c9ef(0xaa)](),(..._0x513b64)=>{const _0x226f43=_0x61c9ef,[,_0x4f9614,_0x145857]=_0x513b64;_0x4fcd85[0x0]=_0x4f9614;if(_0x145857)_0x4fcd85[0x0]=_0x4fcd85[0x0]+_0x226f43(0xc0);}),_0x1a5e63[_0x61c9ef(0xff)](_0x4fcd85);}if(_0x14773d['entriesHigherLevel']){const _0x9d446f=/{@(?:scaledice|scaledamage) ([^}]+)}/gi;if(_0x3d978b[_0x61c9ef(0xbe)]!=null&&_0x3d978b[_0x61c9ef(0xbe)]!==_0x14773d[_0x61c9ef(0xc2)]&&_0x1a5e63[_0x61c9ef(0x10c)]&&_0xc2cd5===_0x61c9ef(0x11e)){const _0xbf3e0a=new Set();JSON['stringify'](_0x14773d[_0x61c9ef(0xae)])[_0x61c9ef(0x108)](_0x9d446f,(..._0x86b477)=>{const _0x4710d6=_0x61c9ef,[_0x18d6c4]=_0x86b477[0x1][_0x4710d6(0xec)]('|')[_0x4710d6(0x11f)](_0x331f1b=>_0x331f1b['trim']()),[_0x3526d8,_0x1f0c64]=Renderer[_0x4710d6(0xa0)](_0x86b477[0x0][_0x4710d6(0x90)](0x1,-0x1)),_0x55eb72=Renderer[_0x4710d6(0x118)](_0x3526d8,_0x1f0c64),_0x3c2cc4=_0x1a5e63[_0x4710d6(0xc8)](_0xa961d4=>(_0xa961d4[0x0]||'')['trim']()[_0x4710d6(0xa9)]()===_0x18d6c4[_0x4710d6(0xa9)]());if(!_0xbf3e0a[_0x4710d6(0x8b)](_0x3c2cc4)&&~_0x3c2cc4){const _0x30124b=_0x55eb72?.[_0x4710d6(0xe5)]?.['options']?.[_0x3d978b[_0x4710d6(0xbe)]];_0x30124b&&(_0xbf3e0a[_0x4710d6(0xad)](_0x3c2cc4),_0x1a5e63[_0x3c2cc4][0x0]+='+\x20'+_0x30124b,_0x49d29d=!![]);}});}else JSON['stringify'](_0x14773d['entriesHigherLevel'])[_0x61c9ef(0x108)](_0x9d446f,(..._0x5cd363)=>{const _0x3291f1=_0x61c9ef;if(_0x49e183)return;const [,,_0x251ac1]=_0x5cd363[0x1][_0x3291f1(0xec)]('|');_0x49e183=_0x251ac1;});}if(!_0x1a5e63['length'])this[_0x61c9ef(0x103)](_0x1b3f78,_0x1a5e63);_0x30dfad['push'](..._0x1a5e63);}_0x30dfad=_0x30dfad[_0x61c9ef(0xa3)](Boolean);let _0x47a87f='';!_0x30dfad[_0x61c9ef(0x10c)]&&_0x1b3f78[_0x61c9ef(0x108)](this['_getReDiceYourSpellcastingMod'](),(..._0x49c956)=>{const _0x382530=_0x61c9ef,[,_0x3ccba4,_0x2e0124]=_0x49c956;_0x47a87f=_0x3ccba4;if(_0x2e0124)_0x47a87f=_0x47a87f+_0x382530(0xc0);});let _0x16080a='';if(_0x14773d[_0x61c9ef(0x10e)]&&_0x14773d[_0x61c9ef(0x10e)][_0x61c9ef(0x10c)])_0x16080a=_0x14773d[_0x61c9ef(0x10e)][0x0][_0x61c9ef(0x106)](0x0,0x3)[_0x61c9ef(0xa9)]();const _0x3a3acc=await DataConverter[_0x61c9ef(0xab)](_0x61c9ef(0x119),_0x14773d)||await UtilCompendium['pGetCompendiumImage'](_0x61c9ef(0x119),_0x14773d)||_0x61c9ef(0xe1)+SharedConsts['MODULE_NAME']+'/media/icon/scroll-unfurled.svg',_0x2df7b7=await UtilCompendium[_0x61c9ef(0x116)](_0x61c9ef(0x119),_0x14773d);if(_0x2df7b7){_0x4fc5d3=MiscUtil['get'](_0x2df7b7,_0x61c9ef(0xea),_0x61c9ef(0x97),_0x61c9ef(0xa1))||_0x4fc5d3,_0x4df19f=MiscUtil[_0x61c9ef(0xe3)](_0x2df7b7,_0x61c9ef(0xea),_0x61c9ef(0x97),'units')||_0x4df19f,_0x6f507=MiscUtil[_0x61c9ef(0xe3)](_0x2df7b7,_0x61c9ef(0xea),_0x61c9ef(0x97),_0x61c9ef(0xaf))||_0x6f507;if(!_0x49d29d)_0x30dfad=MiscUtil['get'](_0x2df7b7,_0x61c9ef(0xea),'damage',_0x61c9ef(0x7d))||_0x30dfad;}const _0x28508e=await this[_0x61c9ef(0xf9)](_0x14773d,_0x4df19f);if(_0x3d978b[_0x61c9ef(0x117)]!==undefined)_0x25f010=_0x3d978b[_0x61c9ef(0x117)];if(_0x3d978b['durationUnit']!==undefined)_0x503cb2=_0x3d978b['durationUnit'];const _0x27246e={'name':UtilApplications[_0x61c9ef(0xf1)](DataConverter[_0x61c9ef(0xfd)](_0x14773d,{'isActorItem':_0x3d978b[_0x61c9ef(0xc1)]})),'type':'spell','data':{'source':DataConverter[_0x61c9ef(0x114)](_0x14773d),'description':{'value':_0x5a4c35,'chat':'','unidentified':''},'actionType':_0x5d5acd,'level':_0x14773d['level'],'school':_0x4b2bf9,'components':{'value':'','vocal':_0x14773d['components']&&_0x14773d[_0x61c9ef(0x112)]['v'],'somatic':_0x14773d[_0x61c9ef(0x112)]&&_0x14773d['components']['s'],'material':!!(_0x14773d['components']&&_0x14773d[_0x61c9ef(0x112)]['m']),'ritual':_0x14773d[_0x61c9ef(0xe8)]&&_0x14773d['meta']['ritual'],'concentration':!!MiscUtil['get'](_0x14773d,_0x61c9ef(0x11a),'0','concentration')},'materials':{'value':_0x1dbcaa,'consumed':!!MiscUtil[_0x61c9ef(0xe3)](_0x14773d,_0x61c9ef(0x112),'m',_0x61c9ef(0xa8)),'cost':Math[_0x61c9ef(0xf8)]((MiscUtil[_0x61c9ef(0xe3)](_0x14773d,'components','m',_0x61c9ef(0xb9))||0x0)/0x64),'supply':0x0},'target':{'value':_0x4fc5d3,'units':_0x4df19f,'type':_0x6f507},'range':{'value':_0x2a51f8,'units':_0x4477f4,'long':null},'activation':{'type':_0x14773d[_0x61c9ef(0x99)][0x0][_0x61c9ef(0xcf)],'cost':_0x14773d[_0x61c9ef(0x99)][0x0][_0x61c9ef(0xc3)],'condition':Renderer[_0x61c9ef(0xba)](_0x14773d[_0x61c9ef(0x99)][0x0]['condition']||'')},'duration':{'value':_0x25f010,'units':_0x503cb2},'damage':{'parts':_0x30dfad,'versatile':''},'scaling':{'mode':_0x3d0a88?_0x61c9ef(0x84):_0x49e183?_0x61c9ef(0xc2):_0x61c9ef(0x9e),'formula':_0x3d0a88||_0x49e183||''},'save':{'ability':_0x16080a,'dc':null},'ability':_0x3d978b[_0x61c9ef(0x10f)]||'','uses':{'value':_0x3d978b[_0x61c9ef(0xd7)]||0x0,'max':_0x3d978b[_0x61c9ef(0x85)]||0x0,'per':_0x3d978b[_0x61c9ef(0xb7)]||''},'attackBonus':0x0,'chatFlavor':'','critical':null,'formula':_0x47a87f,'preparation':{'mode':_0xc2cd5,'prepared':_0x14773d[_0x61c9ef(0xc2)]===0x0?!![]:!!_0x3d978b['isPrepared']},'consume':{'type':'','target':null,'amount':null},..._0x28508e||{}},'img':_0x3a3acc,'flags':this[_0x61c9ef(0xd6)](_0x14773d,_0x3d978b),'effects':MiscUtil[_0x61c9ef(0xbc)](_0x2df7b7?.[_0x61c9ef(0xd1)]||[])};if(_0x3d978b[_0x61c9ef(0x109)])_0x27246e['permission']={'default':Config[_0x61c9ef(0xe3)]('importSpell',_0x61c9ef(0x96))};return _0x27246e;}static[_0x57cf25(0xd6)](_0x489671,{parentClassName:_0x386deb,parentClassSource:_0x38fe66,parentSubclassName:_0xce395b,parentSubclassSource:_0x56575f}={}){const _0x292aa7=_0x57cf25,_0x4ef274={[SharedConsts[_0x292aa7(0x91)]]:{'page':UrlUtil[_0x292aa7(0x105)],'source':_0x489671[_0x292aa7(0x86)],'hash':UrlUtil[_0x292aa7(0xf2)][UrlUtil[_0x292aa7(0x105)]](_0x489671)}};if(!_0x386deb&&!_0x38fe66&&!_0xce395b&&!_0x56575f)return _0x4ef274;return _0x4ef274[SharedConsts[_0x292aa7(0x91)]][_0x292aa7(0xb8)]=_0x386deb,_0x4ef274[SharedConsts[_0x292aa7(0x91)]][_0x292aa7(0xfc)]=_0x38fe66,_0x4ef274[SharedConsts['MODULE_NAME_FAKE']]['parentSubclassName']=_0xce395b,_0x4ef274[SharedConsts[_0x292aa7(0x91)]][_0x292aa7(0xce)]=_0x56575f,_0x4ef274;}static[_0x57cf25(0x103)](_0x4d97fe,_0x3a0f5e){const _0xa7a066=_0x57cf25;_0x4d97fe[_0xa7a066(0x108)](/{@damage ([^}]+)} ([^ ]+)(, [^ ]+)*(,? or [^ ]+)? damage/ig,(..._0x126e40)=>{_0x3a0f5e['push']([_0x126e40[0x1],_0x126e40[0x2]]);});}static['_getReDiceYourSpellcastingMod'](){return/{@dice ([^}]+)}(\s*\+\s*your\s+spellcasting\s+ability\s+modifier)?/i;}static[_0x57cf25(0xa7)](_0x5657f2){const _0x20d6d7=_0x57cf25;if(!Config[_0x20d6d7(0xe3)](_0x20d6d7(0xa5),_0x20d6d7(0x121)))return'';const _0x41c80e=DataConverter[_0x20d6d7(0xcb)](_0x5657f2),_0x365709=_0x5657f2[_0x20d6d7(0xae)]?DataConverter[_0x20d6d7(0xcb)](_0x5657f2,{'prop':'entriesHigherLevel'}):'';return[_0x41c80e,_0x365709]['filter'](Boolean)[_0x20d6d7(0xcd)]('');}static async['_pGetAdditionalData'](_0x31ebac,_0x191385){const _0xc407cc=_0x57cf25,_0x5c5794=DataConverter[_0xc407cc(0xfb)](_0x31ebac,{'propBrew':_0xc407cc(0x94),'fnLoadJson':Vetools[_0xc407cc(0xa6)],'propJson':_0xc407cc(0x119)});if(_0x5c5794[_0xc407cc(0x10b)])_0x5c5794[_0xc407cc(0x10b)]=Config['getMetricNumber'](_0xc407cc(0xa5),_0x5c5794[_0xc407cc(0x10b)],_0x191385);return _0x5c5794;}static async['pGetSpellHashToItemPosMapAndFillSpellsFromTagIds'](_0x2dcd40,_0x347539,_0x48ee87){const _0x10f0c7=_0x57cf25;_0x48ee87=_0x48ee87||{};const _0x3fc8ad=_0x48ee87[_0x10f0c7(0xb3)]||{};for(const _0x4b9938 of _0x347539){const _0x44ff29=_0x4b9938[_0x10f0c7(0xb6)]||_0x4b9938,_0x52b5d9=_0x4b9938[_0x10f0c7(0xb6)]?_0x4b9938:null;if(_0x52b5d9?.[_0x10f0c7(0x104)])continue;let [_0x99b299,_0x502ca3]=_0x44ff29['split']('|');if(!_0x502ca3)_0x502ca3=SRC_PHB;const _0x7bbde3=UrlUtil['URL_TO_HASH_BUILDER'][UrlUtil['PG_SPELLS']]({'name':_0x99b299,'source':_0x502ca3});if(_0x3fc8ad[_0x7bbde3]!=null&&!_0x52b5d9){await this[_0x10f0c7(0x11d)](_0x2dcd40,_0x3fc8ad[_0x7bbde3],_0x502ca3,_0x7bbde3,_0x48ee87);continue;}_0x52b5d9&&(_0x48ee87={..._0x48ee87},_0x48ee87[_0x10f0c7(0x120)]=MiscUtil[_0x10f0c7(0xbc)](_0x48ee87[_0x10f0c7(0x120)]||{}),_0x48ee87[_0x10f0c7(0x120)][_0x10f0c7(0xd7)]=_0x52b5d9[_0x10f0c7(0x93)],_0x48ee87[_0x10f0c7(0x120)][_0x10f0c7(0x85)]=_0x52b5d9[_0x10f0c7(0x93)],_0x48ee87[_0x10f0c7(0x120)][_0x10f0c7(0xb7)]=_0x52b5d9[_0x10f0c7(0xb7)],_0x48ee87[_0x10f0c7(0x120)]['isPrepared']=_0x52b5d9[_0x10f0c7(0x107)]!=null?_0x52b5d9[_0x10f0c7(0x107)]:_0x48ee87[_0x10f0c7(0x120)]['isPrepared'],_0x48ee87['optsGetSpellItem'][_0x10f0c7(0xf5)]=_0x52b5d9[_0x10f0c7(0xf5)]!=null?_0x52b5d9[_0x10f0c7(0xf5)]:_0x48ee87[_0x10f0c7(0x120)][_0x10f0c7(0xf5)],_0x48ee87[_0x10f0c7(0x120)][_0x10f0c7(0xbe)]=_0x52b5d9['castAtLevel'],_0x48ee87[_0x10f0c7(0xd4)]=!![]);const _0x40b0aa=await DataConverterSpell[_0x10f0c7(0xb2)](_0x2dcd40,_0x502ca3,_0x7bbde3,_0x48ee87);if(_0x40b0aa==null||_0x52b5d9)continue;_0x3fc8ad[_0x7bbde3]=_0x40b0aa;}return _0x3fc8ad;}static async[_0x57cf25(0x11d)](_0x2bbeca,_0x5f1be3,_0x5a2c4a,_0x1b8680,_0xbb92e1){const _0xc566c3=_0x57cf25,_0x3c60e0=_0x2bbeca[_0xc566c3(0xdc)]['find'](_0x29a409=>_0x29a409[_0xc566c3(0x9f)]===_0x5f1be3||_0x29a409['id']===_0x5f1be3);if(!_0x3c60e0)return;const _0x1fcf7c=_0x3c60e0['data'];_0xbb92e1=_0xbb92e1||{};let _0xff148c;try{_0xff148c=await Renderer['hover'][_0xc566c3(0x110)](UrlUtil[_0xc566c3(0x105)],_0x5a2c4a,_0x1b8680);}catch(_0x275f2b){console[_0xc566c3(0xf0)](...LGT,_0xc566c3(0x115)+_0x1b8680+'\x22!',_0x275f2b);return;}if(!_0xff148c)return;const _0x286a8e=await DataConverterSpell[_0xc566c3(0xe6)](_0xff148c,{...UtilActors[_0xc566c3(0xf4)](_0x2bbeca),..._0xbb92e1[_0xc566c3(0x120)]||{}}),_0x49cf4b={'_id':_0x3c60e0[_0xc566c3(0x9f)],'data':{}};let _0x1d0e2d=![];MiscUtil[_0xc566c3(0xe3)](_0x1fcf7c[_0xc566c3(0xea)],_0xc566c3(0xd9),_0xc566c3(0x11b))==='prepared'&&MiscUtil['get'](_0x286a8e[_0xc566c3(0xea)],'preparation','mode')==='always'&&(_0x1d0e2d=!![],MiscUtil[_0xc566c3(0x9b)](_0x49cf4b['data'],'preparation','mode','always')),MiscUtil['get'](_0x1fcf7c[_0xc566c3(0xea)],_0xc566c3(0xd9),_0xc566c3(0xe7))!==!![]&&MiscUtil['get'](_0x286a8e[_0xc566c3(0xea)],_0xc566c3(0xd9),_0xc566c3(0xe7))===!![]&&(_0x1d0e2d=!![],MiscUtil[_0xc566c3(0x9b)](_0x49cf4b[_0xc566c3(0xea)],_0xc566c3(0xd9),'prepared',!![])),_0x1d0e2d&&await _0x2bbeca['updateEmbeddedEntity'](_0xc566c3(0xeb),_0x49cf4b);}static async['pGetSpellHashToItemPosMapAndFillSpells'](_0x151a36,_0x12913a,_0x3cc0e5){const _0x38e468=_0x57cf25;_0x3cc0e5=_0x3cc0e5||{};const _0x571cb3=[],_0x1a951a=/{@spell ([^}]+)}/gi;let _0x27ab5c;while(_0x27ab5c=_0x1a951a[_0x38e468(0x95)](_0x12913a)){_0x571cb3[_0x38e468(0xff)](_0x27ab5c[0x1]);}return this['pGetSpellHashToItemPosMapAndFillSpellsFromTagIds'](_0x151a36,_0x571cb3,_0x3cc0e5);}static async[_0x57cf25(0xb2)](_0x435bbe,_0x5494ef,_0x44437e,_0x58170c){const _0x5212db=_0x57cf25;_0x58170c=_0x58170c||{};let _0x28b1c3;try{_0x28b1c3=await Renderer[_0x5212db(0xda)][_0x5212db(0x110)](UrlUtil['PG_SPELLS'],_0x5494ef,_0x44437e);}catch(_0x520f04){return console['error'](...LGT,'Failed\x20to\x20import\x20spell\x20with\x20hash\x20\x22'+_0x44437e+'\x22!',_0x520f04),null;}if(!_0x28b1c3)return null;if(!_0x58170c['isIgnoreExisting']){const _0x28c536=DataConverterSpell[_0x5212db(0xc7)](_0x435bbe,_0x28b1c3[_0x5212db(0xee)],_0x28b1c3['source']);if(_0x28c536)return _0x28c536[_0x5212db(0x9f)]||_0x28c536['data'][_0x5212db(0x9f)];}const _0x52d29b=await DataConverterSpell[_0x5212db(0xe6)](_0x28b1c3,{...UtilActors[_0x5212db(0xf4)](_0x435bbe),..._0x58170c[_0x5212db(0x120)]||{}});if(_0x58170c['isTemporary']){const _0x5aad59=await Item[_0x5212db(0xbd)](_0x52d29b,{'temporary':!![]});(_0x435bbe[_0x5212db(0xea)][_0x5212db(0xdc)]=_0x435bbe[_0x5212db(0xea)][_0x5212db(0xdc)]||[])[_0x5212db(0xff)](_0x5aad59);}else{const _0x4519d6=await _0x435bbe[_0x5212db(0x82)](_0x5212db(0xeb),_0x52d29b,{});return _0x4519d6[_0x5212db(0x9f)]||_0x4519d6[_0x5212db(0xea)]['_id'];}}static[_0x57cf25(0xc7)](_0x203323,_0x14dfbc,_0xa5468e){const _0x483d92=_0x57cf25;if(!_0x14dfbc||!_0xa5468e)return null;return _0x203323[_0x483d92(0xdc)]&&_0x203323[_0x483d92(0xdc)][_0x483d92(0xe0)](_0x3d0564=>(_0x3d0564[_0x483d92(0xee)]||'')[_0x483d92(0xa9)]()===_0x14dfbc[_0x483d92(0xa9)]()&&(!Config[_0x483d92(0xe3)](_0x483d92(0xb1),_0x483d92(0xf6))||(DataConverter['getItemSource'](_0x3d0564)||'')['toLowerCase']()===_0xa5468e[_0x483d92(0xa9)]()));}static[_0x57cf25(0xc4)](_0x57efc9,_0x232097,_0x2a95b9){const _0x2b017b=_0x57cf25;if(_0x2a95b9[_0x2b017b(0xe9)]&&_0x2a95b9[_0x2b017b(0xe9)][_0x2b017b(0xda)]){if(_0x2a95b9[_0x2b017b(0xe9)][_0x2b017b(0xda)][_0x2b017b(0x83)]===UrlUtil[_0x2b017b(0x105)]){const _0x3ab55e=_0x2a95b9[_0x2b017b(0xe9)][_0x2b017b(0x9c)]?_0x2a95b9[_0x2b017b(0xe9)][_0x2b017b(0x102)]:UrlUtil[_0x2b017b(0x89)](_0x2a95b9[_0x2b017b(0xe9)][_0x2b017b(0x102)]),_0x2c4685=_0x232097[_0x3ab55e];if(_0x2c4685!=null){const _0x284249=JSON[_0x2b017b(0x101)]({'actorId':_0x57efc9,'itemId':_0x2c4685})[_0x2b017b(0x98)]();return{'isDisableEvents':!![],'attributes':UtilEvents[_0x2b017b(0xd2)]+'=\x22'+_0x284249+'\x22'};}}}return null;}static async[_0x57cf25(0x8d)](_0x257195,_0x30c7fc){const _0x11bc2=_0x57cf25;if(!_0x257195)return;await _0x257195[_0x11bc2(0x7f)]({'data':{'preparation':{'prepared':_0x30c7fc}}});}}export{DataConverterSpell};