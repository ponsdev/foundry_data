const _0x2fc4=['forEach','collection','Enter\x20iframe\x20or\x20URL','apps','notifications','values','data','<i\x20class=\x22fas\x20fa-hammer\x22></i>','name','URL/iframe\x20\x22','confirm','1020399ZjPium','attr','close','PlutPatcher','nav','_doPatchJournalContextMenuOptions','handleHookApplyActiveEffect','element','FLAG_IFRAME_URL','set','innerHeight','handleConfigUpdate','3dfIXBG','trim','Failed\x20to\x20apply\x20custom\x20active\x20effect\x20parsing\x20to\x20actor\x20\x22','_id','min','active','actor','journal','warn','info','findIndex','entityId','SCENES.Configure','entities','_handleConfigUpdate','_getEntryContextOptions','get','error','SIDEBAR.DeleteConfirm','499hMqucm','SIDEBAR.Delete','targetActorId','573571mNHqEN','1BIvpZF','setFlag','13811njaYpE','943awcYci','bind','_doInitActorData','pGetUserString','_doPatchNavContextMenuOptions','owner','isUseExtendedActiveEffectsParser','446744cUVfOU','src','canvasReady','Set\x20as\x20Rivet\x20Target','push','actors','i18n','Rivet\x20content\x20will\x20now\x20be\x20imported\x20to\x20Actor\x20\x22','STR_SEE_CONSOLE','splice','790529CMhonQ','localize','scenes','getSceneNavigationContext','init','\x22\x20was\x20not\x20valid!','innerWidth','forceClose','render','isEnableUrlEmbeds','\x22.\x20This\x20can\x20be\x20changed\x20in\x20the\x20Config.','prepareData','449232QniIpH','<i\x20class=\x22fas\x20fa-link\x22></i>','plutonium.configUpdate','<iframe','MODULE_NAME','startsWith'];const _0x4f42=function(_0x3a59d4,_0x3c4624){_0x3a59d4=_0x3a59d4-0x84;let _0x2fc409=_0x2fc4[_0x3a59d4];return _0x2fc409;};const _0x4982ef=_0x4f42;(function(_0x29839d,_0x319c25){const _0xe0e22f=_0x4f42;while(!![]){try{const _0x11f8db=parseInt(_0xe0e22f(0xcd))+-parseInt(_0xe0e22f(0xb0))+-parseInt(_0xe0e22f(0xa6))+-parseInt(_0xe0e22f(0x9e))*parseInt(_0xe0e22f(0x9c))+-parseInt(_0xe0e22f(0x9f))*parseInt(_0xe0e22f(0x98))+-parseInt(_0xe0e22f(0xbc))+parseInt(_0xe0e22f(0x9b))*parseInt(_0xe0e22f(0x85));if(_0x11f8db===_0x319c25)break;else _0x29839d['push'](_0x29839d['shift']());}catch(_0x24c4ee){_0x29839d['push'](_0x29839d['shift']());}}}(_0x2fc4,0x8b37f));import{SharedConsts}from'../shared/SharedConsts.js';import{Consts}from'./Consts.js';import{Config}from'./Config.js';import{Patcher_Token}from'./PatcherToken.js';import{Patcher_TextEditor}from'./PatcherTextEditor.js';import{Patcher_ChatMessage}from'./PatcherChatMessage.js';import{Patcher_SettingsConfig}from'./PatcherSettingsConfig.js';import{Patcher_CanvasAnimation}from'./PatcherCanvasAnimation.js';import{Patcher_Jquery}from'./PatcherJquery.js';import{Patcher_GameKeyboard}from'./PatcherGameKeyboard.js';import{Patcher_ActiveEffectConfig}from'./PatcherActiveEffectConfig.js';import{Patcher_Actor}from'./PatcherActor.js';import{Patcher_Drawing}from'./PatcherDrawing.js';import{JournalSheet_Plutonium}from'./PatcherJournalSheet.js';import{LGT}from'./Util.js';import{Patcher_Item}from'./PatcherItem.js';class Patcher{static[_0x4982ef(0xb4)](){const _0x3709bc=_0x4982ef;Hooks['on']('applyActiveEffect',Patcher_Actor[_0x3709bc(0xd3)]['bind'](Patcher_Actor)),this[_0x3709bc(0xa3)](),this['_doPatchActorContextMenuOptions'](),this[_0x3709bc(0xd2)](),Patcher_Token['init'](),Patcher_TextEditor['init'](),Patcher_ChatMessage[_0x3709bc(0xb4)](),Patcher_SettingsConfig[_0x3709bc(0xb4)](),Patcher_CanvasAnimation['init'](),Patcher_Jquery[_0x3709bc(0xb4)](),Patcher_GameKeyboard[_0x3709bc(0xb4)](),Patcher_ActiveEffectConfig[_0x3709bc(0xb4)](),Patcher_Actor['init'](),Patcher_Item[_0x3709bc(0xb4)](),Hooks['on'](_0x3709bc(0xbe),()=>this['_handleConfigUpdate']()),this[_0x3709bc(0x93)](),this['_doInitActorData'](),Hooks['on'](_0x3709bc(0xa8),()=>{Patcher_Drawing['handleConfigUpdate']();});}static['_handleConfigUpdate'](){const _0xd5ccb5=_0x4982ef;if(ui['nav']?.[_0xd5ccb5(0xd4)])ui[_0xd5ccb5(0xd1)][_0xd5ccb5(0xb8)]();Patcher_Token[_0xd5ccb5(0x84)](),Patcher_Drawing[_0xd5ccb5(0x84)](),Patcher_ChatMessage[_0xd5ccb5(0x84)](),JournalSheet_Plutonium[_0xd5ccb5(0x84)]();}static[_0x4982ef(0xa1)](){const _0x29859e=_0x4982ef;Config[_0x29859e(0x95)](_0x29859e(0x8b),_0x29859e(0xa5))&&(Actor[_0x29859e(0xc3)][_0x29859e(0x92)]||[])['forEach'](_0x18a7b4=>{const _0xe8736b=_0x29859e;try{_0x18a7b4[_0xe8736b(0xbb)]();}catch(_0xdf9085){const _0x3fb343=_0xe8736b(0x87)+(_0x18a7b4[_0xe8736b(0x88)]||_0x18a7b4['id'])+'\x22!';ui['notifications'][_0xe8736b(0x96)](_0x3fb343+'\x20'+VeCt[_0xe8736b(0xae)]),console['error'](...LGT,_0x3fb343),console[_0xe8736b(0x96)](_0xdf9085);}});}static[_0x4982ef(0xa3)](){const _0x8e43d9=_0x4982ef;Hooks['on'](_0x8e43d9(0xb3),(_0x337e1c,_0x51d690)=>{const _0x4b0f31=_0x8e43d9;if(!Config[_0x4b0f31(0x95)]('ui','isAddDeleteToSceneNavOptions'))return;const _0x12784a=_0x51d690['findIndex'](_0x2db325=>_0x2db325['name']===_0x4b0f31(0x91)),_0x3b9725={'name':_0x4b0f31(0x99),'icon':'<i\x20class=\x22fas\x20fa-trash\x22></i>','condition':_0x37dbbe=>{const _0x27bf5a=_0x4b0f31,_0x57acd4=game[_0x27bf5a(0xb2)][_0x27bf5a(0x95)](_0x37dbbe[_0x27bf5a(0xc8)]('sceneId'));return game['user']['isGM']&&!_0x57acd4['data'][_0x27bf5a(0x8a)];},'callback':_0x4401e2=>{const _0x34309d=_0x4b0f31,_0x6f6869=Scene[_0x34309d(0xc3)][_0x34309d(0x95)](_0x4401e2[_0x34309d(0xc8)]('sceneId')),{top:_0x51c889,left:_0x8e776c}=_0x4401e2[0x0]['getBoundingClientRect']();Dialog[_0x34309d(0xcc)]({'title':game[_0x34309d(0xac)][_0x34309d(0xb1)](_0x34309d(0x99))+'\x20'+_0x6f6869[_0x34309d(0xca)],'content':game['i18n'][_0x34309d(0xb1)](_0x34309d(0x97)),'yes':_0x6f6869['delete']['bind'](_0x6f6869),'options':{'top':Math['min'](_0x51c889+0x46,window[_0x34309d(0xd7)]-0x15e),'left':Math[_0x34309d(0x89)](_0x8e776c,window[_0x34309d(0xb6)]-0x2d0)}});}};if(~_0x12784a)_0x51d690[_0x4b0f31(0xaf)](_0x12784a,0x0,_0x3b9725);else _0x51d690[_0x4b0f31(0xaa)](_0x3b9725);return _0x51d690;});}static['_doPatchActorContextMenuOptions'](){const _0x3a682c=_0x4982ef,_0x4cb481=ui['actors'][_0x3a682c(0x94)][_0x3a682c(0xa0)](ui[_0x3a682c(0xab)]);ui[_0x3a682c(0xab)][_0x3a682c(0x94)]=()=>{const _0x20e0f0=_0x3a682c,_0x3b7ab0=_0x4cb481();return _0x3b7ab0[_0x20e0f0(0xaa)]({'name':_0x20e0f0(0xa9),'icon':_0x20e0f0(0xc9),'condition':_0x55c9da=>{const _0xf7d925=_0x20e0f0,_0x5b0e91=ActorDirectory[_0xf7d925(0xc3)][_0xf7d925(0x95)](_0x55c9da['data'](_0xf7d925(0x90)));return _0x5b0e91['owner'];},'callback':_0x2497d1=>{const _0x1d64fa=_0x20e0f0,_0x358650=ActorDirectory[_0x1d64fa(0xc3)]['get'](_0x2497d1['data'](_0x1d64fa(0x90)));Config[_0x1d64fa(0xd6)]('rivet',_0x1d64fa(0x9a),_0x358650['id']),ui[_0x1d64fa(0xc6)][_0x1d64fa(0x8e)](_0x1d64fa(0xad)+_0x358650['id']+_0x1d64fa(0xba));}}),_0x3b7ab0;};}static['_doPatchJournalContextMenuOptions'](){const _0x2875ef=_0x4982ef,_0x360ec6=ui[_0x2875ef(0x8c)][_0x2875ef(0x94)][_0x2875ef(0xa0)](ui['journal']);ui[_0x2875ef(0x8c)]['_getEntryContextOptions']=()=>{const _0x4a8de0=_0x2875ef,_0x3e36b9=_0x360ec6(),_0xf3af6f=_0x3e36b9[_0x4a8de0(0x8f)](_0x5cc6ac=>_0x5cc6ac[_0x4a8de0(0xca)]==='PERMISSION.Configure');if(!~_0xf3af6f)return _0x3e36b9;return _0x3e36b9[_0x4a8de0(0xaf)](_0xf3af6f+0x1,0x0,{'name':'Set\x20Embed\x20URL','icon':_0x4a8de0(0xbd),'condition':_0x5f1948=>{const _0x2550e9=_0x4a8de0;if(!Config['get']('journalEntries',_0x2550e9(0xb9)))return![];const _0x3a0c56=JournalDirectory[_0x2550e9(0xc3)]['get'](_0x5f1948['data'](_0x2550e9(0x90)));return _0x3a0c56[_0x2550e9(0xa4)];},'callback':async _0x4bbcfb=>{const _0x4a247b=_0x4a8de0,_0x20d962=JournalDirectory[_0x4a247b(0xc3)][_0x4a247b(0x95)](_0x4bbcfb[_0x4a247b(0xc8)]('entityId')),_0x349325=await _0x20d962['getFlag'](SharedConsts[_0x4a247b(0xc0)],Consts['FLAG_IFRAME_URL']);let _0x217ec5=await InputUiUtil[_0x4a247b(0xa2)]({'title':_0x4a247b(0xc4),'default':_0x349325||''});if(_0x217ec5==null)return;Object[_0x4a247b(0xc7)](_0x20d962[_0x4a247b(0xc5)])[_0x4a247b(0xc2)](_0xc187ec=>{const _0x508aaa=_0x4a247b;_0xc187ec[_0x508aaa(0xb7)]?_0xc187ec['forceClose']():_0xc187ec[_0x508aaa(0xcf)]();});if(!_0x217ec5)await _0x20d962['setFlag'](SharedConsts['MODULE_NAME'],Consts[_0x4a247b(0xd5)],'');else{_0x217ec5=_0x217ec5[_0x4a247b(0x86)]();if(_0x217ec5[_0x4a247b(0xc1)](_0x4a247b(0xbf)))_0x217ec5=$(_0x217ec5)[_0x4a247b(0xce)](_0x4a247b(0xa7));!_0x217ec5&&(ui[_0x4a247b(0xc6)][_0x4a247b(0x8d)](_0x4a247b(0xcb)+_0x217ec5+_0x4a247b(0xb5)),await _0x20d962[_0x4a247b(0x9d)](SharedConsts[_0x4a247b(0xc0)],Consts['FLAG_IFRAME_URL'],'')),await _0x20d962[_0x4a247b(0x9d)](SharedConsts['MODULE_NAME'],Consts[_0x4a247b(0xd5)],_0x217ec5);}}}),_0x3e36b9;};}}window[_0x4982ef(0xd0)]=Patcher,Patcher['Patcher_TextEditor']=Patcher_TextEditor;export{Patcher};