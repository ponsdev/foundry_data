const _0x3473=['Failed\x20to\x20apply\x20custom\x20active\x20effect\x20parsing\x20to\x20actor\x20\x22','info','min','scenes','findIndex','handleConfigUpdate','warn','9995YdBvmy','Enter\x20iframe\x20or\x20URL','16eBxMIA','229620fpaBaQ','entities','data','applyActiveEffect','journal','plutonium.configUpdate','render','\x22.\x20This\x20can\x20be\x20changed\x20in\x20the\x20Config.','actors','<i\x20class=\x22fas\x20fa-trash\x22></i>','localize','11579CpVxFd','collection','attr','_doPatchJournalContextMenuOptions','Set\x20Embed\x20URL','URL/iframe\x20\x22','forceClose','prepareData','innerWidth','FLAG_IFRAME_URL','error','notifications','_getEntryContextOptions','sceneId','forEach','entityId','MODULE_NAME','init','owner','SCENES.Configure','36007sDlABd','Patcher_TextEditor','values','_doInitActorData','i18n','close','push','set','splice','name','29657oTmSIQ','SIDEBAR.Delete','element','user','getSceneNavigationContext','\x22\x20was\x20not\x20valid!','_doPatchNavContextMenuOptions','bind','isGM','Set\x20as\x20Rivet\x20Target','actor','rivet','getFlag','90657vVrNXo','<i\x20class=\x22fas\x20fa-link\x22></i>','get','88880SItztU','Rivet\x20content\x20will\x20now\x20be\x20imported\x20to\x20Actor\x20\x22','_handleConfigUpdate','SIDEBAR.DeleteConfirm','handleHookApplyActiveEffect','nav','_doPatchActorContextMenuOptions','<i\x20class=\x22fas\x20fa-hammer\x22></i>','PlutPatcher','apps'];const _0xbae6=function(_0x3e6186,_0x49ce5c){_0x3e6186=_0x3e6186-0x96;let _0x347339=_0x3473[_0x3e6186];return _0x347339;};const _0x37dfdb=_0xbae6;(function(_0x8c6dab,_0x44de35){const _0x157ace=_0xbae6;while(!![]){try{const _0x3ee411=-parseInt(_0x157ace(0xcc))*-parseInt(_0x157ace(0xc0))+parseInt(_0x157ace(0xaa))+parseInt(_0x157ace(0xad))+parseInt(_0x157ace(0xbe))+parseInt(_0x157ace(0x9d))+-parseInt(_0x157ace(0xe0))+-parseInt(_0x157ace(0xc1));if(_0x3ee411===_0x44de35)break;else _0x8c6dab['push'](_0x8c6dab['shift']());}catch(_0x288f2e){_0x8c6dab['push'](_0x8c6dab['shift']());}}}(_0x3473,0x21e4a));import{SharedConsts}from'../shared/SharedConsts.js';import{Consts}from'./Consts.js';import{Config}from'./Config.js';import{Patcher_Token}from'./PatcherToken.js';import{Patcher_TextEditor}from'./PatcherTextEditor.js';import{Patcher_ChatMessage}from'./PatcherChatMessage.js';import{Patcher_SettingsConfig}from'./PatcherSettingsConfig.js';import{Patcher_CanvasAnimation}from'./PatcherCanvasAnimation.js';import{Patcher_Jquery}from'./PatcherJquery.js';import{Patcher_GameKeyboard}from'./PatcherGameKeyboard.js';import{Patcher_ActiveEffectConfig}from'./PatcherActiveEffectConfig.js';import{Patcher_Actor}from'./PatcherActor.js';import{Patcher_Drawing}from'./PatcherDrawing.js';import{JournalSheet_Plutonium}from'./PatcherJournalSheet.js';import{LGT}from'./Util.js';class Patcher{static['init'](){const _0x1972ab=_0xbae6;Hooks['on'](_0x1972ab(0xc4),Patcher_Actor[_0x1972ab(0xb1)][_0x1972ab(0xa4)](Patcher_Actor)),this[_0x1972ab(0xa3)](),this[_0x1972ab(0xb3)](),this[_0x1972ab(0xcf)](),Patcher_Token[_0x1972ab(0xdd)](),Patcher_TextEditor[_0x1972ab(0xdd)](),Patcher_ChatMessage[_0x1972ab(0xdd)](),Patcher_SettingsConfig[_0x1972ab(0xdd)](),Patcher_CanvasAnimation[_0x1972ab(0xdd)](),Patcher_Jquery[_0x1972ab(0xdd)](),Patcher_GameKeyboard[_0x1972ab(0xdd)](),Patcher_ActiveEffectConfig['init'](),Patcher_Actor['init'](),Hooks['on'](_0x1972ab(0xc6),()=>this[_0x1972ab(0xaf)]()),this[_0x1972ab(0xaf)](),this[_0x1972ab(0x96)](),Hooks['on']('canvasReady',()=>{Patcher_Drawing['handleConfigUpdate']();});}static[_0x37dfdb(0xaf)](){const _0x453c60=_0x37dfdb;if(ui[_0x453c60(0xb2)]?.[_0x453c60(0x9f)])ui['nav'][_0x453c60(0xc7)]();Patcher_Token[_0x453c60(0xbc)](),Patcher_Drawing[_0x453c60(0xbc)](),Patcher_ChatMessage[_0x453c60(0xbc)](),JournalSheet_Plutonium['handleConfigUpdate']();}static[_0x37dfdb(0x96)](){const _0xab6d43=_0x37dfdb;Config[_0xab6d43(0xac)](_0xab6d43(0xa7),'isUseExtendedActiveEffectsParser')&&(Actor[_0xab6d43(0xcd)][_0xab6d43(0xc2)]||[])[_0xab6d43(0xda)](_0x6c9965=>{const _0x30ccd7=_0xab6d43;try{_0x6c9965[_0x30ccd7(0xd3)]();}catch(_0x225880){const _0x2a8a0a=_0x30ccd7(0xb7)+(_0x6c9965['_id']||_0x6c9965['id'])+'\x22!';ui['notifications'][_0x30ccd7(0xd6)](_0x2a8a0a+'\x20'+VeCt['STR_SEE_CONSOLE']),console[_0x30ccd7(0xd6)](...LGT,_0x2a8a0a),console[_0x30ccd7(0xd6)](_0x225880);}});}static['_doPatchNavContextMenuOptions'](){const _0x2f6c15=_0x37dfdb;Hooks['on'](_0x2f6c15(0xa1),(_0x493e67,_0x3829d2)=>{const _0x454686=_0x2f6c15;if(!Config[_0x454686(0xac)]('ui','isAddDeleteToSceneNavOptions'))return;const _0x4e668e=_0x3829d2[_0x454686(0xbb)](_0x16c29=>_0x16c29[_0x454686(0x9c)]===_0x454686(0xdf)),_0x57fd08={'name':_0x454686(0x9e),'icon':_0x454686(0xca),'condition':_0x571fea=>{const _0x1467ff=_0x454686,_0x137618=game[_0x1467ff(0xba)][_0x1467ff(0xac)](_0x571fea['data'](_0x1467ff(0xd9)));return game[_0x1467ff(0xa0)][_0x1467ff(0xa5)]&&!_0x137618[_0x1467ff(0xc3)]['active'];},'callback':_0x3f0f29=>{const _0xfd532d=_0x454686,_0x14ec3f=Scene[_0xfd532d(0xcd)]['get'](_0x3f0f29['data']('sceneId')),{top:_0x200972,left:_0x54b5ee}=_0x3f0f29[0x0]['getBoundingClientRect']();Dialog['confirm']({'title':game[_0xfd532d(0x97)][_0xfd532d(0xcb)](_0xfd532d(0x9e))+'\x20'+_0x14ec3f[_0xfd532d(0x9c)],'content':game[_0xfd532d(0x97)][_0xfd532d(0xcb)](_0xfd532d(0xb0)),'yes':_0x14ec3f['delete'][_0xfd532d(0xa4)](_0x14ec3f),'options':{'top':Math[_0xfd532d(0xb9)](_0x200972+0x46,window['innerHeight']-0x15e),'left':Math[_0xfd532d(0xb9)](_0x54b5ee,window[_0xfd532d(0xd4)]-0x2d0)}});}};if(~_0x4e668e)_0x3829d2[_0x454686(0x9b)](_0x4e668e,0x0,_0x57fd08);else _0x3829d2['push'](_0x57fd08);return _0x3829d2;});}static[_0x37dfdb(0xb3)](){const _0x32a6d5=_0x37dfdb,_0x3179f4=ui[_0x32a6d5(0xc9)][_0x32a6d5(0xd8)][_0x32a6d5(0xa4)](ui[_0x32a6d5(0xc9)]);ui[_0x32a6d5(0xc9)][_0x32a6d5(0xd8)]=()=>{const _0xc42ee=_0x32a6d5,_0x27d33c=_0x3179f4();return _0x27d33c[_0xc42ee(0x99)]({'name':_0xc42ee(0xa6),'icon':_0xc42ee(0xb4),'condition':_0x5b8bdd=>{const _0x4b7bd3=_0xc42ee,_0xcedc49=ActorDirectory[_0x4b7bd3(0xcd)][_0x4b7bd3(0xac)](_0x5b8bdd[_0x4b7bd3(0xc3)](_0x4b7bd3(0xdb)));return _0xcedc49[_0x4b7bd3(0xde)];},'callback':_0x5e7696=>{const _0x99cd27=_0xc42ee,_0x352f18=ActorDirectory[_0x99cd27(0xcd)][_0x99cd27(0xac)](_0x5e7696[_0x99cd27(0xc3)](_0x99cd27(0xdb)));Config[_0x99cd27(0x9a)](_0x99cd27(0xa8),'targetActorId',_0x352f18['id']),ui['notifications'][_0x99cd27(0xb8)](_0x99cd27(0xae)+_0x352f18['id']+_0x99cd27(0xc8));}}),_0x27d33c;};}static[_0x37dfdb(0xcf)](){const _0x5322ce=_0x37dfdb,_0x55f90b=ui[_0x5322ce(0xc5)]['_getEntryContextOptions']['bind'](ui[_0x5322ce(0xc5)]);ui[_0x5322ce(0xc5)][_0x5322ce(0xd8)]=()=>{const _0x33e091=_0x5322ce,_0x506385=_0x55f90b(),_0x3ee2c1=_0x506385['findIndex'](_0x233ada=>_0x233ada[_0x33e091(0x9c)]==='PERMISSION.Configure');if(!~_0x3ee2c1)return _0x506385;return _0x506385['splice'](_0x3ee2c1+0x1,0x0,{'name':_0x33e091(0xd0),'icon':_0x33e091(0xab),'condition':_0x1903e0=>{const _0x3199b6=_0x33e091;if(!Config[_0x3199b6(0xac)]('journalEntries','isEnableUrlEmbeds'))return![];const _0x584608=JournalDirectory[_0x3199b6(0xcd)][_0x3199b6(0xac)](_0x1903e0[_0x3199b6(0xc3)](_0x3199b6(0xdb)));return _0x584608['owner'];},'callback':async _0x1c9ea7=>{const _0xe7170f=_0x33e091,_0x317369=JournalDirectory['collection'][_0xe7170f(0xac)](_0x1c9ea7[_0xe7170f(0xc3)](_0xe7170f(0xdb))),_0x3e4147=await _0x317369[_0xe7170f(0xa9)](SharedConsts[_0xe7170f(0xdc)],Consts[_0xe7170f(0xd5)]);let _0x13b39e=await InputUiUtil['pGetUserString']({'title':_0xe7170f(0xbf),'default':_0x3e4147||''});if(_0x13b39e==null)return;Object[_0xe7170f(0xe2)](_0x317369[_0xe7170f(0xb6)])[_0xe7170f(0xda)](_0xcc3884=>{const _0x44fab8=_0xe7170f;_0xcc3884[_0x44fab8(0xd2)]?_0xcc3884[_0x44fab8(0xd2)]():_0xcc3884[_0x44fab8(0x98)]();});if(!_0x13b39e)await _0x317369['setFlag'](SharedConsts[_0xe7170f(0xdc)],Consts['FLAG_IFRAME_URL'],'');else{_0x13b39e=_0x13b39e['trim']();if(_0x13b39e['startsWith']('<iframe'))_0x13b39e=$(_0x13b39e)[_0xe7170f(0xce)]('src');!_0x13b39e&&(ui[_0xe7170f(0xd7)][_0xe7170f(0xbd)](_0xe7170f(0xd1)+_0x13b39e+_0xe7170f(0xa2)),await _0x317369['setFlag'](SharedConsts['MODULE_NAME'],Consts[_0xe7170f(0xd5)],'')),await _0x317369['setFlag'](SharedConsts[_0xe7170f(0xdc)],Consts[_0xe7170f(0xd5)],_0x13b39e);}}}),_0x506385;};}}window[_0x37dfdb(0xb5)]=Patcher,Patcher[_0x37dfdb(0xe1)]=Patcher_TextEditor;export{Patcher};