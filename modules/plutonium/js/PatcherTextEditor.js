const _0x4c49=['jemb__btn-toggle','\x0a\x09\x09\x09\x09<div\x20class=\x22w-100\x20jemb__wrp-content\x20','MODULE_NAME','max','each','closest','</div>\x0a\x09\x09\x09\x09','TextEditor.enrichHTML','html','629DfiRJF','disabled','get','_getEntityEmbed','test','ve-hidden','attr','23RRrsdb','toggleClass','journalEntries','BUTTON','908BCjEyy','getElementsByTagName','<i\x20class=\x22fa\x20fa-caret-square-down\x22></i>','currentTarget','893XVnpSF','_createEntityLink','<i\x20class=\x22fa\x20fa-caret-square-left\x22></i>','classList','_doEnableToggleButtons','entities','handleToggleClick','data','22mtvChI','<button\x20class=\x22btn\x20btn-xxs\x20btn-5et\x20btn-default\x20flex-vh-center\x20mx-1\x20jemb__btn-toggle\x22\x20data-plut-is-expanded=\x22','replace','ENTITY_PERMISSIONS','img','_handleExpandCollapse','733117wMPvBi','isAutoExpandContentEmbeds','find','sheet','634IcSjCY','parent','_getEntityPermissions','</button>','3650327QcTcHP','isGM','\x22\x20title=\x22','permission','</div>\x0a\x09\x09\x09\x09<div\x20class=\x22flex-vh-center\x20jemb__wrp-content\x20','1tCkDFn','JournalSheet.prototype._disableFields','next','user','\x22><a\x20target=\x22_blank\x20w-100\x22\x20href=\x22','OWNER','enrichHTML','762759FOwvJP','content','outerHTML','data-plut-is-expanded','34301qLDfzS','<a\x20class=\x22entity-link\x20broken\x22><i\x20class=\x22fas\x20fa-unlink\x22></i>\x20','isEnableContentEmbeds','_getBtnHtmlToggle','Collapse','_MAX_RECURSION_DEPTH','\x20Journal\x20Entry\x20(SHIFT\x20for\x20All\x20Entries)\x22\x20onclick=\x22window.PlutPatcher.Patcher_TextEditor.handleToggleClick(event)\x22\x20type=\x22button\x22>','</a>','entityClass','_getEntity','register','\x22\x20class=\x22jemb__img\x22></a></div>\x0a\x09\x09\x09</div>','<div\x20class=\x22w-100\x20flex-col\x22>\x0a\x09\x09\x09\x09<div\x20class=\x22flex-v-center\x20mb-1\x20jemb__wrp-lnk\x22>','button[data-plut-is-expanded]','shiftKey','339IugPFL','LIBWRAPPER_MODE_WRAPPER','OBSERVER','Expand','</div>\x0a\x09\x09\x09</div>','_id','contains'];const _0x12a7=function(_0xb16661,_0x5a3401){_0xb16661=_0xb16661-0xf4;let _0x4c49ec=_0x4c49[_0xb16661];return _0x4c49ec;};const _0x51e55e=_0x12a7;(function(_0x3c442a,_0x54bdc7){const _0x27e124=_0x12a7;while(!![]){try{const _0x3d88dd=-parseInt(_0x27e124(0xfb))+parseInt(_0x27e124(0xf5))*-parseInt(_0x27e124(0xff))+-parseInt(_0x27e124(0x10f))+-parseInt(_0x27e124(0x113))*parseInt(_0x27e124(0x139))+-parseInt(_0x27e124(0x141))*parseInt(_0x27e124(0x122))+parseInt(_0x27e124(0x132))*-parseInt(_0x27e124(0x13d))+parseInt(_0x27e124(0x103))*parseInt(_0x27e124(0x108));if(_0x3d88dd===_0x54bdc7)break;else _0x3c442a['push'](_0x3c442a['shift']());}catch(_0x5e91b7){_0x3c442a['push'](_0x3c442a['shift']());}}}(_0x4c49,0x74a19));import{libWrapper,UtilLibWrapper}from'./PatcherLibWrapper.js';import{SharedConsts}from'../shared/SharedConsts.js';import{Config}from'./Config.js';class Patcher_TextEditor{static['init'](){const _0x5baa9f=_0x12a7;libWrapper[_0x5baa9f(0x11d)](SharedConsts[_0x5baa9f(0x12b)],_0x5baa9f(0x130),function(_0x307764,..._0x1d4b71){const _0x5caf77=_0x5baa9f;if(!Config[_0x5caf77(0x134)]('journalEntries',_0x5caf77(0x115)))return _0x307764(..._0x1d4b71);return Patcher_TextEditor[_0x5caf77(0x10e)](_0x307764,..._0x1d4b71);},UtilLibWrapper[_0x5baa9f(0x123)]),libWrapper[_0x5baa9f(0x11d)](SharedConsts[_0x5baa9f(0x12b)],_0x5baa9f(0x109),function(_0x57e3d4,..._0x588194){const _0x1dec89=_0x5baa9f,_0x39b8fd=_0x57e3d4(..._0x588194);if(!Config[_0x1dec89(0x134)](_0x1dec89(0x13b),_0x1dec89(0x115)))return _0x39b8fd;return Patcher_TextEditor[_0x1dec89(0x145)](..._0x588194),_0x39b8fd;},UtilLibWrapper['LIBWRAPPER_MODE_WRAPPER']);}static[_0x51e55e(0x10e)](_0x45a8d2,_0x54fcc5,_0x2e80da,_0x3a4ae4=0x0){const _0x4ed3b8=_0x51e55e;_0x2e80da=_0x2e80da||{},_0x54fcc5=_0x45a8d2(_0x54fcc5,_0x2e80da);if(!_0x2e80da[_0x4ed3b8(0x146)])return _0x54fcc5;return _0x54fcc5=_0x54fcc5[_0x4ed3b8(0xf7)](/@Embed(JournalEntry)\[([^\]]+)](?:{([^}]+)})?/g,(..._0x18233f)=>this[_0x4ed3b8(0x135)](_0x2e80da,_0x3a4ae4,..._0x18233f)),_0x54fcc5;}static['_getEntityEmbed'](_0x5ba5e5,_0x1b23a8,_0x54ebbd,_0x15a925,_0x5013e3,_0x59d9d7){const _0x329b5f=_0x51e55e,_0x2d8642=CONFIG[_0x15a925],_0x1f44c7=_0x2d8642[_0x329b5f(0x11b)]['collection'],_0x37259c=this[_0x329b5f(0x11c)](_0x1f44c7,_0x5013e3);if(!_0x37259c)return _0x329b5f(0x114)+(_0x59d9d7||_0x5013e3)+_0x329b5f(0x11a);if(this[_0x329b5f(0x101)](_0x37259c)<CONST[_0x329b5f(0xf8)][_0x329b5f(0x124)])return _0x329b5f(0x114)+(_0x59d9d7||_0x5013e3)+'\x20<i>(you\x20do\x20not\x20have\x20sufficient\x20permissions\x20to\x20view\x20this\x20journal\x20entry)</i></a>';const _0x50564c=TextEditor[_0x329b5f(0x142)](_0x54ebbd,_0x15a925,_0x5013e3,_0x59d9d7)[_0x329b5f(0x111)],_0x3a5410=Config[_0x329b5f(0x134)]('journalEntries',_0x329b5f(0xfc));if(_0x37259c[_0x329b5f(0xfe)]['_sheetMode']==='image'){const _0x554019=_0x37259c[_0x329b5f(0xf4)][_0x329b5f(0xf9)];return'<div\x20class=\x22w-100\x20flex-col\x22>\x0a\x09\x09\x09\x09<div\x20class=\x22flex-v-center\x20mb-1\x20jemb__wrp-lnk\x22>'+_0x50564c+this['_getBtnHtmlToggle'](_0x3a5410)+_0x329b5f(0x107)+(_0x3a5410?'':_0x329b5f(0x137))+_0x329b5f(0x10c)+_0x554019+'\x22><img\x20src=\x22'+_0x554019+_0x329b5f(0x11e);}else{const _0x5e0738=_0x1b23a8===Patcher_TextEditor[_0x329b5f(0x118)],_0x383c23=_0x5e0738?_0x37259c['data']['content']:TextEditor[_0x329b5f(0x10e)](_0x37259c[_0x329b5f(0xf4)][_0x329b5f(0x110)],_0x5ba5e5,_0x1b23a8+0x1);return _0x329b5f(0x11f)+_0x50564c+this[_0x329b5f(0x116)](_0x3a5410)+_0x329b5f(0x12f)+(_0x5e0738?'<div\x20class=\x22mb-1\x20bold\x20veapp__msg-error\x22>Warning:\x20too\x20many\x20recursive\x20embeds!\x20Have\x20you\x20made\x20an\x20infinite\x20loop?</div>':'')+_0x329b5f(0x12a)+(_0x3a5410?'':_0x329b5f(0x137))+'\x22>'+_0x383c23+_0x329b5f(0x126);}}static[_0x51e55e(0x101)](_0x6c0dc5){const _0x3b2106=_0x51e55e;if(game[_0x3b2106(0x10b)][_0x3b2106(0x104)])return CONST[_0x3b2106(0xf8)][_0x3b2106(0x10d)];return Math[_0x3b2106(0x12c)](_0x6c0dc5[_0x3b2106(0xf4)][_0x3b2106(0x106)][game['user'][_0x3b2106(0x127)]],_0x6c0dc5[_0x3b2106(0xf4)][_0x3b2106(0x106)]['default']);}static[_0x51e55e(0x11c)](_0x5e3931,_0x43fc2c){const _0x539f04=_0x51e55e;let _0x3130cc=null;if(/^[a-zA-Z0-9]{16}$/[_0x539f04(0x136)](_0x43fc2c))_0x3130cc=_0x5e3931[_0x539f04(0x134)](_0x43fc2c);if(!_0x3130cc)_0x3130cc=_0x5e3931['entities'][_0x539f04(0xfd)](_0x2cc6f8=>_0x2cc6f8[_0x539f04(0xf4)]['name']===_0x43fc2c);return _0x3130cc;}static[_0x51e55e(0x147)](_0x10ca45){const _0x3842b4=_0x51e55e,_0x39b69a=$(_0x10ca45[_0x3842b4(0x140)]),_0x581da2=_0x39b69a[_0x3842b4(0x138)](_0x3842b4(0x112))==='1';if(_0x10ca45[_0x3842b4(0x121)]){_0x10ca45['preventDefault']();const _0x17cc1c=_0x39b69a[_0x3842b4(0x12e)]('.editor');_0x17cc1c[_0x3842b4(0xfd)](_0x3842b4(0x120))[_0x3842b4(0x12d)]((_0x2ca4bc,_0x42dc74)=>this[_0x3842b4(0xfa)]($(_0x42dc74),_0x581da2));return;}this[_0x3842b4(0xfa)](_0x39b69a,_0x581da2);}static[_0x51e55e(0xfa)](_0x2fb214,_0x2f26e6){const _0x48975f=_0x51e55e,_0x2234e2=_0x2fb214[_0x48975f(0x100)]()[_0x48975f(0x10a)]();_0x2234e2[_0x48975f(0x13a)](_0x48975f(0x137),_0x2f26e6),_0x2fb214['attr'](_0x48975f(0x112),_0x2f26e6?'0':'1')[_0x48975f(0x131)](_0x2f26e6?'<i\x20class=\x22fa\x20fa-caret-square-left\x22></i>':_0x48975f(0x13f))['title']((_0x2f26e6?_0x48975f(0x125):'Collapse')+'\x20Journal\x20Entry\x20(SHIFT\x20for\x20All\x20Entries)');}static['_getBtnHtmlToggle'](_0x586b7f){const _0x3c078a=_0x51e55e;return _0x3c078a(0xf6)+(_0x586b7f?0x1:0x0)+_0x3c078a(0x105)+(_0x586b7f?_0x3c078a(0x117):_0x3c078a(0x125))+_0x3c078a(0x119)+(_0x586b7f?'<i\x20class=\x22fa\x20fa-caret-square-down\x22></i>':_0x3c078a(0x143))+_0x3c078a(0x102);}static['_doEnableToggleButtons'](_0x23f45c){const _0x139abf=_0x51e55e;for(let _0x134053 of _0x23f45c[_0x139abf(0x13e)](_0x139abf(0x13c))){if(_0x134053[_0x139abf(0x144)][_0x139abf(0x128)](_0x139abf(0x129)))_0x134053['removeAttribute'](_0x139abf(0x133));}}}Patcher_TextEditor['_MAX_RECURSION_DEPTH']=0x45;export{Patcher_TextEditor};