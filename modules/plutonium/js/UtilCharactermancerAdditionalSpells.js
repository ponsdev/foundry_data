const _0x1932=['replace','_getFlatExpandedSpellsInRange','1PbMfbk','_render_addLastAlwaysPreparedSpellsHook','modalFilterSpells','MAX_SAFE_INTEGER','stringify','rest','ascSortLower','isNoChoice','getFlatData','\x22></div>','type','render','Spell\x20Set\x20','<div\x20class=\x22flex-v-center\x20flex-wrap\x20w-100\x20btn-group\x20','forEach','setEq','length','state','_isAnyInnatePrepared','ritual','</div>','_additionalSpellsFlat','Unhandled\x20recharge\x20type\x20\x22','atwill','string','19wAMEkw','data','_getFlatData_doProcessAdditionMeta','Unhandled\x20spell\x20addition\x20type\x20\x22','count','push','_addHookBase','prop','MIN_SAFE_INTEGER','name','segregate','attAbvToFull','parentAbilityAbv','inherit','innate','spell','280597tzascC','join','will','choose','spellLevelHigh','preparationMode','_getFlatInnatePreparedSpellsInRange','_getFlatSpellsInRange','_render_addLastExpandedSpellsHook','map','ixSet','copy','filter','<div\x20class=\x22ve-small\x20flex-v-center\x20my-1\x20w-100\x20italic\x20ve-muted\x22>No\x20spells\x20at\x20this\x20level</div>','uses','addHookAlwaysPreparedSpells','<div\x20class=\x22italic\x20ve-muted\x22>(select\x20a\x20spell)</div>','spellsAlwaysPrepared','_state','get','active','<div\x20class=\x22flex-v-center\x20py-1\x22>\x0a\x09\x09\x09<div\x20class=\x22col-3\x20text-center\x22>Level</div>\x0a\x09\x09\x09<div\x20class=\x22col-9\x22>Spells</div>\x0a\x09\x09</div>','requiredLevel','_getFlatData_doProcessSpellRechargeBlock','_sourceHintText','curLevel','values','uid','key','usesPer','<div\x20class=\x22flex-v-center\x22></div>','filterExpression','_render_$getSelChooseAbility','<div\x20class=\x22flex-v-center\x20py-1\x22>\x0a\x09\x09\x09<div\x20class=\x22col-3\x20text-center\x22>Spell\x20Level</div>\x0a\x09\x09\x09<div\x20class=\x22col-9\x22>Spells</div>\x0a\x09\x09</div>','25982UGOcmU','FlatSpell','_render_renderOptions','modalTitle','toLowerCase','_isRequiredCasterLevelInRange','</button>','pGetSpellHashToItemPosMapAndFillSpellsFromTagIds','66410jsKjMH','_isRequiredLevelInRange','toggleVe','pGetFormData','448658uoZrmk','toSpellCase','pGetUserSelection','951171gnPXvD','_render_$getRows','_additionalSpells','_isAnyExpanded','sort','appendTo','isExpanded','some','toggleClass','_getFlatData_doProcessSpellItem','splitTagByPipe','_isAnyInnatePreparedExpanded','always','additionalSpells','206677ZZNLeF','_render_addLastBoolSpellsHook','castAtLevel','ability','{@spell\x20','prepared','entries','isAlwaysPrepared','spells','pop','getFormData','pGetUserInput','meta','spellLevelLow','Charactermancer_AdditionalSpellsSelect.spells','exec','Unhandled\x20additional\x20spell\x20format:\x20\x22','append','spellsExpanded','245428fpzXFp','_isChooseAbility','split','trim','<button\x20class=\x22btn\x20btn-xs\x20flex-1\x22\x20title=\x22Select\x20Spell\x20Set\x22>','_proxyAssignSimple','Unhandled\x20spell\x20recharge\x20type\x20\x22','abilityAbv','<div>','targetLevel','ascSort','requiredCasterLevel'];const _0x2a36=function(_0x4df5c6,_0x51005e){_0x4df5c6=_0x4df5c6-0xe7;let _0x19325f=_0x1932[_0x4df5c6];return _0x19325f;};const _0x292d8e=_0x2a36;(function(_0x51596d,_0x5b9d01){const _0x45a646=_0x2a36;while(!![]){try{const _0x5957b4=-parseInt(_0x45a646(0x153))*-parseInt(_0x45a646(0xeb))+-parseInt(_0x45a646(0x166))+parseInt(_0x45a646(0x114))+parseInt(_0x45a646(0x104))*parseInt(_0x45a646(0x136))+parseInt(_0x45a646(0x13e))+parseInt(_0x45a646(0x142))+-parseInt(_0x45a646(0x145));if(_0x5957b4===_0x5b9d01)break;else _0x51596d['push'](_0x51596d['shift']());}catch(_0x5cfde6){_0x51596d['push'](_0x51596d['shift']());}}}(_0x1932,0x49189));import{Charactermancer_Util}from'./UtilCharactermancer.js';import{DataConverterSpell}from'./DataConverterSpell.js';import{ModalFilterSpellsFvtt}from'./UtilModalFilter.js';class Charactermancer_AdditionalSpellsUtil{static[_0x292d8e(0xf3)](_0xf81d18){const _0x454062=_0x292d8e;return _0xf81d18=MiscUtil[_0x454062(0x11f)](_0xf81d18),_0xf81d18['map'](_0x3ccfd9=>{const _0x15ab7e={},_0x572779={},_0x1b87ce=[];return Object['entries'](_0x3ccfd9)['forEach'](([_0x35c9d2,_0x1e34d4])=>{const _0xc6944d=_0x2a36;_0x1b87ce['push'](_0x35c9d2);switch(_0x35c9d2){case _0xc6944d(0x10d):case _0xc6944d(0x156):_0x15ab7e[_0x35c9d2]=_0x1e34d4;break;case _0xc6944d(0x112):case _0xc6944d(0x158):case'expanded':{this[_0xc6944d(0x106)]({'additionType':_0x35c9d2,'additionMeta':_0x1e34d4,'outSpells':_0x572779,'keyPath':_0x1b87ce});break;}default:throw new Error(_0xc6944d(0x107)+_0x35c9d2+'\x22');}_0x1b87ce[_0xc6944d(0x15c)]();}),{'meta':_0x15ab7e,'spells':_0x572779};});}static[_0x292d8e(0x106)](_0x25a3c4){const _0x3dc82f=_0x292d8e,{additionMeta:_0xc7a63d,keyPath:_0xac311}=_0x25a3c4;Object[_0x3dc82f(0x159)](_0xc7a63d)['forEach'](([_0x10346d,_0x45c529])=>{const _0x38783f=_0x3dc82f;_0xac311[_0x38783f(0x109)](_0x10346d),_0x45c529 instanceof Array?_0x45c529['forEach']((_0x59c30d,_0x55bf15)=>this[_0x38783f(0x14e)]({..._0x25a3c4,'levelOrCasterLevel':_0x10346d,'spellItem':_0x59c30d,'ix':_0x55bf15})):Object[_0x38783f(0x159)](_0x45c529)['forEach'](([_0x1ec3bf,_0x2489c6])=>{const _0x426e99=_0x38783f;this[_0x426e99(0x12b)]({..._0x25a3c4,'levelOrCasterLevel':_0x10346d,'rechargeType':_0x1ec3bf,'levelMetaInner':_0x2489c6});}),_0xac311['pop']();});}static[_0x292d8e(0x14e)](_0x29b629){const _0x1f8f0d=_0x292d8e,{additionType:_0x118b9e,additionMeta:_0x122c4b,outSpells:_0x2281ba,keyPath:_0x589822,spellItem:_0x39e303,ix:_0x23445a,rechargeType:_0x457c25,uses:_0x1f25b4,usesPer:_0x1c8103,levelOrCasterLevel:_0x29d0c6}=_0x29b629;_0x589822[_0x1f8f0d(0x109)](_0x23445a);const _0x29a986={'isExpanded':_0x118b9e==='expanded','isAlwaysPrepared':_0x118b9e==='prepared','isPrepared':_0x118b9e==='prepared'||_0x118b9e==='innate','preparationMode':_0x118b9e===_0x1f8f0d(0x158)?_0x1f8f0d(0x151):_0x1f8f0d(0x112)},_0x55f566=/^s(\d+)$/[_0x1f8f0d(0x162)](_0x29d0c6);if(_0x55f566)_0x29a986[_0x1f8f0d(0xe8)]=Number(_0x55f566[0x1]);else _0x29a986[_0x1f8f0d(0x12a)]=Number(_0x29d0c6);if(_0x457c25)switch(_0x457c25){case'rest':case'daily':break;case _0x1f8f0d(0x116):case _0x1f8f0d(0xfe):{_0x29a986['preparationMode']=_0x1f8f0d(0x102),_0x29a986['isPrepared']=_0x457c25!==_0x1f8f0d(0xfe);break;}case'_':break;default:throw new Error(_0x1f8f0d(0x101)+_0x457c25+'\x22');}if(_0x1f25b4)_0x29a986[_0x1f8f0d(0x122)]=_0x1f25b4;if(_0x1c8103)_0x29a986[_0x1f8f0d(0x131)]=_0x1c8103;if(typeof _0x39e303===_0x1f8f0d(0x103)){const _0x31d5c0=_0x589822[_0x1f8f0d(0x115)]('__');_0x2281ba[_0x31d5c0]=new Charactermancer_AdditionalSpellsUtil[(_0x1f8f0d(0x137))]({'type':_0x1f8f0d(0x113),'key':_0x31d5c0,..._0x29a986,'uid':_0x39e303});}else{if(_0x39e303[_0x1f8f0d(0x117)]){const _0x339de1=_0x39e303[_0x1f8f0d(0x108)]||0x1;for(let _0x4b9584=0x0;_0x4b9584<_0x339de1;++_0x4b9584){_0x589822[_0x1f8f0d(0x109)](_0x4b9584);const _0x4e477c=_0x589822[_0x1f8f0d(0x115)]('__');_0x2281ba[_0x4e477c]=new Charactermancer_AdditionalSpellsUtil[(_0x1f8f0d(0x137))]({'type':_0x1f8f0d(0x117),'key':_0x4e477c,..._0x29a986,'filterExpression':_0x39e303['choose']}),_0x589822[_0x1f8f0d(0x15c)]();}}else throw new Error(_0x1f8f0d(0x163)+JSON[_0x1f8f0d(0xef)](_0x39e303)+'\x22');}_0x589822[_0x1f8f0d(0x15c)]();}static[_0x292d8e(0x12b)](_0xfd47c8){const _0x2fcf1d=_0x292d8e,{additionType:_0xb590c2,additionMeta:_0x256712,outSpells:_0x5a8922,keyPath:_0x194da5,levelOrCasterLevel:_0xb71573,rechargeType:_0xd4cd22,levelMetaInner:_0x47a22f}=_0xfd47c8;_0x194da5['push'](_0xd4cd22);switch(_0xd4cd22){case _0x2fcf1d(0xf0):case'daily':{const _0x37eca1=_0xd4cd22===_0x2fcf1d(0xf0)?'sr':'lr';Object[_0x2fcf1d(0x159)](_0x47a22f)[_0x2fcf1d(0xf9)](([_0x4e0ba9,_0x106aba])=>{const _0x53670d=_0x2fcf1d;_0x194da5[_0x53670d(0x109)](_0x4e0ba9),_0x4e0ba9=_0x4e0ba9[_0x53670d(0xe9)](/^(\d+)e$/,'$1');const _0x44970a=Number(_0x4e0ba9);_0x106aba[_0x53670d(0xf9)]((_0x40d780,_0x170b87)=>this['_getFlatData_doProcessSpellItem']({..._0xfd47c8,'spellItem':_0x40d780,'ix':_0x170b87,'uses':_0x44970a,'usesPer':_0x37eca1})),_0x194da5['pop']();});break;}case'will':case _0x2fcf1d(0xfe):case'_':{_0x47a22f[_0x2fcf1d(0xf9)]((_0x3eb075,_0xe94662)=>this[_0x2fcf1d(0x14e)]({..._0xfd47c8,'spellItem':_0x3eb075,'ix':_0xe94662}));break;}default:throw new Error(_0x2fcf1d(0x16c)+_0xd4cd22+'\x22');}_0x194da5[_0x2fcf1d(0x15c)]();}}Charactermancer_AdditionalSpellsUtil[_0x292d8e(0x137)]=class{constructor(_0x5062a8){const _0x4eaefa=_0x292d8e;this[_0x4eaefa(0xf5)]=_0x5062a8['type'],this[_0x4eaefa(0x130)]=_0x5062a8['key'],this['isExpanded']=_0x5062a8[_0x4eaefa(0x14b)],this['isPrepared']=_0x5062a8['isPrepared'],this[_0x4eaefa(0x15a)]=_0x5062a8[_0x4eaefa(0x15a)],this['preparationMode']=_0x5062a8[_0x4eaefa(0x119)],this['requiredCasterLevel']=_0x5062a8[_0x4eaefa(0xe8)],this[_0x4eaefa(0x12a)]=_0x5062a8[_0x4eaefa(0x12a)],this[_0x4eaefa(0x122)]=_0x5062a8['uses'],this['usesPer']=_0x5062a8[_0x4eaefa(0x131)],this[_0x4eaefa(0x12f)]=null,this['castAtLevel']=null;if(_0x5062a8[_0x4eaefa(0x12f)]){const [_0x466377,_0xbd72d4]=_0x5062a8[_0x4eaefa(0x12f)][_0x4eaefa(0x168)]('#')[_0x4eaefa(0x11d)](_0x3d1bb2=>_0x3d1bb2[_0x4eaefa(0x169)]())[_0x4eaefa(0x120)](Boolean);let [_0x59717c,_0x55cb01]=Renderer[_0x4eaefa(0x14f)](_0x466377[_0x4eaefa(0x13a)]());_0x55cb01=_0x55cb01||SRC_PHB[_0x4eaefa(0x13a)](),this['uid']=_0x59717c+'|'+_0x55cb01;if(_0xbd72d4&&!isNaN(_0xbd72d4))this[_0x4eaefa(0x155)]=Number(_0xbd72d4);}this[_0x4eaefa(0x133)]=_0x5062a8['filterExpression'];}};class Charactermancer_AdditionalSpellsSelect extends BaseComponent{static async[_0x292d8e(0x15e)](_0x53dcb1){const _0x3ece7d=_0x292d8e;_0x53dcb1=_0x53dcb1||{};const {additionalSpells:_0x4d659b}=_0x53dcb1;if(!_0x4d659b||!_0x4d659b[_0x3ece7d(0xfb)])return{'isFormComplete':!![],'data':[]};const _0x23b1f0=new ModalFilterSpellsFvtt({'namespace':_0x3ece7d(0x161),'isRadio':!![]}),_0x79a193=new this({..._0x53dcb1,'modalFilterSpells':_0x23b1f0});_0x79a193['curLevel']=_0x53dcb1[_0x3ece7d(0x12d)],_0x79a193['targetLevel']=_0x53dcb1[_0x3ece7d(0x16f)],_0x79a193['spellLevelLow']=_0x53dcb1[_0x3ece7d(0x160)],_0x79a193[_0x3ece7d(0x118)]=_0x53dcb1[_0x3ece7d(0x118)];if(_0x79a193['isNoChoice']())return _0x79a193[_0x3ece7d(0x141)]();return Charactermancer_Util['pGetImportCompApplicationFormData']({'comp':_0x79a193,'height':0xdc});}static async['pApplyFormDataToActor'](_0x2aabf8,_0x326e09,_0x40d1da){const _0xed2781=_0x292d8e;_0x40d1da=_0x40d1da||{};if(!_0x326e09||!_0x326e09?.[_0xed2781(0x105)]?.['length'])return;const _0x12c079=(_0x40d1da[_0xed2781(0x16d)]===_0xed2781(0x111)?_0x40d1da[_0xed2781(0x110)]:_0x40d1da[_0xed2781(0x16d)])||_0x326e09[_0xed2781(0x16d)];await DataConverterSpell[_0xed2781(0x13d)](_0x2aabf8,_0x326e09[_0xed2781(0x105)],{'optsGetSpellItem':{'casterLevel':_0x40d1da['casterLevel'],'abilityAbv':_0x12c079},'hashToIdMap':_0x40d1da['hashToIdMap']});}constructor(_0x4ef163){const _0x2df388=_0x292d8e;_0x4ef163=_0x4ef163||{},super(),this[_0x2df388(0x147)]=_0x4ef163[_0x2df388(0x152)],this['_sourceHintText']=_0x4ef163['sourceHintText'],this['_modalFilterSpells']=_0x4ef163[_0x2df388(0xed)],this[_0x2df388(0x100)]=Charactermancer_AdditionalSpellsUtil[_0x2df388(0xf3)](_0x4ef163['additionalSpells']);}get[_0x292d8e(0x139)](){const _0x2e61a3=_0x292d8e;return'Choose\x20Additional\x20Spell\x20Set'+(this[_0x2e61a3(0x12c)]?'\x20('+this[_0x2e61a3(0x12c)]+')':'');}set['curLevel'](_0x19e610){const _0x24a991=_0x292d8e;this[_0x24a991(0x126)]['curLevel']=_0x19e610;}set[_0x292d8e(0x16f)](_0x31d21e){const _0x2b4f00=_0x292d8e;this[_0x2b4f00(0x126)][_0x2b4f00(0x16f)]=_0x31d21e;}set[_0x292d8e(0x160)](_0x39132b){this['_state']['spellLevelLow']=_0x39132b;}set[_0x292d8e(0x118)](_0x38e60d){const _0x5bb06d=_0x292d8e;this['_state'][_0x5bb06d(0x118)]=_0x38e60d;}[_0x292d8e(0x123)](_0x59324e){this['_addHookBase']('spellsAlwaysPrepared',_0x59324e);}['addHookExpandedSpells'](_0x6c366e){const _0x3812ab=_0x292d8e;this['_addHookBase'](_0x3812ab(0x165),_0x6c366e);}get[_0x292d8e(0x125)](){const _0x35cdf0=_0x292d8e;return this[_0x35cdf0(0x126)][_0x35cdf0(0x125)];}get[_0x292d8e(0x165)](){const _0x9e96ca=_0x292d8e;return this[_0x9e96ca(0x126)][_0x9e96ca(0x165)];}[_0x292d8e(0xec)](){const _0x39f254=_0x292d8e;return this[_0x39f254(0x154)]({'propState':_0x39f254(0x125),'propIsBool':_0x39f254(0x15a)});}[_0x292d8e(0x11c)](){const _0x34e90e=_0x292d8e;return this[_0x34e90e(0x154)]({'propState':'spellsExpanded','propIsBool':_0x34e90e(0x14b)});}[_0x292d8e(0x154)]({propState:_0x4c1187,propIsBool:_0x13ffc7}){const _0x4c8413=_0x292d8e,_0x35f882=()=>{const _0x3cfacb=_0x2a36,_0x37d64e=this[_0x3cfacb(0x15d)](),_0x120b85=_0x37d64e[_0x3cfacb(0x105)]['filter'](_0x408d42=>_0x408d42[_0x13ffc7])[_0x3cfacb(0x11d)](_0x356888=>_0x356888[_0x3cfacb(0x12f)][_0x3cfacb(0x13a)]()),_0x2f1bcb=new Set(this[_0x3cfacb(0x126)][_0x4c1187]),_0x19d35a=new Set(_0x120b85);if(!CollectionUtil[_0x3cfacb(0xfa)](_0x2f1bcb,_0x19d35a))this[_0x3cfacb(0x126)][_0x4c1187]=_0x120b85;};this[_0x4c8413(0x10a)](_0x4c8413(0x11e),_0x35f882),this[_0x4c8413(0x10a)](_0x4c8413(0x12d),_0x35f882),this['_addHookBase']('targetLevel',_0x35f882),this[_0x4c8413(0x10a)]('spellLevelLow',_0x35f882),this[_0x4c8413(0x10a)](_0x4c8413(0x118),_0x35f882),_0x35f882();}[_0x292d8e(0xf6)](_0x1c6987){const _0x2a0166=_0x292d8e;this[_0x2a0166(0xec)](),this[_0x2a0166(0x11c)]();const _0xd66649=$(_0x2a0166(0xf8)+(this[_0x2a0166(0x100)][_0x2a0166(0xfb)]>0x1?'mb-1':'')+_0x2a0166(0xf4)),_0x2d9eae=$('<div\x20class=\x22flex-col\x20w-100\x22></div>');for(let _0x4fb212=0x0;_0x4fb212<this['_additionalSpellsFlat'][_0x2a0166(0xfb)];++_0x4fb212)this[_0x2a0166(0x138)](_0xd66649,_0x2d9eae,_0x4fb212);$$(_0x1c6987)`
			${_0xd66649}
			${_0x2d9eae}
		`;}[_0x292d8e(0x138)](_0x172154,_0x4f3de2,_0xbc0f8d){const _0xfc70f4=_0x292d8e,_0x232e99=this['_additionalSpellsFlat'][_0xbc0f8d],_0x40ed5f=this[_0xfc70f4(0x100)][_0xfc70f4(0xfb)]===0x1?null:$(_0xfc70f4(0x16a)+(_0x232e99[_0xfc70f4(0x15f)][_0xfc70f4(0x10d)]??_0xfc70f4(0xf7)+(_0xbc0f8d+0x1))+_0xfc70f4(0x13c))['click'](()=>this[_0xfc70f4(0x126)][_0xfc70f4(0x11e)]=_0xbc0f8d),_0x128c1c=this[_0xfc70f4(0xfd)](_0xbc0f8d),_0xa1c974=this[_0xfc70f4(0x148)](_0xbc0f8d),_0x513bf1=Object[_0xfc70f4(0x12e)](_0x232e99[_0xfc70f4(0x15b)])['sort']((_0xdb1f61,_0x16dfe0)=>SortUtil[_0xfc70f4(0xe7)](_0xdb1f61['requiredLevel']||0x0,_0x16dfe0['requiredLevel']||0x0)||SortUtil[_0xfc70f4(0xe7)](_0xdb1f61[_0xfc70f4(0xe8)]||0x0,_0x16dfe0[_0xfc70f4(0xe8)]||0x0)),_0x41b16f=_0x128c1c?$(_0xfc70f4(0x129)):null,_0x49dbf8=_0xa1c974?$(_0xfc70f4(0x135)):null,_0x51feba=_0x128c1c?this[_0xfc70f4(0x146)](_0xbc0f8d,_0x513bf1,{'isExpandedMatch':![]}):null,_0x3e7d91=_0xa1c974?this[_0xfc70f4(0x146)](_0xbc0f8d,_0x513bf1,{'isExpandedMatch':!![]}):null,_0x58e1a=_0x128c1c?$(_0xfc70f4(0x121)):null,_0x175224=_0xa1c974?$(_0xfc70f4(0x121)):null,_0x1a5653=()=>{const _0x19f13d=_0xfc70f4,_0x50c2f5=!!this['_getFlatInnatePreparedSpellsInRange'](_0xbc0f8d)[_0x19f13d(0xfb)];if(_0x41b16f)_0x41b16f['toggleVe'](_0x50c2f5);if(_0x58e1a)_0x58e1a['toggleVe'](!_0x50c2f5);const _0x586b3b=!!this[_0x19f13d(0xea)](_0xbc0f8d)['length'];if(_0x49dbf8)_0x49dbf8[_0x19f13d(0x140)](_0x586b3b);if(_0x175224)_0x175224[_0x19f13d(0x140)](!_0x586b3b);};this['_addHookBase']('spellLevelLow',_0x1a5653),this[_0xfc70f4(0x10a)]('spellLevelHigh',_0x1a5653),this[_0xfc70f4(0x10a)](_0xfc70f4(0x12d),_0x1a5653),this['_addHookBase'](_0xfc70f4(0x16f),_0x1a5653),this[_0xfc70f4(0x10a)](_0xfc70f4(0x11e),_0x1a5653),_0x1a5653();const _0x369ead=_0x128c1c?$$`<div class="flex-col">
			<h3 class="bold my-0">Innate/Prepared Spells</h3>
			${_0x41b16f}
			${_0x51feba}
			${_0x58e1a}
		</div>`:null,_0x1cba77=_0xa1c974?$$`<div class="flex-col">
			<h3 class="bold my-0">Expanded Spell List</h3>
			${_0x49dbf8}
			${_0x3e7d91}
			${_0x175224}
		</div>`:null,_0x2c9288=this[_0xfc70f4(0x167)](_0xbc0f8d),_0x2af954=_0x2c9288?this[_0xfc70f4(0x134)](_0xbc0f8d):null,_0x1289e2=_0x2c9288?$$`<div class="split-v-center">
			<h3 class="bold my-0 no-shrink mr-2">Ability Score</h3>
			${_0x2af954}
		</div>`:null;if(_0x40ed5f)_0x172154[_0xfc70f4(0x164)](_0x40ed5f);const _0x359ea6=$$`<div class="flex-col">
			${_0x369ead}
			${_0x1cba77}
			${_0x1289e2}
		</div>`['appendTo'](_0x4f3de2);if(this[_0xfc70f4(0x100)][_0xfc70f4(0xfb)]!==0x1){const _0xa1889a=()=>{const _0x5e4883=_0xfc70f4;_0x40ed5f[_0x5e4883(0x14d)](_0x5e4883(0x128),this['_state'][_0x5e4883(0x11e)]===_0xbc0f8d),_0x359ea6['toggleVe'](this[_0x5e4883(0x126)][_0x5e4883(0x11e)]===_0xbc0f8d);};this['_addHookBase'](_0xfc70f4(0x11e),_0xa1889a),_0xa1889a();const _0x8e505c=(_0x4fb102,_0x1eb3fd,_0x50f4d8)=>{const _0x2138cd=_0xfc70f4,_0x18f35d=this[_0x2138cd(0x100)][_0x50f4d8],_0x54a878=Object[_0x2138cd(0x12e)](_0x18f35d[_0x2138cd(0x15b)])['mergeMap'](_0x1334b0=>({[_0x1334b0['key']]:null}));this[_0x2138cd(0x16b)](_0x2138cd(0xfc),_0x54a878);};this[_0xfc70f4(0x10a)](_0xfc70f4(0x11e),_0x8e505c);}}[_0x292d8e(0x146)](_0x42145a,_0x26dfd9,{isExpandedMatch:_0xffeae}){const _0x43cf0d=_0x292d8e;if(!_0x26dfd9['length'])return null;const _0x454cde={};return _0x26dfd9[_0x43cf0d(0xf9)](_0x53419e=>{const _0x403429=_0x43cf0d;if(_0x53419e[_0x403429(0x14b)]!==_0xffeae)return;const _0x1ed535=_0x53419e[_0x403429(0xe8)]||_0x53419e['requiredLevel'];(_0x454cde[_0x1ed535]=_0x454cde[_0x1ed535]||[])[_0x403429(0x109)](_0x53419e);}),Object[_0x43cf0d(0x159)](_0x454cde)['sort'](([_0x3d39f5],[_0x50087e])=>SortUtil['ascSort'](Number(_0x3d39f5),Number(_0x50087e)))['map'](([,_0x29d728])=>{const _0x421d27=_0x43cf0d,_0x11875f=_0x29d728[0x0][_0x421d27(0xe8)]!=null,[_0x2e96a0,_0x17531e]=_0x29d728[_0x421d27(0x10e)](_0x11be28=>!_0x11be28['filterExpression']);_0x2e96a0['sort']((_0x535a6c,_0x4c27a8)=>SortUtil[_0x421d27(0xf1)](_0x535a6c[_0x421d27(0x12f)],_0x4c27a8[_0x421d27(0x12f)])),_0x17531e[_0x421d27(0x149)]((_0x2399a6,_0x3f1045)=>SortUtil[_0x421d27(0xf1)](_0x2399a6[_0x421d27(0x133)],_0x3f1045[_0x421d27(0x133)]));const _0x44319a=$$`<div class="col-9 flex-v-center">
					<div>${Renderer[_0x421d27(0x127)]()['render'](_0x2e96a0[_0x421d27(0x11d)](_0x46f5bb=>'{@spell\x20'+_0x46f5bb[_0x421d27(0x12f)][_0x421d27(0x143)]()+'}')[_0x421d27(0x115)](',\x20'))}</div>
				</div>`;_0x17531e[_0x421d27(0xf9)]((_0x3619bd,_0x4f99fb)=>{const _0xe5311f=_0x421d27,_0xc504ef=$(_0xe5311f(0x132)),_0x2b982d=()=>{const _0x261221=_0xe5311f;_0xc504ef['html'](this[_0x261221(0x126)][_0x3619bd[_0x261221(0x130)]]!=null&&this['_state'][_0x261221(0x11e)]===_0x42145a?_0x261221(0x16e)+Renderer[_0x261221(0x127)]()[_0x261221(0xf6)](_0x261221(0x157)+this[_0x261221(0x126)][_0x3619bd['key']][_0x261221(0x13a)]()+'}')+_0x261221(0xff):_0x261221(0x124));};this[_0xe5311f(0x10a)](_0x3619bd['key'],_0x2b982d);this[_0xe5311f(0x100)][_0xe5311f(0xfb)]!==0x1&&this[_0xe5311f(0x10a)](_0xe5311f(0x11e),_0x2b982d);_0x2b982d();const _0x3a68a8=$('<button\x20class=\x22btn\x20btn-default\x20btn-xxs\x20mr-1\x22\x20title=\x22Choose\x20a\x20Spell\x22><span\x20class=\x22fas\x20fa-search\x22></span></button>')['click'](async()=>{const _0xdadbad=_0xe5311f,_0x173dbe=await this['_modalFilterSpells'][_0xdadbad(0x144)]({'filterExpression':_0x3619bd[_0xdadbad(0x133)]});if(_0x173dbe==null||!_0x173dbe[_0xdadbad(0xfb)])return;const _0x815631=_0x173dbe[0x0];this[_0xdadbad(0x126)][_0x3619bd[_0xdadbad(0x130)]]=_0x815631[_0xdadbad(0x10d)]+'|'+_0x815631['values']['sourceJson'];});if(this[_0xe5311f(0x100)][_0xe5311f(0xfb)]!==0x1){const _0x3029fa=()=>_0x3a68a8[_0xe5311f(0x10b)]('disabled',this[_0xe5311f(0x126)]['ixSet']!==_0x42145a);this[_0xe5311f(0x10a)](_0xe5311f(0x11e),_0x3029fa),_0x3029fa();}if(_0x2e96a0[_0xe5311f(0xfb)]||_0x4f99fb)_0x44319a[_0xe5311f(0x164)]('<div\x20class=\x22mr-2\x22>,</div>');$$`<div class="flex-v-center">${_0x3a68a8}${_0xc504ef}</div>`[_0xe5311f(0x14a)](_0x44319a);});const _0x1bb7d3=$$`<div class="py-1 flex-v-center stripe-even">
					<div class="col-3 text-center">${Parser['getOrdinalForm'](_0x29d728[0x0][_0x421d27(0xe8)]||_0x29d728[0x0]['requiredLevel'])}</div>
					${_0x44319a}
				</div>`;if(_0x11875f){const _0x290b68=()=>_0x1bb7d3[_0x421d27(0x140)](this[_0x421d27(0x13b)](_0x29d728[0x0][_0x421d27(0xe8)]));this['_addHookBase'](_0x421d27(0x160),_0x290b68),this['_addHookBase'](_0x421d27(0x118),_0x290b68),_0x290b68();}else{const _0x5ccbbe=()=>_0x1bb7d3[_0x421d27(0x140)](this[_0x421d27(0x13f)](_0x29d728[0x0][_0x421d27(0x12a)]));this['_addHookBase']('curLevel',_0x5ccbbe),this[_0x421d27(0x10a)](_0x421d27(0x16f),_0x5ccbbe),_0x5ccbbe();}return _0x1bb7d3;});}[_0x292d8e(0x134)](_0x98f964){const _0x3df346=_0x292d8e;return ComponentUiUtil['$getSelEnum'](this,_0x3df346(0x156),{'values':this['_additionalSpells'][_0x98f964]['ability']['choose'],'fnDisplay':_0x59eae6=>Parser[_0x3df346(0x10f)](_0x59eae6),'isAllowNull':!![]});}[_0x292d8e(0x13f)](_0x280254){const _0x3928f6=_0x292d8e;return _0x280254>(this[_0x3928f6(0x126)][_0x3928f6(0x12d)]??Number[_0x3928f6(0xee)])&&_0x280254<=(this[_0x3928f6(0x126)][_0x3928f6(0x16f)]==null?Number[_0x3928f6(0x10c)]:this[_0x3928f6(0x126)][_0x3928f6(0x16f)]);}[_0x292d8e(0x13b)](_0x3000f7){const _0xda7c00=_0x292d8e;return _0x3000f7>=(this['_state'][_0xda7c00(0x160)]??Number[_0xda7c00(0xee)])&&_0x3000f7<=(this[_0xda7c00(0x126)][_0xda7c00(0x118)]==null?Number[_0xda7c00(0x10c)]:this[_0xda7c00(0x126)][_0xda7c00(0x118)]);}[_0x292d8e(0x11b)](_0x5c5dbb,{isExpandedMatch:isExpandedMatch=null}={}){const _0x473218=_0x292d8e;if(_0x5c5dbb==null)_0x5c5dbb=this[_0x473218(0x126)][_0x473218(0x11e)];return Object['values']((this[_0x473218(0x100)][_0x5c5dbb]||{'spells':[]})[_0x473218(0x15b)])[_0x473218(0x120)](_0x52bf3b=>{const _0x172de2=_0x473218;if(isExpandedMatch!=null){if(_0x52bf3b['isExpanded']!==isExpandedMatch)return![];}if(_0x52bf3b['requiredCasterLevel']!=null)return this[_0x172de2(0x13b)](_0x52bf3b[_0x172de2(0xe8)]);else return this[_0x172de2(0x13f)](_0x52bf3b[_0x172de2(0x12a)]);});}[_0x292d8e(0x11a)](_0x2e909e){const _0x1b0465=_0x292d8e;return this[_0x1b0465(0x11b)](_0x2e909e,{'isExpandedMatch':![]});}[_0x292d8e(0xea)](_0x3b6868){const _0x57461a=_0x292d8e;return this[_0x57461a(0x11b)](_0x3b6868,{'isExpandedMatch':!![]});}[_0x292d8e(0xfd)](_0x5e836d){return this['_isAnyInnatePreparedExpanded'](_0x5e836d,{'isExpandedMatch':![]});}[_0x292d8e(0x148)](_0x18948c){return this['_isAnyInnatePreparedExpanded'](_0x18948c,{'isExpandedMatch':!![]});}[_0x292d8e(0x150)](_0x5548c7,{isExpandedMatch:_0x5946a0}){const _0x260ea8=_0x292d8e;if(_0x5548c7==null)_0x5548c7=this['_state'][_0x260ea8(0x11e)];return Object[_0x260ea8(0x12e)]((this[_0x260ea8(0x100)][_0x5548c7]||{'spells':[]})['spells'])['some'](_0x1a88d4=>_0x1a88d4[_0x260ea8(0x14b)]===_0x5946a0);}[_0x292d8e(0x167)](_0x585168){const _0x407ac1=_0x292d8e;if(_0x585168==null)_0x585168=this['_state']['ixSet'];return(this[_0x407ac1(0x147)][_0x585168]?.['ability']?.[_0x407ac1(0x117)]?.[_0x407ac1(0xfb)]??0x0)>0x1;}[_0x292d8e(0xf2)](){const _0x5397b3=_0x292d8e;if(this[_0x5397b3(0x147)]['length']!==0x1)return![];return!this[_0x5397b3(0x100)][_0x5397b3(0x14c)](_0x4e4235=>_0x4e4235[_0x5397b3(0x15f)]['ability']?.[_0x5397b3(0x117)]||Object[_0x5397b3(0x12e)](_0x4e4235[_0x5397b3(0x15b)])['some'](_0x6f0c4c=>_0x6f0c4c[_0x5397b3(0x133)]));}[_0x292d8e(0x15d)](){const _0x10686b=_0x292d8e;let _0x557cad=MiscUtil['copy'](this[_0x10686b(0x11b)]()),_0xf78bb8=0x0;_0x557cad=_0x557cad['filter'](_0x102930=>{const _0x43b9c8=_0x10686b;if(_0x102930[_0x43b9c8(0x133)]){const _0x366b9d=this[_0x43b9c8(0x126)][_0x102930[_0x43b9c8(0x130)]];if(!_0x366b9d)return _0xf78bb8++,![];delete _0x102930[_0x43b9c8(0x133)],_0x102930[_0x43b9c8(0x12f)]=this[_0x43b9c8(0x126)][_0x102930['key']];}return!![];});let _0x226e4f;if(this[_0x10686b(0x167)](this[_0x10686b(0x126)][_0x10686b(0x11e)])){_0x226e4f=this[_0x10686b(0x126)][_0x10686b(0x156)];if(_0x226e4f==null)_0xf78bb8++;}else _0x226e4f=(this['_additionalSpellsFlat'][this[_0x10686b(0x126)][_0x10686b(0x11e)]]||{'meta':{}})[_0x10686b(0x15f)][_0x10686b(0x156)];return{'isFormComplete':_0xf78bb8===0x0,'data':_0x557cad,'abilityAbv':_0x226e4f};}[_0x292d8e(0x141)](){const _0x4bfc4d=_0x292d8e;return this[_0x4bfc4d(0x15d)]();}['_getDefaultState'](){return{'ixSet':0x0,'curLevel':null,'targetLevel':null,'spellLevelLow':null,'spellLevelHigh':null,'spellsAlwaysPrepared':[],'spellsExpanded':[],'ability':null};}}export{Charactermancer_AdditionalSpellsSelect};