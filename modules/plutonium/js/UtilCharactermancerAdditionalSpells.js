const _0x5779=['_isRequiredCasterLevelInRange','isExpanded','<div\x20class=\x22mr-2\x22>,</div>','8ImjDeK','_getFlatData_doProcessSpellRechargeBlock','sort','targetLevel','resourceName','<div\x20class=\x22flex-v-center\x20py-1\x22>\x0a\x09\x09\x09<div\x20class=\x22col-3\x20text-center\x22>Spell\x20Level</div>\x0a\x09\x09\x09<div\x20class=\x22col-9\x22>Spells</div>\x0a\x09\x09</div>','requiredCasterLevel','_render_$getRows','state','</button>','_proxyAssignSimple','requiredLevel','modalTitle','resource','trim','abilityAbv','mergeMap','name','_isRequiredLevelInRange','modalFilterSpells','consumeAmount','<i\x20class=\x22ve-muted\x22>Current</i>','will','getFormData','388004pZVgJQ','rest','active','spellsExpanded','pGetSpellHashToItemPosMapAndFillSpellsFromTagIds','spell','splitTagByPipe','_render_addLastBoolSpellsHook','sourceHintText','20109mpkYAS','appendTo','Unhandled\x20spell\x20recharge\x20type\x20\x22','<div>','pGetUserInput','copy','key','_sourceHintText','70YvqDnl','Unhandled\x20additional\x20spell\x20format:\x20\x22','toggleVe','disabled','values','ixSet','pop','forEach','additionalSpells','<button\x20class=\x22btn\x20btn-default\x20btn-xxs\x20mr-1\x22\x20title=\x22Choose\x20a\x20Spell\x22><span\x20class=\x22fas\x20fa-search\x22></span></button>','getFlatData','preparationMode','</div>','1VOkCSz','consumeType','pApplyFormDataToActor','some','_isAnyInnatePreparedExpanded','usesPer','ascSortLower','_isChooseAbility','_modalFilterSpells','7igVnTy','daily','MIN_SAFE_INTEGER','_getFlatData_doProcessSpellItem','mb-1','render','ritual','558138soZFpv','innate','_additionalSpells','spellsAlwaysPrepared','_render_addLastExpandedSpellsHook','Charactermancer_AdditionalSpellsSelect.spells','ability','isNoChoice','meta','getOrdinalForm','spellLevelLow','toggleClass','prop','type','length','sourceJson','push','parentAbilityAbv','_isAnyInnatePrepared','ascSort','isPrepared','entries','_render_renderOptions','count','_render_$getSelChooseAbility','prepared','Unhandled\x20spell\x20addition\x20type\x20\x22','filterExpression','split','data','FlatSpell','showVe','curLevel','inherit','{@spell\x20','expanded','toSpellCase','isAlwaysPrepared','uses','casterLevel','_addHookBase','\x22></div>','consumeTarget','_additionalSpellsFlat','_getDefaultState','castAtLevel','3644yCgHpq','spellLevelHigh','1kHPAzF','toLowerCase','segregate','<div\x20class=\x22ve-small\x20flex-v-center\x20my-1\x20w-100\x20italic\x20ve-muted\x22>No\x20spells\x20at\x20this\x20level</div>','58694tHMAHi','_state','pGetFormData','8247roFTHo','_getFlatExpandedSpellsInRange','_render_addLastAlwaysPreparedSpellsHook','_isAnyExpanded','<div\x20class=\x22italic\x20ve-muted\x22>(select\x20a\x20spell)</div>','Unhandled\x20recharge\x20type\x20\x22','hashToIdMap','1189273TZDOod','choose','<div\x20class=\x22flex-v-center\x20flex-wrap\x20w-100\x20btn-group\x20','MAX_SAFE_INTEGER','_getFlatData_doProcessAdditionMeta','<div\x20class=\x22flex-v-center\x22></div>','join','map','string','setEq','spells','get','_getFlatSpellsInRange','Spell\x20Set\x20','_getFlatInnatePreparedSpellsInRange','filter','$getSelEnum','uid','9nZUTUf'];const _0x179b=function(_0x56f3d1,_0x184e38){_0x56f3d1=_0x56f3d1-0xc2;let _0x577959=_0x5779[_0x56f3d1];return _0x577959;};const _0x582d87=_0x179b;(function(_0x1fabd4,_0x335283){const _0x50a5fc=_0x179b;while(!![]){try{const _0x438507=parseInt(_0x50a5fc(0xc5))*-parseInt(_0x50a5fc(0xe3))+parseInt(_0x50a5fc(0x121))*-parseInt(_0x50a5fc(0xd6))+-parseInt(_0x50a5fc(0x143))*-parseInt(_0x50a5fc(0x127))+-parseInt(_0x50a5fc(0xf3))+parseInt(_0x50a5fc(0xec))*-parseInt(_0x50a5fc(0xce))+-parseInt(_0x50a5fc(0x147))*parseInt(_0x50a5fc(0x12a))+parseInt(_0x50a5fc(0x123))*parseInt(_0x50a5fc(0x131));if(_0x438507===_0x335283)break;else _0x1fabd4['push'](_0x1fabd4['shift']());}catch(_0x6c0127){_0x1fabd4['push'](_0x1fabd4['shift']());}}}(_0x5779,0x4b936));import{Charactermancer_Util}from'./UtilCharactermancer.js';import{DataConverterSpell}from'./DataConverterSpell.js';import{ModalFilterSpellsFvtt}from'./UtilModalFilter.js';class Charactermancer_AdditionalSpellsUtil{static['getFlatData'](_0x564fe0){const _0x5622e9=_0x179b;return _0x564fe0=MiscUtil[_0x5622e9(0xd3)](_0x564fe0),_0x564fe0[_0x5622e9(0x138)](_0x120457=>{const _0x2b1203={},_0x4f15c2={},_0x23b90e=[];return Object['entries'](_0x120457)['forEach'](([_0x17f6fe,_0x5a9f36])=>{const _0x35a295=_0x179b;_0x23b90e[_0x35a295(0x103)](_0x17f6fe);switch(_0x17f6fe){case _0x35a295(0x158):case _0x35a295(0xf9):case _0x35a295(0x14b):_0x2b1203[_0x17f6fe]=_0x5a9f36;break;case'innate':case _0x35a295(0x10c):case _0x35a295(0x116):{this[_0x35a295(0x135)]({'additionType':_0x17f6fe,'additionMeta':_0x5a9f36,'outSpells':_0x4f15c2,'keyPath':_0x23b90e});break;}default:throw new Error(_0x35a295(0x10d)+_0x17f6fe+'\x22');}_0x23b90e[_0x35a295(0xdc)]();}),{'meta':_0x2b1203,'spells':_0x4f15c2};});}static[_0x582d87(0x135)](_0xc95e87){const _0x58e7b2=_0x582d87,{additionMeta:_0x2a7d6e,keyPath:_0x56ad99}=_0xc95e87;Object[_0x58e7b2(0x108)](_0x2a7d6e)[_0x58e7b2(0xdd)](([_0xad7959,_0x511eff])=>{const _0x3a36d8=_0x58e7b2;_0x56ad99[_0x3a36d8(0x103)](_0xad7959),_0x511eff instanceof Array?_0x511eff[_0x3a36d8(0xdd)]((_0x35ee4e,_0x434448)=>this['_getFlatData_doProcessSpellItem']({..._0xc95e87,'levelOrCasterLevel':_0xad7959,'spellItem':_0x35ee4e,'ix':_0x434448})):Object[_0x3a36d8(0x108)](_0x511eff)[_0x3a36d8(0xdd)](([_0x1ad5cf,_0xa59c07])=>{const _0xdf5fd6=_0x3a36d8;this[_0xdf5fd6(0x148)]({..._0xc95e87,'levelOrCasterLevel':_0xad7959,'rechargeType':_0x1ad5cf,'levelMetaInner':_0xa59c07});}),_0x56ad99[_0x3a36d8(0xdc)]();});}static['_getFlatData_doProcessSpellItem'](_0x5de12d){const _0x25c61b=_0x582d87,{additionType:_0xb6b867,additionMeta:_0x29fc0d,outSpells:_0x40bc0e,keyPath:_0x422134,spellItem:_0x981f1a,ix:_0xa7e951,rechargeType:_0x26b036,uses:_0x28dd1d,usesPer:_0x411979,levelOrCasterLevel:_0x40e68d,consumeType:_0x4bef5f,consumeAmount:_0x6f688,consumeTarget:_0x303144}=_0x5de12d;_0x422134[_0x25c61b(0x103)](_0xa7e951);const _0x124a5f={'isExpanded':_0xb6b867===_0x25c61b(0x116),'isAlwaysPrepared':_0xb6b867===_0x25c61b(0x10c),'isPrepared':_0xb6b867==='prepared'||_0xb6b867===_0x25c61b(0xf4),'preparationMode':_0xb6b867===_0x25c61b(0x10c)?'always':_0x25c61b(0xf4),'consumeType':_0x4bef5f,'consumeAmount':_0x6f688,'consumeTarget':_0x303144};if(_0x40e68d!=='_'){const _0x559652=/^s(\d+)$/['exec'](_0x40e68d);if(_0x559652)_0x124a5f[_0x25c61b(0x14d)]=Number(_0x559652[0x1]);else{if(!isNaN(_0x40e68d))_0x124a5f[_0x25c61b(0x152)]=Number(_0x40e68d);}}if(_0x26b036)switch(_0x26b036){case _0x25c61b(0xc6):case _0x25c61b(0xed):break;case'will':case _0x25c61b(0xf2):case _0x25c61b(0x154):{_0x124a5f[_0x25c61b(0xe1)]='atwill',_0x124a5f[_0x25c61b(0x107)]=_0x26b036!=='ritual';break;}case'_':break;default:throw new Error(_0x25c61b(0x12f)+_0x26b036+'\x22');}if(_0x28dd1d)_0x124a5f[_0x25c61b(0x119)]=_0x28dd1d;if(_0x411979)_0x124a5f[_0x25c61b(0xe8)]=_0x411979;if(typeof _0x981f1a===_0x25c61b(0x139)){const _0x4210bb=_0x422134[_0x25c61b(0x137)]('__');_0x40bc0e[_0x4210bb]=new Charactermancer_AdditionalSpellsUtil['FlatSpell']({'type':_0x25c61b(0xca),'key':_0x4210bb,..._0x124a5f,'uid':_0x981f1a});}else{if(_0x981f1a[_0x25c61b(0x132)]){const _0x2a5905=_0x981f1a[_0x25c61b(0x10a)]||0x1;for(let _0x35fdaa=0x0;_0x35fdaa<_0x2a5905;++_0x35fdaa){_0x422134[_0x25c61b(0x103)](_0x35fdaa);const _0x5e0cdb=_0x422134[_0x25c61b(0x137)]('__');_0x40bc0e[_0x5e0cdb]=new Charactermancer_AdditionalSpellsUtil[(_0x25c61b(0x111))]({'type':'choose','key':_0x5e0cdb,..._0x124a5f,'filterExpression':_0x981f1a[_0x25c61b(0x132)]}),_0x422134[_0x25c61b(0xdc)]();}}else throw new Error(_0x25c61b(0xd7)+JSON['stringify'](_0x981f1a)+'\x22');}_0x422134[_0x25c61b(0xdc)]();}static[_0x582d87(0x148)](_0x5cf7e6){const _0x5a39bd=_0x582d87,{additionType:_0x12043c,additionMeta:_0x491776,outSpells:_0x5e4319,keyPath:_0x377faa,levelOrCasterLevel:_0x5de52c,rechargeType:_0x4dbd87,levelMetaInner:_0x307481}=_0x5cf7e6;_0x377faa[_0x5a39bd(0x103)](_0x4dbd87);switch(_0x4dbd87){case _0x5a39bd(0xc6):case'daily':{const _0x1a7440=_0x4dbd87==='rest'?'sr':'lr';Object[_0x5a39bd(0x108)](_0x307481)['forEach'](([_0xf35786,_0x26e3e1])=>{const _0x4da3a7=_0x5a39bd;_0x377faa[_0x4da3a7(0x103)](_0xf35786),_0xf35786=_0xf35786['replace'](/^(\d+)e$/,'$1');const _0x3ba4e3=Number(_0xf35786);_0x26e3e1[_0x4da3a7(0xdd)]((_0x3ccb2f,_0x22ca29)=>this[_0x4da3a7(0xef)]({..._0x5cf7e6,'spellItem':_0x3ccb2f,'ix':_0x22ca29,'uses':_0x3ba4e3,'usesPer':_0x1a7440})),_0x377faa[_0x4da3a7(0xdc)]();});break;}case'resource':{Object['entries'](_0x307481)[_0x5a39bd(0xdd)](([_0x3bbb8a,_0xb9fcab])=>{const _0x208b2d=_0x5a39bd;_0x377faa[_0x208b2d(0x103)](_0x3bbb8a),_0xb9fcab[_0x208b2d(0xdd)]((_0x57cc99,_0x323138)=>this['_getFlatData_doProcessSpellItem']({..._0x5cf7e6,'spellItem':_0x57cc99,'ix':_0x323138,'consumeType':'attribute','consumeAmount':Number(_0x3bbb8a),'consumeTarget':'resources.primary.value'})),_0x377faa['pop']();});break;}case _0x5a39bd(0xc3):case'ritual':case'_':{_0x307481[_0x5a39bd(0xdd)]((_0x1b71a5,_0x2543ed)=>this[_0x5a39bd(0xef)]({..._0x5cf7e6,'spellItem':_0x1b71a5,'ix':_0x2543ed}));break;}default:throw new Error(_0x5a39bd(0xd0)+_0x4dbd87+'\x22');}_0x377faa[_0x5a39bd(0xdc)]();}}Charactermancer_AdditionalSpellsUtil[_0x582d87(0x111)]=class{constructor(_0x2acee0){const _0x2b34f7=_0x582d87;this[_0x2b34f7(0x100)]=_0x2acee0[_0x2b34f7(0x100)],this[_0x2b34f7(0xd4)]=_0x2acee0['key'],this[_0x2b34f7(0x145)]=_0x2acee0[_0x2b34f7(0x145)],this[_0x2b34f7(0x107)]=_0x2acee0['isPrepared'],this[_0x2b34f7(0x118)]=_0x2acee0[_0x2b34f7(0x118)],this['preparationMode']=_0x2acee0[_0x2b34f7(0xe1)],this[_0x2b34f7(0x14d)]=_0x2acee0['requiredCasterLevel'],this[_0x2b34f7(0x152)]=_0x2acee0[_0x2b34f7(0x152)],this[_0x2b34f7(0x119)]=_0x2acee0[_0x2b34f7(0x119)],this['usesPer']=_0x2acee0[_0x2b34f7(0xe8)],this[_0x2b34f7(0xe4)]=_0x2acee0[_0x2b34f7(0xe4)],this[_0x2b34f7(0x15b)]=_0x2acee0[_0x2b34f7(0x15b)],this[_0x2b34f7(0x11d)]=_0x2acee0[_0x2b34f7(0x11d)],this[_0x2b34f7(0x142)]=null,this[_0x2b34f7(0x120)]=null;if(_0x2acee0[_0x2b34f7(0x142)]){const [_0x5b9a1d,_0x212923]=_0x2acee0[_0x2b34f7(0x142)][_0x2b34f7(0x10f)]('#')[_0x2b34f7(0x138)](_0x3d94bb=>_0x3d94bb[_0x2b34f7(0x155)]())[_0x2b34f7(0x140)](Boolean);let [_0x1daa72,_0x3cad0a]=Renderer[_0x2b34f7(0xcb)](_0x5b9a1d[_0x2b34f7(0x124)]());_0x3cad0a=_0x3cad0a||SRC_PHB['toLowerCase'](),this[_0x2b34f7(0x142)]=_0x1daa72+'|'+_0x3cad0a;if(_0x212923&&!isNaN(_0x212923))this[_0x2b34f7(0x120)]=Number(_0x212923);}this[_0x2b34f7(0x10e)]=_0x2acee0[_0x2b34f7(0x10e)];}};class Charactermancer_AdditionalSpellsSelect extends BaseComponent{static async[_0x582d87(0xd2)](_0x30e320){const _0x25109c=_0x582d87;_0x30e320=_0x30e320||{};const {additionalSpells:_0x542062}=_0x30e320;if(!_0x542062||!_0x542062[_0x25109c(0x101)])return{'isFormComplete':!![],'data':[]};const _0x3d34c4=new ModalFilterSpellsFvtt({'namespace':_0x25109c(0xf8),'isRadio':!![]}),_0x3dca39=new this({..._0x30e320,'modalFilterSpells':_0x3d34c4});_0x3dca39[_0x25109c(0x113)]=_0x30e320[_0x25109c(0x113)],_0x3dca39[_0x25109c(0x14a)]=_0x30e320[_0x25109c(0x14a)],_0x3dca39[_0x25109c(0xfd)]=_0x30e320[_0x25109c(0xfd)],_0x3dca39[_0x25109c(0x122)]=_0x30e320[_0x25109c(0x122)];if(_0x3dca39['isNoChoice']())return _0x3dca39[_0x25109c(0x129)]();return Charactermancer_Util['pGetImportCompApplicationFormData']({'comp':_0x3dca39,'width':0x280,'height':0xdc});}static async[_0x582d87(0xe5)](_0x120dc2,_0x5c426f,_0x15d633){const _0x46c145=_0x582d87;_0x15d633=_0x15d633||{};if(!_0x5c426f||!_0x5c426f?.['data']?.[_0x46c145(0x101)])return;const _0x5036a6=(_0x15d633[_0x46c145(0x156)]===_0x46c145(0x114)?_0x15d633[_0x46c145(0x104)]:_0x15d633['abilityAbv'])||(_0x5c426f['abilityAbv']===_0x46c145(0x114)?_0x15d633[_0x46c145(0x104)]:_0x5c426f[_0x46c145(0x156)]);await DataConverterSpell[_0x46c145(0xc9)](_0x120dc2,_0x5c426f['data'],{'optsGetSpellItem':{'casterLevel':_0x15d633[_0x46c145(0x11a)],'abilityAbv':_0x5036a6},'hashToIdMap':_0x15d633[_0x46c145(0x130)]});}constructor(_0x23e538){const _0x51a6e3=_0x582d87;_0x23e538=_0x23e538||{},super(),this[_0x51a6e3(0xf5)]=_0x23e538[_0x51a6e3(0xde)],this[_0x51a6e3(0xd5)]=_0x23e538[_0x51a6e3(0xcd)],this[_0x51a6e3(0xeb)]=_0x23e538[_0x51a6e3(0x15a)],this[_0x51a6e3(0x11e)]=Charactermancer_AdditionalSpellsUtil[_0x51a6e3(0xe0)](_0x23e538['additionalSpells']);}get[_0x582d87(0x153)](){const _0x2e9ff4=_0x582d87;return'Choose\x20Additional\x20Spell\x20Set'+(this[_0x2e9ff4(0xd5)]?'\x20('+this['_sourceHintText']+')':'');}set[_0x582d87(0x113)](_0x117cf1){const _0x1dc487=_0x582d87;this[_0x1dc487(0x128)]['curLevel']=_0x117cf1;}set[_0x582d87(0x14a)](_0x5e3dc6){const _0x701569=_0x582d87;this['_state'][_0x701569(0x14a)]=_0x5e3dc6;}set[_0x582d87(0xfd)](_0x50a26a){const _0x20a41c=_0x582d87;this[_0x20a41c(0x128)][_0x20a41c(0xfd)]=_0x50a26a;}set[_0x582d87(0x122)](_0x5ac504){const _0x19444a=_0x582d87;this[_0x19444a(0x128)][_0x19444a(0x122)]=_0x5ac504;}['addHookAlwaysPreparedSpells'](_0x4895b1){const _0x54ffcd=_0x582d87;this[_0x54ffcd(0x11b)](_0x54ffcd(0xf6),_0x4895b1);}['addHookExpandedSpells'](_0x1fcb68){const _0x59c8eb=_0x582d87;this[_0x59c8eb(0x11b)]('spellsExpanded',_0x1fcb68);}get[_0x582d87(0xf6)](){const _0x52f60f=_0x582d87;return this[_0x52f60f(0x128)]['spellsAlwaysPrepared'];}get[_0x582d87(0xc8)](){return this['_state']['spellsExpanded'];}[_0x582d87(0x12c)](){const _0x49fffc=_0x582d87;return this[_0x49fffc(0xcc)]({'propState':'spellsAlwaysPrepared','propIsBool':'isAlwaysPrepared'});}[_0x582d87(0xf7)](){const _0x3ebd81=_0x582d87;return this[_0x3ebd81(0xcc)]({'propState':'spellsExpanded','propIsBool':'isExpanded'});}[_0x582d87(0xcc)]({propState:_0x3c4a15,propIsBool:_0x25857e}){const _0x435293=_0x582d87,_0x24ccec=()=>{const _0x3e5151=_0x179b,_0x5da611=this[_0x3e5151(0xc4)](),_0x1260d7=_0x5da611[_0x3e5151(0x110)]['filter'](_0x12fc6d=>_0x12fc6d[_0x25857e])['map'](_0x12c874=>_0x12c874[_0x3e5151(0x142)][_0x3e5151(0x124)]()),_0x59a60a=new Set(this['_state'][_0x3c4a15]),_0x2883ab=new Set(_0x1260d7);if(!CollectionUtil[_0x3e5151(0x13a)](_0x59a60a,_0x2883ab))this[_0x3e5151(0x128)][_0x3c4a15]=_0x1260d7;};this[_0x435293(0x11b)](_0x435293(0xdb),_0x24ccec),this[_0x435293(0x11b)]('curLevel',_0x24ccec),this['_addHookBase'](_0x435293(0x14a),_0x24ccec),this[_0x435293(0x11b)](_0x435293(0xfd),_0x24ccec),this[_0x435293(0x11b)]('spellLevelHigh',_0x24ccec),_0x24ccec();}[_0x582d87(0xf1)](_0x4c65c5){const _0x4be5de=_0x582d87;this[_0x4be5de(0x12c)](),this[_0x4be5de(0xf7)]();const _0x3010e5=$(_0x4be5de(0x133)+(this[_0x4be5de(0x11e)]['length']>0x1?_0x4be5de(0xf0):'')+_0x4be5de(0x11c)),_0x31f7ca=$('<div\x20class=\x22flex-col\x20w-100\x22></div>');for(let _0x1474c3=0x0;_0x1474c3<this['_additionalSpellsFlat']['length'];++_0x1474c3)this[_0x4be5de(0x109)](_0x3010e5,_0x31f7ca,_0x1474c3);$$(_0x4c65c5)`
			${_0x3010e5}
			${_0x31f7ca}
		`;}[_0x582d87(0x109)](_0x13fd8f,_0x1ec9bf,_0x21e5d5){const _0x5ccd1b=_0x582d87,_0x2da1a8=this[_0x5ccd1b(0x11e)][_0x21e5d5],_0x18beca=this['_additionalSpellsFlat'][_0x5ccd1b(0x101)]===0x1?null:$('<button\x20class=\x22btn\x20btn-xs\x20flex-1\x22\x20title=\x22Select\x20Spell\x20Set\x22>'+(_0x2da1a8[_0x5ccd1b(0xfb)][_0x5ccd1b(0x158)]??_0x5ccd1b(0x13e)+(_0x21e5d5+0x1))+_0x5ccd1b(0x150))['click'](()=>this['_state'][_0x5ccd1b(0xdb)]=_0x21e5d5),_0x3745ef=this[_0x5ccd1b(0x105)](_0x21e5d5),_0x183bc6=this[_0x5ccd1b(0x12d)](_0x21e5d5),_0xb371b7=Object['values'](_0x2da1a8[_0x5ccd1b(0x13b)])['sort']((_0x45ac07,_0x5dadc7)=>SortUtil[_0x5ccd1b(0x106)](_0x45ac07['requiredLevel']||0x0,_0x5dadc7[_0x5ccd1b(0x152)]||0x0)||SortUtil[_0x5ccd1b(0x106)](_0x45ac07['requiredCasterLevel']||0x0,_0x5dadc7[_0x5ccd1b(0x14d)]||0x0)),_0x9d375a=_0x3745ef?$('<div\x20class=\x22flex-v-center\x20py-1\x22>\x0a\x09\x09\x09<div\x20class=\x22col-3\x20text-center\x22>Level</div>\x0a\x09\x09\x09<div\x20class=\x22col-9\x22>Spells</div>\x0a\x09\x09</div>'):null,_0x3ff4c6=_0x183bc6?$(_0x5ccd1b(0x14c)):null,_0xfdec64=_0x3745ef?this[_0x5ccd1b(0x14e)](_0x21e5d5,_0xb371b7,{'isExpandedMatch':![]}):null,_0x31d142=_0x183bc6?this['_render_$getRows'](_0x21e5d5,_0xb371b7,{'isExpandedMatch':!![]}):null,_0x39b9a4=_0x3745ef?$('<div\x20class=\x22ve-small\x20flex-v-center\x20my-1\x20w-100\x20italic\x20ve-muted\x22>No\x20spells\x20at\x20this\x20level</div>'):null,_0x41a75e=_0x183bc6?$(_0x5ccd1b(0x126)):null,_0x2c6106=()=>{const _0x45f1d4=_0x5ccd1b,_0x9c733=!!this['_getFlatInnatePreparedSpellsInRange'](_0x21e5d5)[_0x45f1d4(0x101)];if(_0x9d375a)_0x9d375a['toggleVe'](_0x9c733);if(_0x39b9a4)_0x39b9a4['toggleVe'](!_0x9c733);const _0x690127=!!this[_0x45f1d4(0x12b)](_0x21e5d5)[_0x45f1d4(0x101)];if(_0x3ff4c6)_0x3ff4c6[_0x45f1d4(0xd8)](_0x690127);if(_0x41a75e)_0x41a75e[_0x45f1d4(0xd8)](!_0x690127);};this[_0x5ccd1b(0x11b)](_0x5ccd1b(0xfd),_0x2c6106),this[_0x5ccd1b(0x11b)]('spellLevelHigh',_0x2c6106),this[_0x5ccd1b(0x11b)](_0x5ccd1b(0x113),_0x2c6106),this[_0x5ccd1b(0x11b)](_0x5ccd1b(0x14a),_0x2c6106),this[_0x5ccd1b(0x11b)](_0x5ccd1b(0xdb),_0x2c6106),_0x2c6106();const _0x2c704e=_0x3745ef?$$`<div class="flex-col">
			<h3 class="bold my-0">Innate/Prepared Spells</h3>
			${_0x9d375a}
			${_0xfdec64}
			${_0x39b9a4}
		</div>`:null,_0x5aa423=_0x183bc6?$$`<div class="flex-col">
			<h3 class="bold my-0">Expanded Spell List</h3>
			${_0x3ff4c6}
			${_0x31d142}
			${_0x41a75e}
		</div>`:null,_0x4b7ff6=this['_isChooseAbility'](_0x21e5d5),_0x3139f0=_0x4b7ff6?this[_0x5ccd1b(0x10b)](_0x21e5d5):null,_0x379a5f=_0x4b7ff6?$$`<div class="split-v-center">
			<h3 class="bold my-0 no-shrink mr-2">Ability Score</h3>
			${_0x3139f0}
		</div>`:null;if(_0x18beca)_0x13fd8f['append'](_0x18beca);const _0xb7182a=$$`<div class="flex-col">
			${_0x2c704e}
			${_0x5aa423}
			${_0x379a5f}
		</div>`[_0x5ccd1b(0xcf)](_0x1ec9bf);if(this[_0x5ccd1b(0x11e)]['length']!==0x1){const _0x1011b0=()=>{const _0x2faa7e=_0x5ccd1b;_0x18beca[_0x2faa7e(0xfe)](_0x2faa7e(0xc7),this[_0x2faa7e(0x128)][_0x2faa7e(0xdb)]===_0x21e5d5),_0xb7182a['toggleVe'](this[_0x2faa7e(0x128)][_0x2faa7e(0xdb)]===_0x21e5d5);};this[_0x5ccd1b(0x11b)]('ixSet',_0x1011b0),_0x1011b0();const _0x9114f3=(_0x5a79cf,_0x3818ef,_0x11b4de)=>{const _0x2fab4f=_0x5ccd1b,_0x21f87c=this[_0x2fab4f(0x11e)][_0x11b4de],_0x10b34d=Object[_0x2fab4f(0xda)](_0x21f87c[_0x2fab4f(0x13b)])[_0x2fab4f(0x157)](_0xc2a4e=>({[_0xc2a4e[_0x2fab4f(0xd4)]]:null}));this[_0x2fab4f(0x151)](_0x2fab4f(0x14f),_0x10b34d);};this[_0x5ccd1b(0x11b)]('ixSet',_0x9114f3);}}[_0x582d87(0x14e)](_0x378591,_0xe57d50,{isExpandedMatch:_0x5f5a57}){const _0x4f826e=_0x582d87;if(!_0xe57d50['length'])return null;const _0x375a71={};return _0xe57d50[_0x4f826e(0xdd)](_0x4f2bf6=>{const _0x4e21d4=_0x4f826e;if(_0x4f2bf6['isExpanded']!==_0x5f5a57)return;const _0x18ba21=_0x4f2bf6[_0x4e21d4(0x14d)]||_0x4f2bf6[_0x4e21d4(0x152)];(_0x375a71[_0x18ba21]=_0x375a71[_0x18ba21]||[])[_0x4e21d4(0x103)](_0x4f2bf6);}),Object[_0x4f826e(0x108)](_0x375a71)['sort'](([_0x49c61c],[_0x2564c6])=>SortUtil[_0x4f826e(0x106)](Number(_0x49c61c),Number(_0x2564c6)))[_0x4f826e(0x138)](([,_0x451da1])=>{const _0x10fab3=_0x4f826e,_0x34c965=_0x451da1[0x0][_0x10fab3(0x14d)]!=null,_0x2935ae=_0x451da1[0x0]['requiredLevel']!=null,[_0x39ab86,_0x52cb70]=_0x451da1[_0x10fab3(0x125)](_0x69976a=>!_0x69976a[_0x10fab3(0x10e)]);_0x39ab86[_0x10fab3(0x149)]((_0x1ebe92,_0x1a0210)=>SortUtil['ascSortLower'](_0x1ebe92[_0x10fab3(0x142)],_0x1a0210[_0x10fab3(0x142)])),_0x52cb70['sort']((_0x5a3b5e,_0xe14a78)=>SortUtil[_0x10fab3(0xe9)](_0x5a3b5e[_0x10fab3(0x10e)],_0xe14a78[_0x10fab3(0x10e)]));const _0x278c61=$$`<div class="col-9 flex-v-center">
					<div>${Renderer[_0x10fab3(0x13c)]()[_0x10fab3(0xf1)](_0x39ab86['map'](_0x3a3978=>_0x10fab3(0x115)+_0x3a3978[_0x10fab3(0x142)][_0x10fab3(0x117)]()+'}')[_0x10fab3(0x137)](',\x20'))}</div>
				</div>`;_0x52cb70[_0x10fab3(0xdd)]((_0xa03ecf,_0x2f3a0f)=>{const _0xbd3919=_0x10fab3,_0x610f5b=$(_0xbd3919(0x136)),_0x154a27=()=>{const _0x503b4e=_0xbd3919;_0x610f5b['html'](this[_0x503b4e(0x128)][_0xa03ecf[_0x503b4e(0xd4)]]!=null&&this[_0x503b4e(0x128)][_0x503b4e(0xdb)]===_0x378591?_0x503b4e(0xd1)+Renderer[_0x503b4e(0x13c)]()['render'](_0x503b4e(0x115)+this[_0x503b4e(0x128)][_0xa03ecf[_0x503b4e(0xd4)]]['toLowerCase']()+'}')+_0x503b4e(0xe2):_0x503b4e(0x12e));};this[_0xbd3919(0x11b)](_0xa03ecf['key'],_0x154a27);this['_additionalSpellsFlat'][_0xbd3919(0x101)]!==0x1&&this[_0xbd3919(0x11b)](_0xbd3919(0xdb),_0x154a27);_0x154a27();const _0xc28474=$(_0xbd3919(0xdf))['click'](async()=>{const _0x3918af=_0xbd3919,_0x420341=await this[_0x3918af(0xeb)]['pGetUserSelection']({'filterExpression':_0xa03ecf['filterExpression']});if(_0x420341==null||!_0x420341[_0x3918af(0x101)])return;const _0x5c5d46=_0x420341[0x0];this[_0x3918af(0x128)][_0xa03ecf['key']]=_0x5c5d46[_0x3918af(0x158)]+'|'+_0x5c5d46[_0x3918af(0xda)][_0x3918af(0x102)];});if(this['_additionalSpellsFlat']['length']!==0x1){const _0x1e92c2=()=>_0xc28474[_0xbd3919(0xff)](_0xbd3919(0xd9),this[_0xbd3919(0x128)][_0xbd3919(0xdb)]!==_0x378591);this['_addHookBase'](_0xbd3919(0xdb),_0x1e92c2),_0x1e92c2();}if(_0x39ab86[_0xbd3919(0x101)]||_0x2f3a0f)_0x278c61['append'](_0xbd3919(0x146));$$`<div class="flex-v-center">${_0xc28474}${_0x610f5b}</div>`[_0xbd3919(0xcf)](_0x278c61);});const _0xf9395e=$$`<div class="py-1 flex-v-center stripe-even">
					<div class="col-3 text-center">${Parser[_0x10fab3(0xfc)](_0x451da1[0x0]['requiredCasterLevel']||_0x451da1[0x0][_0x10fab3(0x152)])||_0x10fab3(0xc2)}</div>
					${_0x278c61}
				</div>`;if(_0x34c965){const _0x77c01=()=>_0xf9395e[_0x10fab3(0xd8)](this[_0x10fab3(0x144)](_0x451da1[0x0]['requiredCasterLevel']));this[_0x10fab3(0x11b)](_0x10fab3(0xfd),_0x77c01),this[_0x10fab3(0x11b)](_0x10fab3(0x122),_0x77c01),_0x77c01();}else{if(_0x2935ae){const _0xcc739=()=>_0xf9395e[_0x10fab3(0xd8)](this[_0x10fab3(0x159)](_0x451da1[0x0][_0x10fab3(0x152)]));this[_0x10fab3(0x11b)](_0x10fab3(0x113),_0xcc739),this['_addHookBase']('targetLevel',_0xcc739),_0xcc739();}else _0xf9395e[_0x10fab3(0x112)]();}return _0xf9395e;});}[_0x582d87(0x10b)](_0x44ed2f){const _0x58b05e=_0x582d87;return ComponentUiUtil[_0x58b05e(0x141)](this,'ability',{'values':this['_additionalSpells'][_0x44ed2f][_0x58b05e(0xf9)][_0x58b05e(0x132)],'fnDisplay':_0x35bf7d=>Parser['attAbvToFull'](_0x35bf7d),'isAllowNull':!![]});}[_0x582d87(0x159)](_0xeba624){const _0x4c8e0a=_0x582d87;return _0xeba624>(this[_0x4c8e0a(0x128)][_0x4c8e0a(0x113)]??Number['MAX_SAFE_INTEGER'])&&_0xeba624<=(this[_0x4c8e0a(0x128)][_0x4c8e0a(0x14a)]==null?Number[_0x4c8e0a(0xee)]:this['_state'][_0x4c8e0a(0x14a)]);}[_0x582d87(0x144)](_0x1c4515){const _0x47ae6a=_0x582d87;return _0x1c4515>=(this[_0x47ae6a(0x128)][_0x47ae6a(0xfd)]??Number[_0x47ae6a(0x134)])&&_0x1c4515<=(this[_0x47ae6a(0x128)][_0x47ae6a(0x122)]==null?Number[_0x47ae6a(0xee)]:this[_0x47ae6a(0x128)][_0x47ae6a(0x122)]);}['_getFlatSpellsInRange'](_0x158efd,{isExpandedMatch:isExpandedMatch=null}={}){const _0x3050e9=_0x582d87;if(_0x158efd==null)_0x158efd=this[_0x3050e9(0x128)][_0x3050e9(0xdb)];return Object[_0x3050e9(0xda)]((this[_0x3050e9(0x11e)][_0x158efd]||{'spells':[]})[_0x3050e9(0x13b)])['filter'](_0x45f494=>{const _0x46e2ae=_0x3050e9;if(isExpandedMatch!=null){if(_0x45f494[_0x46e2ae(0x145)]!==isExpandedMatch)return![];}if(_0x45f494[_0x46e2ae(0x14d)]!=null)return this[_0x46e2ae(0x144)](_0x45f494[_0x46e2ae(0x14d)]);else{if(_0x45f494[_0x46e2ae(0x152)]!=null)return this[_0x46e2ae(0x159)](_0x45f494['requiredLevel']);}return!![];});}[_0x582d87(0x13f)](_0x48298f){const _0x57e53d=_0x582d87;return this[_0x57e53d(0x13d)](_0x48298f,{'isExpandedMatch':![]});}[_0x582d87(0x12b)](_0x59c5e4){const _0x5ed2f3=_0x582d87;return this[_0x5ed2f3(0x13d)](_0x59c5e4,{'isExpandedMatch':!![]});}['_isAnyInnatePrepared'](_0x5c2a46){const _0x18262b=_0x582d87;return this[_0x18262b(0xe7)](_0x5c2a46,{'isExpandedMatch':![]});}[_0x582d87(0x12d)](_0x34b2dc){const _0x50808a=_0x582d87;return this[_0x50808a(0xe7)](_0x34b2dc,{'isExpandedMatch':!![]});}[_0x582d87(0xe7)](_0x81de4a,{isExpandedMatch:_0x3ae992}){const _0x5c35b5=_0x582d87;if(_0x81de4a==null)_0x81de4a=this['_state'][_0x5c35b5(0xdb)];return Object['values']((this[_0x5c35b5(0x11e)][_0x81de4a]||{'spells':[]})['spells'])['some'](_0x32ddac=>_0x32ddac[_0x5c35b5(0x145)]===_0x3ae992);}[_0x582d87(0xea)](_0x2ad0aa){const _0xaa140f=_0x582d87;if(_0x2ad0aa==null)_0x2ad0aa=this[_0xaa140f(0x128)]['ixSet'];return(this['_additionalSpells'][_0x2ad0aa]?.[_0xaa140f(0xf9)]?.[_0xaa140f(0x132)]?.['length']??0x0)>0x1;}[_0x582d87(0xfa)](){const _0x482ac8=_0x582d87;if(this[_0x482ac8(0xf5)][_0x482ac8(0x101)]!==0x1)return![];return!this[_0x482ac8(0x11e)]['some'](_0x34fd2d=>_0x34fd2d[_0x482ac8(0xfb)][_0x482ac8(0xf9)]?.[_0x482ac8(0x132)]||Object[_0x482ac8(0xda)](_0x34fd2d[_0x482ac8(0x13b)])[_0x482ac8(0xe6)](_0x537a10=>_0x537a10[_0x482ac8(0x10e)]));}[_0x582d87(0xc4)](){const _0x54257f=_0x582d87;let _0x33b7b4=MiscUtil[_0x54257f(0xd3)](this[_0x54257f(0x13d)]()),_0x153817=0x0;_0x33b7b4=_0x33b7b4[_0x54257f(0x140)](_0x337376=>{const _0x3a7a15=_0x54257f;if(_0x337376['filterExpression']){const _0x4dbe7b=this['_state'][_0x337376[_0x3a7a15(0xd4)]];if(!_0x4dbe7b)return _0x153817++,![];delete _0x337376[_0x3a7a15(0x10e)],_0x337376[_0x3a7a15(0x142)]=this[_0x3a7a15(0x128)][_0x337376[_0x3a7a15(0xd4)]];}return!![];});let _0x8161f0;if(this[_0x54257f(0xea)](this[_0x54257f(0x128)][_0x54257f(0xdb)])){_0x8161f0=this[_0x54257f(0x128)][_0x54257f(0xf9)];if(_0x8161f0==null)_0x153817++;}else _0x8161f0=(this[_0x54257f(0x11e)][this[_0x54257f(0x128)]['ixSet']]||{'meta':{}})[_0x54257f(0xfb)][_0x54257f(0xf9)];return{'isFormComplete':_0x153817===0x0,'data':_0x33b7b4,'abilityAbv':_0x8161f0};}[_0x582d87(0x129)](){return this['getFormData']();}[_0x582d87(0x11f)](){return{'ixSet':0x0,'curLevel':null,'targetLevel':null,'spellLevelLow':null,'spellLevelHigh':null,'spellsAlwaysPrepared':[],'spellsExpanded':[],'ability':null};}}export{Charactermancer_AdditionalSpellsSelect};